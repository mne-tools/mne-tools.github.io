<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction to artifacts and artifact detection &mdash; MNE 0.12.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials.html" />
    <link rel="next" title="Filtering and Resampling" href="plot_artifacts_correction_filtering.html" />
    <link rel="prev" title="Seven stories about MNE" href="../tutorials/seven_stories_about_mne.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Get started</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Gallery</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../manual/index.html">Manual</a></li>
                <li><a href="../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribute to MNE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Introduction to artifacts and artifact detection</a><ul>
<li><a class="reference internal" href="#background-what-is-an-artifact">Background: what is an artifact?</a></li>
<li><a class="reference internal" href="#how-to-handle-artifacts">How to handle artifacts?</a></li>
<li><a class="reference internal" href="#artifacts-detection">Artifacts Detection</a></li>
<li><a class="reference internal" href="#ecg">ECG</a></li>
<li><a class="reference internal" href="#eog">EOG</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Introduction to artifacts and artifact detection</a><ul>
<li><a class="reference internal" href="#background-what-is-an-artifact">Background: what is an artifact?</a></li>
<li><a class="reference internal" href="#how-to-handle-artifacts">How to handle artifacts?</a></li>
<li><a class="reference internal" href="#artifacts-detection">Artifacts Detection</a></li>
<li><a class="reference internal" href="#ecg">ECG</a></li>
<li><a class="reference internal" href="#eog">EOG</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="../tutorials/seven_stories_about_mne.html" title="Previous Chapter: Seven stories about MNE"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Seven stories...</span>
    </a>
  </li>
  <li>
    <a href="plot_artifacts_correction_filtering.html" title="Next Chapter: Filtering and Resampling"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Filtering and... &raquo;</span>
    </a>
  </li>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="introduction-to-artifacts-and-artifact-detection">
<span id="tut-artifacts-detect"></span><span id="sphx-glr-auto-tutorials-plot-artifacts-detection-py"></span><h1>Introduction to artifacts and artifact detection<a class="headerlink" href="#introduction-to-artifacts-and-artifact-detection" title="Permalink to this headline">¶</a></h1>
<p>Since MNE supports the data of many different acquisition systems, the
particular artifacts in your data might behave very differently from the
artifacts you can observe in our tutorials and examples.</p>
<p>Therefore you should be aware of the different approaches and of
the variability of artifact rejection (automatic/manual) procedures described
onwards. At the end consider always to visually inspect your data
after artifact rejection or correction.</p>
<div class="section" id="background-what-is-an-artifact">
<h2>Background: what is an artifact?<a class="headerlink" href="#background-what-is-an-artifact" title="Permalink to this headline">¶</a></h2>
<p>Artifacts are signal interference that can be
endogenous (biological) and exogenous (environmental).
Typical biological artifacts are head movements, eye blinks
or eye movements, heart beats. The most common environmental
artifact is due to the power line, the so-called <em>line noise</em>.</p>
</div>
<div class="section" id="how-to-handle-artifacts">
<h2>How to handle artifacts?<a class="headerlink" href="#how-to-handle-artifacts" title="Permalink to this headline">¶</a></h2>
<p>MNE deals with artifacts by first identifying them, and subsequently removing
them. Detection of artifacts can be done visually, or using automatic routines
(or a combination of both). After you know what the artifacts are, you need
remove them. This can be done by:</p>
<blockquote>
<div><ul class="simple">
<li><em>ignoring</em> the piece of corrupted data</li>
<li><em>fixing</em> the corrupted data</li>
</ul>
</div></blockquote>
<p>For the artifact detection the functions MNE provides depend on whether
your data is continuous (Raw) or epoch-based (Epochs) and depending on
whether your data is stored on disk or already in memory.</p>
<p>Detecting the artifacts without reading the complete data into memory allows
you to work with datasets that are too large to fit in memory all at once.
Detecting the artifacts in continuous data allows you to apply filters
(e.g. a band-pass filter to zoom in on the muscle artifacts on the temporal
channels) without having to worry about edge effects due to the filter
(i.e. filter ringing). Having the data in memory after segmenting/epoching is
however a very efficient way of browsing through the data which helps
in visualizing. So to conclude, there is not a single most optimal manner
to detect the artifacts: it just depends on the data properties and your
own preferences.</p>
<p>In this tutorial we show how to detect artifacts visually and automatically.
For how to correct artifacts by rejection see <a class="reference internal" href="plot_artifacts_correction_rejection.html#tut-artifacts-reject"><span>Rejecting bad data (channels and segments)</span></a>.
To discover how to correct certain artifacts by filtering see
<a class="reference internal" href="plot_artifacts_correction_filtering.html#tut-artifacts-filter"><span>Filtering and Resampling</span></a> and to learn how to correct artifacts
with subspace methods like SSP and ICA see <a class="reference internal" href="plot_artifacts_correction_ssp.html#tut-artifacts-correct-ssp"><span>Artifact Correction with SSP</span></a>
and <a class="reference internal" href="plot_artifacts_correction_ica.html#tut-artifacts-correct-ica"><span>Artifact Correction with ICA</span></a>.</p>
</div>
<div class="section" id="artifacts-detection">
<h2>Artifacts Detection<a class="headerlink" href="#artifacts-detection" title="Permalink to this headline">¶</a></h2>
<p>This tutorial discusses a couple of major artifacts that most analyses
have to deal with and demonstrates how to detect them.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">mne.preprocessing</span> <span class="kn">import</span> <a href="../generated/mne.preprocessing.create_ecg_epochs.html#mne.preprocessing.create_ecg_epochs"><span class="n">create_ecg_epochs</span></a><span class="p">,</span> <a href="../generated/mne.preprocessing.create_eog_epochs.html#mne.preprocessing.create_eog_epochs"><span class="n">create_eog_epochs</span></a>

<span class="c1"># getting some data ready</span>
<span class="n">data_path</span> <span class="o">=</span> <a href="../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis_raw.fif&#39;</span>

<span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span><span class="p">(</span><span class="n">raw_fname</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Opening raw data file /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
Current compensation grade : 0
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Adding average EEG reference projection.
1 projection items deactivated
Reading 0 ... 166799  =      0.000 ...   277.714 secs...
</pre></div>
</div>
<p>Low frequency drifts and line noise</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
           <span class="o">.</span><span class="n">del_proj</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
           <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">remove_dc</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_artifacts_detection_001.png" class="align-center" src="../_images/sphx_glr_plot_artifacts_detection_001.png" />
<p>we see high amplitude undulations in low frequencies, spanning across tens of
seconds</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_artifacts_detection_002.png" class="align-center" src="../_images/sphx_glr_plot_artifacts_detection_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Effective window size : 3.410 (s)
Effective window size : 3.410 (s)
Effective window size : 3.410 (s)
</pre></div>
</div>
<p>On MEG sensors we see narrow frequency peaks at 60, 120, 180, 240 Hz,
related to line noise.
But also some high amplitude signals between 25 and 32 Hz, hinting at other
biological artifacts such as ECG. These can be most easily detected in the
time domain using MNE helper functions</p>
<p>See <a class="reference internal" href="plot_artifacts_correction_filtering.html#tut-artifacts-filter"><span>Filtering and Resampling</span></a>.</p>
</div>
<div class="section" id="ecg">
<h2>ECG<a class="headerlink" href="#ecg" title="Permalink to this headline">¶</a></h2>
<p>finds ECG events, creates epochs, averages and plots</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">average_ecg</span> <span class="o">=</span> <a href="../generated/mne.preprocessing.create_ecg_epochs.html#mne.preprocessing.create_ecg_epochs"><span class="n">create_ecg_epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;We found </span><span class="si">%i</span><span class="s1"> ECG events&#39;</span> <span class="o">%</span> <span class="n">average_ecg</span><span class="o">.</span><span class="n">nave</span><span class="p">)</span>
<span class="n">average_ecg</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_003.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_003.png" src="../_images/sphx_glr_plot_artifacts_detection_003.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_004.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_004.png" src="../_images/sphx_glr_plot_artifacts_detection_004.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_005.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_005.png" src="../_images/sphx_glr_plot_artifacts_detection_005.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Reconstructing ECG signal from Magnetometers
Reconstructing ECG signal from Magnetometers
Number of ECG events detected : 283 (average pulse 61 / min.)
Creating RawArray with float64 data, n_channels=1, n_times=166800
    Range : 0 ... 166799 =      0.000 ...   277.714 secs
Ready.
283 matching events found
No baseline correction applied
Created an SSP operator (subspace dimension = 4)
Loading data for 283 events and 601 original time points ...
0 bad epochs dropped
We found 283 ECG events
</pre></div>
</div>
<p>we can see typical time courses and non dipolar topographies
not the order of magnitude of the average artifact related signal and
compare this to what you observe for brain signals</p>
</div>
<div class="section" id="eog">
<h2>EOG<a class="headerlink" href="#eog" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">average_eog</span> <span class="o">=</span> <a href="../generated/mne.preprocessing.create_eog_epochs.html#mne.preprocessing.create_eog_epochs"><span class="n">create_eog_epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;We found </span><span class="si">%i</span><span class="s1"> EOG events&#39;</span> <span class="o">%</span> <span class="n">average_eog</span><span class="o">.</span><span class="n">nave</span><span class="p">)</span>
<span class="n">average_eog</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_006.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_006.png" src="../_images/sphx_glr_plot_artifacts_detection_006.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_007.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_007.png" src="../_images/sphx_glr_plot_artifacts_detection_007.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_artifacts_detection_008.png"><img alt="../_images/sphx_glr_plot_artifacts_detection_008.png" src="../_images/sphx_glr_plot_artifacts_detection_008.png" style="width: 376.0px; height: 197.4px;" /></a>
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>EOG channel index for this subject is: [375]
Filtering the data to remove DC offset to help distinguish blinks from saccades
Now detecting blinks and generating corresponding events
Number of EOG events detected : 46
46 matching events found
No baseline correction applied
Created an SSP operator (subspace dimension = 4)
Loading data for 46 events and 601 original time points ...
0 bad epochs dropped
We found 46 EOG events
</pre></div>
</div>
<p>Knowing these artifact patterns is of paramount importance when
judging about the quality of artifact removal techniques such as SSP or ICA.
As a rule of thumb you need artifact amplitudes orders of magnitude higher
than your signal of interest and you need a few of such events in order
to find decompositions that allow you to estimate and remove patterns related
to artifacts.</p>
<dl class="docutils">
<dt>Consider the following tutorials for correcting this class of artifacts:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="plot_artifacts_correction_filtering.html#tut-artifacts-filter"><span>Filtering and Resampling</span></a></li>
<li><a class="reference internal" href="plot_artifacts_correction_ica.html#tut-artifacts-correct-ica"><span>Artifact Correction with ICA</span></a></li>
<li><a class="reference internal" href="plot_artifacts_correction_ssp.html#tut-artifacts-correct-ssp"><span>Artifact Correction with SSP</span></a></li>
</ul>
</dd>
</dl>
<p><strong>Total running time of the script:</strong>
(0 minutes 18.876 seconds)</p>
<div class="sphx-glr-download container">
<strong>Download Python source code:</strong> <a class="reference download internal" href="../_downloads/plot_artifacts_detection.py"><code class="xref download docutils literal"><span class="pre">plot_artifacts_detection.py</span></code></a></div>
<div class="sphx-glr-download container">
<strong>Download IPython notebook:</strong> <a class="reference download internal" href="../_downloads/plot_artifacts_detection.ipynb"><code class="xref download docutils literal"><span class="pre">plot_artifacts_detection.ipynb</span></code></a></div>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers. Last updated on 2016-05-10.<br/>
    </p>
  </div>
</footer>
  </body>
</html>