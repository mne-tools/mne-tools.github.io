<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mne.filter.construct_iir_filter &#8212; MNE 0.17.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head><body>

<div class="row devbar alert alert-danger">
This documentation is for <strong>development version 0.17.dev0</strong>.
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.17.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Install</a></li>
                <li><a href="../documentation.html">Documentation</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-danger navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.17.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.16 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">mne.filter.construct_iir_filter</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="mne-filter-construct-iir-filter">
<h1>mne.filter.construct_iir_filter<a class="headerlink" href="#mne-filter-construct-iir-filter" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mne.filter.construct_iir_filter">
<code class="descclassname">mne.filter.</code><code class="descname">construct_iir_filter</code><span class="sig-paren">(</span><em>iir_params</em>, <em>f_pass=None</em>, <em>f_stop=None</em>, <em>sfreq=None</em>, <em>btype=None</em>, <em>return_copy=True</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/mne-tools/mne-python/blob/master/mne/filter.py#L515-L699"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mne.filter.construct_iir_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Use IIR parameters to get filtering coefficients.</p>
<p>This function works like a wrapper for iirdesign and iirfilter in
scipy.signal to make filter coefficients for IIR filtering. It also
estimates the number of padding samples based on the filter ringing.
It creates a new iir_params dict (or updates the one passed to the
function) with the filter coefficients (‘b’ and ‘a’) and an estimate
of the padding necessary (‘padlen’) so IIR filtering can be performed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of 0.14, second-order sections will be used in filter
design by default (replacing <code class="docutils literal notranslate"><span class="pre">output='ba'</span></code> by
<code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>) to help ensure filter stability and
reduce numerical error. Second-order sections filtering
requires SciPy &gt;= 16.0.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>iir_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first">Dictionary of parameters to use for IIR filtering.</p>
<blockquote class="last">
<div><ul>
<li><p class="first">If <code class="docutils literal notranslate"><span class="pre">iir_params['sos']</span></code> exists, it will be used as
second-order sections to perform IIR filtering.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.13.</span></p>
</div>
</li>
<li><p class="first">Otherwise, if <code class="docutils literal notranslate"><span class="pre">iir_params['b']</span></code> and <code class="docutils literal notranslate"><span class="pre">iir_params['a']</span></code>
exist, these will be used as coefficients to perform IIR
filtering.</p>
</li>
<li><p class="first">Otherwise, if <code class="docutils literal notranslate"><span class="pre">iir_params['order']</span></code> and
<code class="docutils literal notranslate"><span class="pre">iir_params['ftype']</span></code> exist, these will be used with
<cite>scipy.signal.iirfilter</cite> to make a filter.</p>
</li>
<li><p class="first">Otherwise, if <code class="docutils literal notranslate"><span class="pre">iir_params['gpass']</span></code> and
<code class="docutils literal notranslate"><span class="pre">iir_params['gstop']</span></code> exist, these will be used with
<cite>scipy.signal.iirdesign</cite> to design a filter.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">iir_params['padlen']</span></code> defines the number of samples to pad
(and an estimate will be calculated if it is not given).
See Notes for more details.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">iir_params['output']</span></code> defines the system output kind when
designing filters, either “sos” or “ba”. For 0.13 the
default is ‘ba’ but will change to ‘sos’ in 0.14.</p>
</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>f_pass</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or list of float</span></dt>
<dd><p class="first last">Frequency for the pass-band. Low-pass and high-pass filters should
be a float, band-pass should be a 2-element list of float.</p>
</dd>
<dt><strong>f_stop</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or list of float</span></dt>
<dd><p class="first last">Stop-band frequency (same size as f_pass). Not used if ‘order’ is
specified in iir_params.</p>
</dd>
<dt><strong>sfreq</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float | None</span></dt>
<dd><p class="first last">The sample rate.</p>
</dd>
<dt><strong>btype</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Type of filter. Should be ‘lowpass’, ‘highpass’, or ‘bandpass’
(or analogous string representations known to
<a class="reference external" href="https://scipy.github.io/devdocs/generated/scipy.signal.iirfilter.html#scipy.signal.iirfilter" title="(in SciPy v1.2.0.dev0+d66ee28)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.iirfilter()</span></code></a>).</p>
</dd>
<dt><strong>return_copy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If False, the ‘sos’, ‘b’, ‘a’, and ‘padlen’ entries in
<code class="docutils literal notranslate"><span class="pre">iir_params</span></code> will be set inplace (if they weren’t already).
Otherwise, a new <code class="docutils literal notranslate"><span class="pre">iir_params</span></code> instance will be created and
returned with these entries.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>iir_params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Updated iir_params dict, with the entries (set only if they didn’t
exist before) for ‘sos’ (or ‘b’, ‘a’), and ‘padlen’ for
IIR filtering.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="mne.filter.filter_data.html#mne.filter.filter_data" title="mne.filter.filter_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.filter.filter_data</span></code></a>, <a class="reference internal" href="mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.io.Raw.filter</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This function triages calls to <a class="reference external" href="https://scipy.github.io/devdocs/generated/scipy.signal.iirfilter.html#scipy.signal.iirfilter" title="(in SciPy v1.2.0.dev0+d66ee28)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.iirfilter()</span></code></a> and
<a class="reference external" href="https://scipy.github.io/devdocs/generated/scipy.signal.iirdesign.html#scipy.signal.iirdesign" title="(in SciPy v1.2.0.dev0+d66ee28)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.iirdesign()</span></code></a> based on the input arguments (see
linked functions for more details).</p>
<p class="rubric">Examples</p>
<p>iir_params can have several forms. Consider constructing a low-pass
filter at 40 Hz with 1000 Hz sampling rate.</p>
<p>In the most basic (2-parameter) form of iir_params, the order of the
filter ‘N’ and the type of filtering ‘ftype’ are specified. To get
coefficients for a 4th-order Butterworth filter, this would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="n">construct_iir_filter</span><span class="p">(</span><span class="n">iir_params</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">return_copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;sos&#39;</span><span class="p">]),</span> <span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;padlen&#39;</span><span class="p">]))</span>  
<span class="go">(4, 82)</span>
</pre></div>
</div>
<p>Filters can also be constructed using filter design methods. To get a
40 Hz Chebyshev type 1 lowpass with specific gain characteristics in the
pass and stop bands (assuming the desired stop band is at 45 Hz), this
would be a filter with much longer ringing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;cheby1&#39;</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="n">construct_iir_filter</span><span class="p">(</span><span class="n">iir_params</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;sos&#39;</span><span class="p">]),</span> <span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;padlen&#39;</span><span class="p">]))</span>  
<span class="go">(6, 439)</span>
</pre></div>
</div>
<p>Padding and/or filter coefficients can also be manually specified. For
a 10-sample moving window with no padding during filtering, for example,
one can just do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">)),</span> <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iir_params</span> <span class="o">=</span> <span class="n">construct_iir_filter</span><span class="p">(</span><span class="n">iir_params</span><span class="p">,</span> <span class="n">return_copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">iir_params</span><span class="p">[</span><span class="s1">&#39;padlen&#39;</span><span class="p">]))</span>  
<span class="go">(array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]), [1, 0], 0)</span>
</pre></div>
</div>
<p>For more information, see the tutorials
<a class="reference internal" href="../auto_tutorials/plot_background_filtering.html#sphx-glr-auto-tutorials-plot-background-filtering-py"><span class="std std-ref">Background information on filtering</span></a>
and
<a class="reference internal" href="../auto_tutorials/plot_artifacts_correction_filtering.html#sphx-glr-auto-tutorials-plot-artifacts-correction-filtering-py"><span class="std std-ref">Filtering and resampling data</span></a>.</p>
</dd></dl>

<div style='clear:both'></div></div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2018, MNE Developers. Last updated on 2018-05-22.</p>
  </div>
</footer>
  </body>
</html>