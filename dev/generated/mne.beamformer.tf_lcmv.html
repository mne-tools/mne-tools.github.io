<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mne.beamformer.tf_lcmv &#8212; MNE 0.18.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/reset-syntax.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head><body>

<div class="row devbar alert alert-danger">
This documentation is for <strong>development version 0.18.dev0</strong>.
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.18.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Install</a></li>
                <li><a href="../documentation.html">Documentation</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-danger navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.18.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.17 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">mne.beamformer.tf_lcmv</a><ul>
<li><a class="reference internal" href="#examples-using-mne-beamformer-tf-lcmv">Examples using <code class="docutils literal notranslate"><span class="pre">mne.beamformer.tf_lcmv</span></code></a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="mne-beamformer-tf-lcmv">
<h1>mne.beamformer.tf_lcmv<a class="headerlink" href="#mne-beamformer-tf-lcmv" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="mne.beamformer.tf_lcmv">
<code class="descclassname">mne.beamformer.</code><code class="descname">tf_lcmv</code><span class="sig-paren">(</span><em>epochs</em>, <em>forward</em>, <em>noise_covs</em>, <em>tmin</em>, <em>tmax</em>, <em>tstep</em>, <em>win_lengths</em>, <em>freq_bins</em>, <em>subtract_evoked=False</em>, <em>reg=0.05</em>, <em>label=None</em>, <em>pick_ori=None</em>, <em>n_jobs=1</em>, <em>rank='full'</em>, <em>weight_norm='unit-noise-gain'</em>, <em>raw=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/mne-tools/mne-python/blob/master/mne/beamformer/_lcmv.py#L493-L715"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mne.beamformer.tf_lcmv" title="Permalink to this definition">¶</a></dt>
<dd><p>5D time-frequency beamforming based on LCMV.</p>
<p>Calculate source power in time-frequency windows using a spatial filter
based on the Linearly Constrained Minimum Variance (LCMV) beamforming
approach <a class="reference internal" href="#re8b8272946e4-1" id="id1">[1]</a>. Band-pass filtered epochs are divided into time windows
from which covariance is computed and used to create a beamformer
spatial filter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This implementation has not been heavily tested so please
report any issues or suggestions.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epochs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Epochs</span></dt>
<dd><p class="first last">Single trial epochs. It is recommended to pass epochs that have
been constructed with <code class="docutils literal notranslate"><span class="pre">preload=False</span></code> (i.e., not preloaded or
read from disk) so that the parameter <code class="docutils literal notranslate"><span class="pre">raw=None</span></code> can be used
below, as this ensures the correct <a class="reference internal" href="mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.io.Raw</span></code></a> instance is
used for band-pass filtering.</p>
</dd>
<dt><strong>forward</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Forward operator.</p>
</dd>
<dt><strong>noise_covs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of instances of Covariance | None</span></dt>
<dd><p class="first last">Noise covariance for each frequency bin. If provided, whitening will be
done. Providing noise covariances is mandatory if you mix sensor types,
e.g., gradiometers with magnetometers or EEG with MEG.</p>
</dd>
<dt><strong>tmin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Minimum time instant to consider.</p>
</dd>
<dt><strong>tmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Maximum time instant to consider.</p>
</dd>
<dt><strong>tstep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Spacing between consecutive time windows, should be smaller than or
equal to the shortest time window length.</p>
</dd>
<dt><strong>win_lengths</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">Time window lengths in seconds. One time window length should be
provided for each frequency bin.</p>
</dd>
<dt><strong>freq_bins</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of tuples of float</span></dt>
<dd><p class="first last">Start and end point of frequency bins of interest.</p>
</dd>
<dt><strong>subtract_evoked</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If True, subtract the averaged evoked response prior to computing the
tf source grid.</p>
</dd>
<dt><strong>reg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The regularization for the whitened data covariance.</p>
</dd>
<dt><strong>label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Label | None</span></dt>
<dd><p class="first last">Restricts the solution to a given label.</p>
</dd>
<dt><strong>pick_ori</strong> <span class="classifier-delimiter">:</span> <span class="classifier">None | ‘normal’</span></dt>
<dd><p class="first last">If ‘normal’, rather than pooling the orientations by taking the norm,
only the radial component is kept.
If None, the solution depends on the forward model: if the orientation
is fixed, a scalar beamformer is computed. If the forward model has
free orientation, a vector beamformer is computed, combining the output
for all source orientations.</p>
</dd>
<dt><strong>n_jobs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int | str</span></dt>
<dd><p class="first last">Number of jobs to run in parallel.
Can be ‘cuda’ if <code class="docutils literal notranslate"><span class="pre">cupy</span></code> is installed properly.</p>
</dd>
<dt><strong>rank</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int | None | ‘full’</span></dt>
<dd><p class="first last">This controls the effective rank of the covariance matrix when
computing the inverse. The rank can be set explicitly by specifying an
integer value. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the rank will be automatically estimated.
Since applying regularization will always make the covariance matrix
full rank, the rank is estimated before regularization in this case. If
‘full’, the rank will be estimated after regularization and hence
will mean using the full rank, unless <code class="docutils literal notranslate"><span class="pre">reg=0</span></code> is used.
The default is <code class="docutils literal notranslate"><span class="pre">'full'</span></code>.</p>
</dd>
<dt><strong>weight_norm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">‘unit-noise-gain’ | None</span></dt>
<dd><p class="first last">If ‘unit-noise-gain’, the unit-noise gain minimum variance beamformer
will be computed (Borgiotti-Kaplan beamformer) <a class="reference internal" href="#re8b8272946e4-2" id="id2">[2]</a>,
if None, the unit-gain LCMV beamformer <a class="reference internal" href="#re8b8272946e4-2" id="id3">[2]</a> will be computed.</p>
</dd>
<dt><strong>raw</strong> <span class="classifier-delimiter">:</span> <span class="classifier">instance of Raw | None</span></dt>
<dd><p class="first last">The raw instance used to construct the epochs.
Must be provided unless epochs are constructed with
<code class="docutils literal notranslate"><span class="pre">preload=False</span></code>.</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, str, int, or None</span></dt>
<dd><p class="first last">If not None, override default verbose level (see <a class="reference internal" href="mne.verbose.html#mne.verbose" title="mne.verbose"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.verbose()</span></code></a>
and <a class="reference internal" href="../auto_tutorials/plot_configuration.html#tut-logging"><span class="std std-ref">Logging documentation</span></a> for more).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>stcs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of SourceEstimate</span></dt>
<dd><p class="first last">Source power at each time window. One SourceEstimate object is returned
for each frequency bin.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="re8b8272946e4-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Dalal et al. Five-dimensional neuroimaging: Localization of the
time-frequency dynamics of cortical activity.
NeuroImage (2008) vol. 40 (4) pp. 1686-1700</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="re8b8272946e4-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> Sekihara &amp; Nagarajan. Adaptive spatial filters for electromagnetic
brain imaging (2008) Springer Science &amp; Business Media</td></tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="examples-using-mne-beamformer-tf-lcmv">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">mne.beamformer.tf_lcmv</span></code><a class="headerlink" href="#examples-using-mne-beamformer-tf-lcmv" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="Compute LCMV source power [1]_ in a grid of time-frequency windows and display results."><div class="figure" id="id6">
<img alt="../_images/sphx_glr_plot_tf_lcmv_thumb.png" src="../_images/sphx_glr_plot_tf_lcmv_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../auto_examples/inverse/plot_tf_lcmv.html#sphx-glr-auto-examples-inverse-plot-tf-lcmv-py"><span class="std std-ref">Time-frequency beamforming using LCMV</span></a></span></p>
</div>
</div><div style='clear:both'></div></div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><img src="../_static/institutions.png" alt="Institutions"></div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2018, MNE Developers. Last updated on 2018-11-22.</p>
  </div>
</footer>
  </body>
</html>