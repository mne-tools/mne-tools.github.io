<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mne.preprocessing.find_bad_channels_maxwell &#8212; MNE 0.23.dev0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bootstrap_divs.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../_static/flag-icon.css" type="text/css" />


    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="d-block devbar alert alert-danger">
This is documentation for the <em>unstable development version</em> of MNE-Python,
<a href="https://mne.tools/dev/install/advanced.html#using-the-development-version-of-mne-python-latest-main">available here</a>.
Or, switch to documentation for the <a href="https://mne.tools/stable">current stable version</a>.

</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.svg"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.23.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../install/index.html">Install</a></li>
                <li><a href="../overview/index.html">Overview</a></li>
                <li><a href="../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="../python_reference.html">API</a></li>
            
            
            <li class="dropdown globaltoc-container">
              <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">More<b class="caret"></b></a>
              <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc">
                <li><a href="https://github.com/mne-tools/mne-python"><i class="fa fa-github"></i> GitHub</a></li>
                <li><a href="../overview/get_help.html"><i class="fa fa-question-circle"></i> Get help</a></li>
                <li><a href="../install/contributing.html"><i class="fa fa-code-fork"></i> Contribute</a></li>
                <li><a href="../overview/cite.html"><i class="fa fa-book"></i> Cite MNE</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.23.dev0
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
                <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="mne-preprocessing-find-bad-channels-maxwell">
<h1>mne.preprocessing.find_bad_channels_maxwell<a class="headerlink" href="#mne-preprocessing-find-bad-channels-maxwell" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="mne.preprocessing.find_bad_channels_maxwell">
<code class="sig-prename descclassname">mne.preprocessing.</code><code class="sig-name descname">find_bad_channels_maxwell</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">raw</span></em>, <em class="sig-param"><span class="n">limit</span><span class="o">=</span><span class="default_value">7.0</span></em>, <em class="sig-param"><span class="n">duration</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">min_count</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">return_scores</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">origin</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">int_order</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">ext_order</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">calibration</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cross_talk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coord_frame</span><span class="o">=</span><span class="default_value">'head'</span></em>, <em class="sig-param"><span class="n">regularize</span><span class="o">=</span><span class="default_value">'in'</span></em>, <em class="sig-param"><span class="n">ignore_ref</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">bad_condition</span><span class="o">=</span><span class="default_value">'error'</span></em>, <em class="sig-param"><span class="n">head_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag_scale</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">skip_by_annotation</span><span class="o">=</span><span class="default_value">('edge', 'bad_acq_skip')</span></em>, <em class="sig-param"><span class="n">h_freq</span><span class="o">=</span><span class="default_value">40.0</span></em>, <em class="sig-param"><span class="n">extended_proj</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/mne-tools/mne-python/blob/main/mne/preprocessing/maxwell.py#L1929-L2249"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mne.preprocessing.find_bad_channels_maxwell" title="Permalink to this definition">¶</a></dt>
<dd><p>Find bad channels using Maxwell filtering.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>raw</strong><span class="classifier">instance of <a class="reference internal" href="mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a></span></dt><dd><p>Raw data to process.</p>
</dd>
<dt><strong>limit</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>Detection limit for noisy segments (default is 7.). Smaller values will
find more bad channels at increased risk of including good ones. This
value can be interpreted as the standard score of differences between
the original and Maxwell-filtered data. See the <code class="docutils literal notranslate"><span class="pre">Notes</span></code> section for
details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting only concerns <em>noisy</em> channel detection.
The limit for <em>flat</em> channel detection currently cannot be
controlled by the user. Flat channel detection is always run
before noisy channel detection.</p>
</div>
</dd>
<dt><strong>duration</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>Duration of the segments into which to slice the data for processing,
in seconds. Default is 5.</p>
</dd>
<dt><strong>min_count</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>Minimum number of times a channel must show up as bad in a chunk.
Default is 5.</p>
</dd>
<dt><strong>return_scores</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.9)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a dictionary with scoring information for each
evaluated segment of the data. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is experimental and may change in a future
version of MNE-Python without prior notice. Please
report any problems and enhancement proposals to the
developers.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.</span></p>
</div>
</dd>
<dt><strong>origin</strong><span class="classifier"><a class="reference external" href="https://numpy.org/devdocs/glossary.html#term-array_like" title="(in NumPy v1.21.dev0)"><span>array_like</span></a>, shape (3,) | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>Origin of internal and external multipolar moment space in meters.
The default is <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, which means <code class="docutils literal notranslate"><span class="pre">(0.,</span> <span class="pre">0.,</span> <span class="pre">0.)</span></code> when
<code class="docutils literal notranslate"><span class="pre">coord_frame='meg'</span></code>, and a head-digitization-based
origin fit using <a class="reference internal" href="mne.bem.fit_sphere_to_headshape.html#mne.bem.fit_sphere_to_headshape" title="mne.bem.fit_sphere_to_headshape"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_sphere_to_headshape()</span></code></a>
when <code class="docutils literal notranslate"><span class="pre">coord_frame='head'</span></code>. If automatic fitting fails (e.g., due
to having too few digitization points),
consider separately calling the fitting function with different
options or specifying the origin manually.</p>
</dd>
<dt><strong>int_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>Order of internal component of spherical expansion.</p>
</dd>
<dt><strong>ext_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>Order of external component of spherical expansion.</p>
</dd>
<dt><strong>calibration</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>Path to the <code class="docutils literal notranslate"><span class="pre">'.dat'</span></code> file with fine calibration coefficients.
File can have 1D or 3D gradiometer imbalance correction.
This file is machine/site-specific.</p>
</dd>
<dt><strong>cross_talk</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>Path to the FIF file with cross-talk correction information.</p>
</dd>
<dt><strong>coord_frame</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The coordinate frame that the <code class="docutils literal notranslate"><span class="pre">origin</span></code> is specified in, either
<code class="docutils literal notranslate"><span class="pre">'meg'</span></code> or <code class="docutils literal notranslate"><span class="pre">'head'</span></code>. For empty-room recordings that do not have
a head&lt;-&gt;meg transform <code class="docutils literal notranslate"><span class="pre">info['dev_head_t']</span></code>, the MEG coordinate
frame should be used.</p>
</dd>
<dt><strong>regularize</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>Basis regularization type, must be “in” or None.
“in” is the same algorithm as the “-regularize in” option in
MaxFilter™.</p>
</dd>
<dt><strong>ignore_ref</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.9)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>If True, do not include reference channels in compensation. This
option should be True for KIT files, since Maxwell filtering
with reference channels is not currently supported.</p>
</dd>
<dt><strong>bad_condition</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>How to deal with ill-conditioned SSS matrices. Can be “error”
(default), “warning”, “info”, or “ignore”.</p>
</dd>
<dt><strong>head_pos</strong><span class="classifier"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>If array, movement compensation will be performed.
The array should be of shape (N, 10), holding the position
parameters as returned by e.g. <code class="docutils literal notranslate"><span class="pre">read_head_pos</span></code>.</p>
</dd>
<dt><strong>mag_scale</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The magenetometer scale-factor used to bring the magnetometers
to approximately the same order of magnitude as the gradiometers
(default 100.), as they have different units (T vs T/m).
Can be <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> to use the reciprocal of the physical distance
between the gradiometer pickup loops (e.g., 0.0168 m yields
59.5 for VectorView).</p>
</dd>
<dt><strong>skip_by_annotation</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>If a string (or list of str), any annotation segment that begins
with the given string will not be included in filtering, and
segments on either side of the given excluded annotated segment
will be filtered separately (i.e., as independent signals).
The default <code class="docutils literal notranslate"><span class="pre">('edge',</span> <span class="pre">'bad_acq_skip')</span></code> will separately filter
any segments that were concatenated by <a class="reference internal" href="mne.concatenate_raws.html#mne.concatenate_raws" title="mne.concatenate_raws"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.concatenate_raws()</span></code></a>
or <a class="reference internal" href="mne.io.Raw.html#mne.io.Raw.append" title="mne.io.Raw.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mne.io.Raw.append()</span></code></a>, or separated during acquisition.
To disable, provide an empty list.</p>
</dd>
<dt><strong>h_freq</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>The cutoff frequency (in Hz) of the low-pass filter that will be
applied before processing the data. This defaults to <code class="docutils literal notranslate"><span class="pre">40.</span></code>, which
should provide similar results to MaxFilter. If you do not wish to
apply a filter, set this to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>extended_proj</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a></span></dt><dd><p>The empty-room projection vectors used to extend the external
SSS basis (i.e., use eSSS).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.</span></p>
</div>
</dd>
<dt><strong>verbose</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.9)"><span class="xref std std-ref">bool</span></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></span></dt><dd><p>If not None, override default verbose level (see <a class="reference internal" href="mne.verbose.html#mne.verbose" title="mne.verbose"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.verbose()</span></code></a>
and <a class="reference internal" href="../auto_tutorials/intro/plot_50_configure_mne.html#tut-logging"><span class="std std-ref">Logging documentation</span></a> for more).
If used, it should be passed as a keyword-argument only.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>noisy_chs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a></span></dt><dd><p>List of bad MEG channels that were automatically detected as being
noisy among the good MEG channels.</p>
</dd>
<dt><strong>flat_chs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a></span></dt><dd><p>List of MEG channels that were detected as being flat in at least
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> segments.</p>
</dd>
<dt><strong>scores</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">dict</span></code></a></span></dt><dd><p>A dictionary with information produced by the scoring algorithms.
Only returned when <code class="docutils literal notranslate"><span class="pre">return_scores</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. It contains the
following keys:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ch_names</span></code><span class="classifier">ndarray, shape (n_meg,)</span></dt><dd><p>The names of the MEG channels. Their order corresponds to the
order of rows in the <code class="docutils literal notranslate"><span class="pre">scores</span></code> and <code class="docutils literal notranslate"><span class="pre">limits</span></code> arrays.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ch_types</span></code><span class="classifier">ndarray, shape (n_meg,)</span></dt><dd><p>The types of the MEG channels in <code class="docutils literal notranslate"><span class="pre">ch_names</span></code> (<code class="docutils literal notranslate"><span class="pre">'mag'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'grad'</span></code>).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bins</span></code><span class="classifier">ndarray, shape (n_windows, 2)</span></dt><dd><p>The inclusive window boundaries (start and stop; in seconds) used
to calculate the scores.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">scores_flat</span></code><span class="classifier">ndarray, shape (n_meg, n_windows)</span></dt><dd><p>The scores for testing whether MEG channels are flat. These values
correspond to the standard deviation of a segment.
See the <code class="docutils literal notranslate"><span class="pre">Notes</span></code> section for details.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">limits_flat</span></code><span class="classifier">ndarray, shape (n_meg, 1)</span></dt><dd><p>The score thresholds (in standard deviation) above which a segment
was classified as “flat”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">scores_noisy</span></code><span class="classifier">ndarray, shape (n_meg, n_windows)</span></dt><dd><p>The scores for testing whether MEG channels are noisy. These values
correspond to the standard score of a segment.
See the <code class="docutils literal notranslate"><span class="pre">Notes</span></code> section for details.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">limits_noisy</span></code><span class="classifier">ndarray, shape (n_meg, 1)</span></dt><dd><p>The score thresholds (in standard scores) above which a segment was
classified as “noisy”.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The scores and limits for channels marked as <code class="docutils literal notranslate"><span class="pre">bad</span></code> in the
input data will be set to <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p>
</div>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="mne.preprocessing.annotate_flat.html#mne.preprocessing.annotate_flat" title="mne.preprocessing.annotate_flat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">annotate_flat</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maxwell_filter</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>All arguments after <code class="docutils literal notranslate"><span class="pre">raw</span></code>, <code class="docutils literal notranslate"><span class="pre">limit</span></code>, <code class="docutils literal notranslate"><span class="pre">duration</span></code>, <code class="docutils literal notranslate"><span class="pre">min_count</span></code>, and
<code class="docutils literal notranslate"><span class="pre">return_scores</span></code> are the same as <a class="reference internal" href="mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a>, except that the
following are not allowed in this function because they are unused:
<code class="docutils literal notranslate"><span class="pre">st_duration</span></code>, <code class="docutils literal notranslate"><span class="pre">st_correlation</span></code>, <code class="docutils literal notranslate"><span class="pre">destination</span></code>, <code class="docutils literal notranslate"><span class="pre">st_fixed</span></code>, and
<code class="docutils literal notranslate"><span class="pre">st_only</span></code>.</p>
<p>This algorithm, for a given chunk of data:</p>
<ol class="arabic simple">
<li><p>Runs SSS on the data, without removing external components.</p></li>
<li><p>Excludes channels as <em>flat</em> that have had low variability
(standard deviation &lt; 0.01 fT or fT/cm in a 30 ms window) in the given
or any previous chunk.</p></li>
<li><p>For each channel <span class="math notranslate nohighlight">\(k\)</span>, computes the <em>range</em> or peak-to-peak
<span class="math notranslate nohighlight">\(d_k\)</span> of the difference between the reconstructed and original
data.</p></li>
<li><p>Computes the average <span class="math notranslate nohighlight">\(\mu_d\)</span> and standard deviation
<span class="math notranslate nohighlight">\(\sigma_d\)</span> of the differences (after scaling magnetometer data
to roughly match the scale of the gradiometer data using <code class="docutils literal notranslate"><span class="pre">mag_scale</span></code>).</p></li>
<li><p>Marks channels as bad for the chunk when
<span class="math notranslate nohighlight">\(d_k &gt; \mu_d + \textrm{limit} \times \sigma_d\)</span>. Note that this
expression can be easily transformed into
<span class="math notranslate nohighlight">\((d_k - \mu_d) / \sigma_d &gt; \textrm{limit}\)</span>, which is equivalent
to <span class="math notranslate nohighlight">\(z(d_k) &gt; \textrm{limit}\)</span>, with <span class="math notranslate nohighlight">\(z(d_k)\)</span> being the
standard or z-score of the difference.</p></li>
</ol>
<p>Data are processed in chunks of the given <code class="docutils literal notranslate"><span class="pre">duration</span></code>, and channels that
are bad for at least <code class="docutils literal notranslate"><span class="pre">min_count</span></code> chunks are returned.</p>
<p>Channels marked as <em>flat</em> in step 2 are excluded from all subsequent steps
of noisy channel detection.</p>
<p>This algorithm gives results similar to, but not identical with,
MaxFilter. Differences arise because MaxFilter processes on a
buffer-by-buffer basis (using buffer-size-dependent downsampling logic),
uses different filtering characteristics, and possibly other factors.
Channels that are near the <code class="docutils literal notranslate"><span class="pre">limit</span></code> for a given <code class="docutils literal notranslate"><span class="pre">min_count</span></code> are
particularly susceptible to being different between the two
implementations.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
</dd></dl>

<div class="section" id="examples-using-mne-preprocessing-find-bad-channels-maxwell">
<span id="sphx-glr-backreferences-mne-preprocessing-find-bad-channels-maxwell"></span><h2>Examples using <code class="docutils literal notranslate"><span class="pre">mne.preprocessing.find_bad_channels_maxwell</span></code><a class="headerlink" href="#examples-using-mne-preprocessing-find-bad-channels-maxwell" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="This tutorial covers reducing environmental noise and compensating for head movement with SSS a..."><div class="figure align-default" id="id1">
<img alt="Signal-space separation (SSS) and Maxwell filtering" src="../_images/sphx_glr_plot_60_maxwell_filtering_sss_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../auto_tutorials/preprocessing/plot_60_maxwell_filtering_sss.html#sphx-glr-auto-tutorials-preprocessing-plot-60-maxwell-filtering-sss-py"><span class="std std-ref">Signal-space separation (SSS) and Maxwell filtering</span></a></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div><div class="sphx-glr-clear"></div></div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><div class="row">
    <div class="container col-md-12 institutions">
      <ul class="list-unstyled">
        <li><a href="https://www.massgeneral.org/"><img class="institution" src="../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a></li>
        <li><a href="https://martinos.org/"><img class="institution" src="../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a></li>
        <li><a href="https://hms.harvard.edu/"><img class="institution" src="../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a></li>
        <li><a href="https://web.mit.edu/"><img class="institution" src="../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a></li>
        <li><a href="https://www.nyu.edu/"><img class="institution" src="../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a></li>
        <li><a href="http://www.cea.fr/"><img class="institution" src="../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a></li>
        <li><a href="https://sci.aalto.fi/"><img class="institution" src="../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a></li>
        <li><a href="https://www.telecom-paris.fr/"><img class="institution" src="../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a></li>
        <li><a href="https://www.washington.edu/"><img class="institution" src="../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a></li>
        <li><a href="https://icm-institute.org/"><img class="institution" src="../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a></li>
        <li><a href="https://www.bu.edu/"><img class="institution" src="../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a></li>
        <li><a href="https://www.inserm.fr/"><img class="institution" src="../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a></li>
        <li><a href="https://www.fz-juelich.de/"><img class="institution" src="../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a></li>
        <li><a href="https://www.tu-ilmenau.de/"><img class="institution" src="../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a></li>
        <li><a href="https://bids.berkeley.edu/"><img class="institution" src="../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a></li>
        <li><a href="https://www.inria.fr/"><img class="institution" src="../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a></li>
        <li><a href="https://www.au.dk/"><img class="institution" src="../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a></li>
        <li><a href="https://www.uni-graz.at/"><img class="institution" src="../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a></li>
      </ul>
      <p class="text-center text-muted small">&copy; Copyright 2012-2020, MNE Developers. Last updated on 2020-03-27.</p>
    </div></div></div>
  </footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>