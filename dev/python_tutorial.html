<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial: MEG and EEG data processing with MNE and Python &mdash; MNE 0.9.dev0 documentation</title>
    
    <link rel="stylesheet" href="_static/navy.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MNE 0.9.dev0 documentation" href="index.html" />
    <link rel="up" title="MNE with Python" href="mne-python.html" />
    <link rel="next" title="Tutorial: Getting started with MNE report command" href="mne_report_tutorial.html" />
    <link rel="prev" title="Advanced installation and setup" href="advanced_setup.html" />

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body>

<div style="background-color: red; color: white; font-weight:bold; text-align: center; padding: 10px; min-width: 910px">
This documentation is for the development version (0.9.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>

<div style="background-color: white; text-align: left; padding: 10px 7px 15px 15px; min-width: 910px">
<div style="float: left">
<a href="index.html"><img src="_static/mne_logo.png" border="0" alt="py4sci"/></a>
</div>

<div style="float: right">
<a href="index.html"><img src="_static/institutions.png" border="0" alt="py4sci"/></a>
</div>
<br style="clear:both"/>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="mne_report_tutorial.html" title="Tutorial: Getting started with MNE report command"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="advanced_setup.html" title="Advanced installation and setup"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Home</a>&nbsp;|&nbsp;</li>
        <li><a href="manual.html">Manual</a>&nbsp;|&nbsp;</li>
        <li><a href="mne-python.html">Python</a>&nbsp;|&nbsp;</li>
        <li><a href="cite.html">Cite MNE</a>&nbsp;|&nbsp;</li>
        <!-- <li><a href="search.html">Search</a></li> -->

          <li><a href="mne-python.html" accesskey="U">MNE with Python</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="manual.html">Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="mne-python.html">MNE with Python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_setup.html">Advanced installation and setup</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Tutorial: MEG and EEG data processing with MNE and Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="mne_report_tutorial.html">Tutorial: Getting started with MNE report command</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_reference.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="whats_new.html">What&#8217;s new</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to <em>mne-python</em> source code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mne-cpp.html">MNE with CPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">Cite MNE and MNE-Python</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Versions</h3>
<ul class="current">
    <li class="toctree-l1"><a href=http://martinos.org/mne/stable>Stable</a></li>
    <li class="toctree-l1"><a href=http://martinos.org/mne/dev>Development</a></li>
</ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-meg-and-eeg-data-processing-with-mne-and-python">
<span id="mne-python-tutorial"></span><h1>Tutorial: MEG and EEG data processing with MNE and Python<a class="headerlink" href="#tutorial-meg-and-eeg-data-processing-with-mne-and-python" title="Permalink to this headline">¶</a></h1>
<p>Python offers transparent scripting on top of MNE.
It was designed to be an alternative to the MNE matlab toolbox
but now it can do much more (customize events, compute
contrasts, statistics, time-frequency analysis etc.)
It uses the same files as standard MNE unix commands:
no need to convert your files to a new system or database.</p>
<div class="section" id="what-you-can-do-with-mne-python">
<h2>What you can do with MNE Python<a class="headerlink" href="#what-you-can-do-with-mne-python" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><strong>Raw data visualization</strong> to visualize recordings, can also use <em>mne_browse_raw</em> for extended functionality (see <a class="reference internal" href="manual/browse.html#ch-browse"><em>Processing raw data</em></a>)</li>
<li><strong>Epoching</strong>: Define epochs, baseline correction, handle conditions etc.</li>
<li><strong>Averaging</strong> to get Evoked data</li>
<li><strong>Compute SSP pojectors</strong> to remove ECG and EOG artifacts</li>
<li><strong>Compute ICA</strong> to remove artifacts or select latent sources.</li>
<li><strong>Forward modeling</strong>: BEM computation and mesh creation (see <a class="reference internal" href="manual/forward.html#ch-forward"><em>The forward solution</em></a>)</li>
<li><strong>Linear inverse solvers</strong> (dSPM, sLORETA, MNE, LCMV, DICS)</li>
<li><strong>Sparse inverse solvers</strong> (L1/L2 mixed norm MxNE, Gamma Map, Time-Frequency MxNE)</li>
<li><strong>Connectivity estimation</strong> in sensor and source space</li>
<li><strong>Visualization of sensor and source space data</strong></li>
<li><strong>Time-frequency</strong> analysis with Morlet wavelets (induced power, intertrial coherence, phase lock value) also in the source space</li>
<li><strong>Spectrum estimation</strong> using multi-taper method</li>
<li><strong>Compute contrasts</strong> between conditions, between sensors, across subjects etc.</li>
<li><strong>Non-parametric statistics</strong> in time, space and frequency (including cluster-level)</li>
<li><strong>Scripting</strong> (batch and parallel computing)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="what-you-re-not-supposed-to-do-with-mne-python">
<h2>What you&#8217;re not supposed to do with MNE Python<a class="headerlink" href="#what-you-re-not-supposed-to-do-with-mne-python" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><strong>Dipole fitting</strong> use MNE or other designated software instead.</li>
<li><strong>Boundary Element Modeling</strong> use MNE and Freesurfer.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Package based on the FIF file format from Neuromag but can work with CTF and 4D after conversion to FIF.</p>
</div>
</div>
<div class="section" id="installation-of-the-required-materials">
<h2>Installation of the required materials<a class="headerlink" href="#installation-of-the-required-materials" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="getting_started.html#getting-started"><em>Getting Started</em></a> with Python.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The expected location for the MNE-sample data is my-path-to/mne-python/examples.
If you downloaded data and an example asks you whether to download it again, make sure
the data reside in the examples directory and you run the script from its current directory.</p>
<p>From IPython e.g. say:</p>
<div class="highlight-python"><div class="highlight"><pre>cd examples/preprocessing
</pre></div>
</div>
<p class="last">%run plot_find_ecg_artifacts.py</p>
</div>
</div>
<div class="section" id="from-raw-data-to-evoked-data">
<h2>From raw data to evoked data<a class="headerlink" href="#from-raw-data-to-evoked-data" title="Permalink to this headline">¶</a></h2>
<p>Now, launch <a class="reference external" href="http://ipython.scipy.org/">ipython</a> (Advanced Python shell) using the QT backend which best supported across systems:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ipython -pylab -qt
</pre></div>
</div>
<p>First, load the mne package:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mne</span>
</pre></div>
</div>
<p>If you&#8217;d like to turn information status messages off:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s">&#39;WARNING&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>But it&#8217;s generally a good idea to leave them on:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can set the default level by setting the environment variable
&#8220;MNE_LOGGING_LEVEL&#8221;, or by having mne-python write preferences to a file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="s">&#39;MNE_LOGGING_LEVEL&#39;</span><span class="p">,</span><span class="s">&#39;WARNING&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<p>Note that the location of the mne-python preferences file (for easier manual
editing) can be found using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">get_config_path</span><span class="p">()</span> 
</pre></div>
</div>
<p>By default logging messages print to the console, but look at
mne.set_log_file() to save output to a file.</p>
<div class="section" id="access-raw-data">
<h3>Access raw data<a class="headerlink" href="#access-raw-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_path</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis_filt-0-40_raw.fif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">raw_fname</span><span class="p">)</span> 
<span class="go">./MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MNE sample dataset should be downloaded automatically but be patient (approx. 2GB)</p>
</div>
<p>Read data from file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">Raw</span><span class="p">(</span><span class="n">raw_fname</span><span class="p">)</span> 
<span class="go">Opening raw data ...</span>
<span class="go">Ready.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="go">&lt;Raw  |  n_channels x n_times : 376 x 41700&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">)</span> 
<span class="go">&lt;Info | 20 non-empty ...</span>
</pre></div>
</div>
<p>Look at the channels in raw:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span> 
<span class="go">[&#39;MEG 0113&#39;, &#39;MEG 0112&#39;, ...]</span>
</pre></div>
</div>
<p>Read and plot a segment of raw data</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">time_as_index</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">115</span><span class="p">])</span>  <span class="c"># 100 s to 115 s data segment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span> <span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="go">Reading 15015 ... 17266  =     99.998 ...   114.989 secs...</span>
<span class="go">[done]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(376, 2252)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">times</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2252,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>  <span class="c"># access underlying data</span>
<span class="go">Reading 15015 ... 17266  =     99.998 ...   114.989 secs...</span>
<span class="go">[done]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> 
</pre></div>
</div>
<div class="figure">
<img alt="Raw data" src="_images/plot_read_and_write_raw_data1.png" />
</div>
<p>Save a segment of 150s of raw data (MEG only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;sample_audvis_meg_raw.fif&#39;</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="go">Reading ...</span>
</pre></div>
</div>
</div>
<div class="section" id="define-and-read-epochs">
<h3>Define and read epochs<a class="headerlink" href="#define-and-read-epochs" title="Permalink to this headline">¶</a></h3>
<p>First extract events:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s">&#39;STI 014&#39;</span><span class="p">)</span>
<span class="go">Reading 0 ... 41699  =      0.000 ...   277.709 secs...</span>
<span class="go">[done]</span>
<span class="go">319 events found</span>
<span class="go">Events id: [ 1  2  3  4  5 32]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">events</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[[6994    0    2]</span>
<span class="go"> [7086    0    3]</span>
<span class="go"> [7192    0    1]</span>
<span class="go"> [7304    0    4]</span>
<span class="go"> [7413    0    2]]</span>
</pre></div>
</div>
<p>Note that, by default, we use stim_channel=&#8217;STI 014&#8217;. If you have a different
system (e.g., a newer system that uses channel &#8216;STI101&#8217; by default), you can
use the following to set the default stim channel to use for finding events:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="s">&#39;MNE_STIM_CHANNEL&#39;</span><span class="p">,</span> <span class="s">&#39;STI101&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<p>Events are stored as 2D numpy array where the first column is the time instant
and the last one is the event number. It is therefore easy to manipulate.</p>
<p>Define epochs parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">event_id</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">aud_l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aud_r</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c"># event trigger and conditions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>  <span class="c"># start of each epoch (200ms before the trigger)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmax</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c"># end of each epoch (500ms after the trigger)</span>
</pre></div>
</div>
<p>Exclude some channels (original bads + 2 more):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s">&#39;bads&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;MEG 2443&#39;</span><span class="p">,</span> <span class="s">&#39;EEG 053&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The variable raw.info[&#8216;bads&#8217;] is just a python list.</p>
<p>Pick the good channels, excluding raw.info[&#8216;bads&#8217;]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively one can restrict to magnetometers or gradiometers with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mag_picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s">&#39;mag&#39;</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_picks</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s">&#39;grad&#39;</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s">&#39;bads&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the baseline period:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c"># means from the first instant to t = 0</span>
</pre></div>
</div>
<p>Define peak-to-peak rejection parameters for gradiometers, magnetometers and EOG:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reject</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mf">4e-12</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">)</span>
</pre></div>
</div>
<p>Read epochs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="n">baseline</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="n">reject</span><span class="p">)</span>
<span class="go">Created an SSP operator (subspace dimension = 4)</span>
<span class="go">4 projection items activated</span>
<span class="go">145 matching events found</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
<span class="go">&lt;Epochs  |  n_events : 145 (good &amp; bad), tmin : -0.2 (s), tmax : 0.5 (s), baseline : (None, 0),</span>
<span class="go"> &#39;aud_l&#39;: 72, &#39;aud_r&#39;: 73&gt;</span>
</pre></div>
</div>
<p>Get single epochs for one condition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">epochs_data</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s">&#39;aud_l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> 
<span class="go">Reading ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">epochs_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 365, 106)</span>
</pre></div>
</div>
<p>epochs_data is a 3D array of dimension (55 epochs, 365 channels, 106 time instants).</p>
<p>Scipy supports read and write of matlab files. You can save your single trials with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">io</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s">&#39;epochs_data.mat&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">epochs_data</span><span class="o">=</span><span class="n">epochs_data</span><span class="p">),</span> <span class="n">oned_as</span><span class="o">=</span><span class="s">&#39;row&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or if you want to keep all the information about the data you can save your epochs
in a fif file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">epochs</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;sample-epo.fif&#39;</span><span class="p">)</span> 
<span class="go">Reading ...</span>
</pre></div>
</div>
<p>and read them later with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">saved_epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_epochs</span><span class="p">(</span><span class="s">&#39;sample-epo.fif&#39;</span><span class="p">)</span> 
<span class="go">Reading ...</span>
</pre></div>
</div>
<p>Compute evoked responses for auditory responses by averaging and plot it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evoked</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s">&#39;aud_l&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span> 
<span class="go">Reading ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">evoked</span><span class="p">)</span>
<span class="go">&lt;Evoked  |  comment : &#39;aud_l&#39;, time : [-0.199795, 0.499488], n_epochs : 55, n_channels x n_times : 364 x 106&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evoked</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> 
</pre></div>
</div>
<div class="figure">
<img alt="Evoked data" src="_images/plot_read_epochs1.png" />
</div>
<div class="topic">
<p class="topic-title first">Exercise</p>
<ol class="arabic simple">
<li>Extract the max value of each epoch</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">max_in_each_epoch</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">[</span><span class="s">&#39;aud_l&#39;</span><span class="p">]]</span> 
<span class="go">Reading ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">max_in_each_epoch</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> 
<span class="go">[1.93751...e-05, 1.64055...e-05, 1.85453...e-05, 2.04128...e-05]</span>
</pre></div>
</div>
</div>
<p>It is also possible to read evoked data stored in a fif file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evoked_fname</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis-ave.fif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evoked1</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_evokeds</span><span class="p">(</span><span class="n">evoked_fname</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="s">&#39;Left Auditory&#39;</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="go">Reading .../MNE-sample-data/MEG/sample/sample_audvis-ave.fif ...</span>
<span class="go">    Read a total of 4 projection items:</span>
<span class="go">        PCA-v1 (1 x 102) active</span>
<span class="go">        PCA-v2 (1 x 102) active</span>
<span class="go">        PCA-v3 (1 x 102) active</span>
<span class="go">        Average EEG reference (1 x 60) active</span>
<span class="go">    Found the data of interest:</span>
<span class="go">        t =    -199.80 ...     499.49 ms (Left Auditory)</span>
<span class="go">        0 CTF compensation matrices available</span>
<span class="go">        nave = 55 - aspect type = 100</span>
<span class="go">Projections have already been applied. Setting proj attribute to True.</span>
<span class="go">Applying baseline correction ... (mode: mean)</span>
</pre></div>
</div>
<p>Or another one stored in the same file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">evoked2</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_evokeds</span><span class="p">(</span><span class="n">evoked_fname</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="s">&#39;Right Auditory&#39;</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
<span class="go">Reading ...</span>
</pre></div>
</div>
<p>Compute a contrast:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">contrast</span> <span class="o">=</span> <span class="n">evoked1</span> <span class="o">-</span> <span class="n">evoked2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">contrast</span><span class="p">)</span>
<span class="go">&lt;Evoked  |  comment : &#39;Left Auditory - Right Auditory&#39;, time : [-0.199795, 0.499488], n_epochs : 116, n_channels x n_times : 376 x 421&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="time-frequency-induced-power-and-inter-trial-coherence">
<h3>Time-Frequency: Induced power and inter trial coherence<a class="headerlink" href="#time-frequency-induced-power-and-inter-trial-coherence" title="Permalink to this headline">¶</a></h3>
<p>Define parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_cycles</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c"># number of cycles in Morlet wavelet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c"># frequencies of interest</span>
</pre></div>
</div>
<p>Compute induced power and phase-locking values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mne.time_frequency</span> <span class="kn">import</span> <span class="n">tfr_morlet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">power</span><span class="p">,</span> <span class="n">itc</span> <span class="o">=</span> <span class="n">tfr_morlet</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">freqs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="n">n_cycles</span><span class="p">,</span> <span class="n">return_itc</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="go">Reading 712 ...</span>
</pre></div>
</div>
<div class="figure">
<img alt="Time-Frequency" src="_images/plot_time_frequency.png" />
</div>
</div>
<div class="section" id="inverse-modeling-mne-and-dspm-on-evoked-and-raw-data">
<h3>Inverse modeling: MNE and dSPM on evoked and raw data<a class="headerlink" href="#inverse-modeling-mne-and-dspm-on-evoked-and-raw-data" title="Permalink to this headline">¶</a></h3>
<p>Import the required functions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <span class="n">apply_inverse</span><span class="p">,</span> <span class="n">read_inverse_operator</span>
</pre></div>
</div>
<p>Read the inverse operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_inv</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/sample_audvis-meg-oct-6-meg-inv.fif&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_operator</span> <span class="o">=</span> <span class="n">read_inverse_operator</span><span class="p">(</span><span class="n">fname_inv</span><span class="p">)</span> 
<span class="go">Reading ...</span>
</pre></div>
</div>
<p>Define the inverse parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">snr</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">snr</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">method</span> <span class="o">=</span> <span class="s">&quot;dSPM&quot;</span>
</pre></div>
</div>
<p>Compute the inverse solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stc</span> <span class="o">=</span> <span class="n">apply_inverse</span><span class="p">(</span><span class="n">evoked</span><span class="p">,</span> <span class="n">inverse_operator</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<span class="go">Preparing the inverse operator for use...</span>
<span class="go">    Scaled noise and source covariance from nave = 1 to nave = 55</span>
<span class="go">    Created the regularized inverter</span>
<span class="go">    Created an SSP operator (subspace dimension = 3)</span>
<span class="go">    Created the whitener using a full noise covariance matrix (3 small eigenvalues omitted)</span>
<span class="go">    Computing noise-normalization factors (dSPM)...</span>
<span class="go">[done]</span>
<span class="go">Picked 305 channels from the data</span>
<span class="go">Computing inverse...</span>
<span class="go">(eigenleads need to be weighted)...</span>
<span class="go">combining the current components...</span>
<span class="go">(dSPM)...</span>
<span class="go">[done]</span>
</pre></div>
</div>
<p>Save the source time courses to disk:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;mne_dSPM_inverse&#39;</span><span class="p">)</span>
<span class="go">Writing STC to disk...</span>
<span class="go">[done]</span>
</pre></div>
</div>
<p>Now, let&#8217;s compute dSPM on a raw file within a label:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fname_label</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="s">&#39;/MEG/sample/labels/Aud-lh.label&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">read_label</span><span class="p">(</span><span class="n">fname_label</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute inverse solution during the first 15s:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <span class="n">apply_inverse_raw</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">time_as_index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>  <span class="c"># read the first 15s of data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stc</span> <span class="o">=</span> <span class="n">apply_inverse_raw</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">inverse_operator</span><span class="p">,</span> <span class="n">lambda2</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
<span class="go">Preparing the inverse operator for use...</span>
<span class="go">    Scaled noise and source covariance from nave = 1 to nave = 1</span>
<span class="go">    Created the regularized inverter</span>
<span class="go">    Created an SSP operator (subspace dimension = 3)</span>
<span class="go">    Created the whitener using a full noise covariance matrix (3 small eigenvalues omitted)</span>
<span class="go">    Computing noise-normalization factors (dSPM)...</span>
<span class="go">[done]</span>
<span class="go">Picked 305 channels from the data</span>
<span class="go">Computing inverse...</span>
<span class="go">Reading 0 ... 2251  =      0.000 ...    14.991 secs...</span>
<span class="go">[done]</span>
<span class="go">(eigenleads need to be weighted)...</span>
<span class="go">combining the current components...</span>
<span class="go">[done]</span>
</pre></div>
</div>
<p>Save result in stc files:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;mne_dSPM_raw_inverse_Aud&#39;</span><span class="p">)</span>
<span class="go">Writing STC to disk...</span>
<span class="go">[done]</span>
</pre></div>
</div>
</div>
<div class="section" id="what-else-can-you-do">
<h3>What else can you do?<a class="headerlink" href="#what-else-can-you-do" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>detect heart beat QRS component</li>
<li>detect eye blinks and EOG artifacts</li>
<li>compute SSP projections to remove ECG or EOG artifacts</li>
<li>compute Independent Component Analysis (ICA) to remove artifacts or select latent sources</li>
<li>estimate noise covariance matrix from Raw and Epochs</li>
<li>visualize cross-trial response dynamics using epochs images</li>
<li>compute forward solutions</li>
<li>estimate power in the source space</li>
<li>estimate connectivity in sensor and source space</li>
<li>morph stc from one brain to another for group studies</li>
<li>compute mass univariate statistics base on custom contrasts</li>
<li>visualize source estimates</li>
<li>export raw, epochs, and evoked data to other python data analysis libraries i.e. pandas and nitime</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="want-to-know-more">
<h3>Want to know more ?<a class="headerlink" href="#want-to-know-more" title="Permalink to this headline">¶</a></h3>
<p>Browse <a class="reference internal" href="auto_examples/index.html#examples-index"><em>Examples</em></a> gallery.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2015, MNE Developers.
      Last updated on May 14, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>