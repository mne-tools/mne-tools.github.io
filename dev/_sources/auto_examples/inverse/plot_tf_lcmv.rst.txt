

.. _sphx_glr_auto_examples_inverse_plot_tf_lcmv.py:


=====================================
Time-frequency beamforming using LCMV
=====================================

Compute LCMV source power in a grid of time-frequency windows and display
results.

The original reference is:
Dalal et al. Five-dimensional neuroimaging: Localization of the time-frequency
dynamics of cortical activity. NeuroImage (2008) vol. 40 (4) pp. 1686-1700



.. code-block:: python

    # Author: Roman Goj <roman.goj@gmail.com>
    #
    # License: BSD (3-clause)

    import mne
    from mne import compute_covariance
    from mne.datasets import sample
    from mne.event import make_fixed_length_events
    from mne.beamformer import tf_lcmv
    from mne.viz import plot_source_spectrogram

    print(__doc__)

    data_path = sample.data_path()
    raw_fname = data_path + '/MEG/sample/sample_audvis_raw.fif'
    noise_fname = data_path + '/MEG/sample/ernoise_raw.fif'
    event_fname = data_path + '/MEG/sample/sample_audvis_raw-eve.fif'
    fname_fwd = data_path + '/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif'
    subjects_dir = data_path + '/subjects'
    label_name = 'Aud-lh'
    fname_label = data_path + '/MEG/sample/labels/%s.label' % label_name







Read raw data, preload to allow filtering



.. code-block:: python

    raw = mne.io.read_raw_fif(raw_fname, preload=True)
    raw.info['bads'] = ['MEG 2443']  # 1 bad MEG channel

    # Pick a selection of magnetometer channels. A subset of all channels was used
    # to speed up the example. For a solution based on all MEG channels use
    # meg=True, selection=None and add grad=4000e-13 to the reject dictionary.
    # We could do this with a "picks" argument to Epochs and the LCMV functions,
    # but here we use raw.pick_types() to save memory.
    left_temporal_channels = mne.read_selection('Left-temporal')
    raw.pick_types(meg='mag', eeg=False, eog=False, stim=False, exclude='bads',
                   selection=left_temporal_channels)
    reject = dict(mag=4e-12)
    # Re-normalize our empty-room projectors, which should be fine after
    # subselection
    raw.info.normalize_proj()

    # Setting time limits for reading epochs. Note that tmin and tmax are set so
    # that time-frequency beamforming will be performed for a wider range of time
    # points than will later be displayed on the final spectrogram. This ensures
    # that all time bins displayed represent an average of an equal number of time
    # windows.
    tmin, tmax = -0.55, 0.75  # s
    tmin_plot, tmax_plot = -0.3, 0.5  # s

    # Read epochs. Note that preload is set to False to enable tf_lcmv to read the
    # underlying raw object.
    # Filtering is then performed on raw data in tf_lcmv and the epochs
    # parameters passed here are used to create epochs from filtered data. However,
    # reading epochs without preloading means that bad epoch rejection is delayed
    # until later. To perform bad epoch rejection based on the reject parameter
    # passed here, run epochs.drop_bad(). This is done automatically in
    # tf_lcmv to reject bad epochs based on unfiltered data.
    event_id = 1
    events = mne.read_events(event_fname)
    epochs = mne.Epochs(raw, events, event_id, tmin, tmax, proj=True,
                        baseline=None, preload=False, reject=reject)

    # Read empty room noise, preload to allow filtering, and pick subselection
    raw_noise = mne.io.read_raw_fif(noise_fname, preload=True)
    raw_noise.info['bads'] = ['MEG 2443']  # 1 bad MEG channel
    raw_noise.pick_types(meg='mag', eeg=False, eog=False, stim=False,
                         exclude='bads', selection=left_temporal_channels)
    raw_noise.info.normalize_proj()

    # Create artificial events for empty room noise data
    events_noise = make_fixed_length_events(raw_noise, event_id, duration=1.)
    # Create an epochs object using preload=True to reject bad epochs based on
    # unfiltered data
    epochs_noise = mne.Epochs(raw_noise, events_noise, event_id, tmin, tmax,
                              proj=True, baseline=None,
                              preload=True, reject=reject)

    # Make sure the number of noise epochs is the same as data epochs
    epochs_noise = epochs_noise[:len(epochs.events)]

    # Read forward operator
    forward = mne.read_forward_solution(fname_fwd, surf_ori=True)

    # Read label
    label = mne.read_label(fname_label)





.. rst-class:: sphx-glr-script-out

 Out::

    Opening raw data file /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 25800 ... 192599 =     42.956 ...   320.670 secs
    Ready.
    Current compensation grade : 0
    Reading 0 ... 166799  =      0.000 ...   277.714 secs...
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Opening raw data file /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/ernoise_raw.fif...
    Isotrak not found
        Read a total of 3 projection items:
            PCA-v1 (1 x 102)  idle
            PCA-v2 (1 x 102)  idle
            PCA-v3 (1 x 102)  idle
        Range : 19800 ... 85867 =     32.966 ...   142.965 secs
    Ready.
    Current compensation grade : 0
    Reading 0 ... 66067  =      0.000 ...   109.999 secs...
    110 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 110 events and 781 original time points ...
    1 bad epochs dropped
    Reading forward solution from /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis-meg-eeg-oct-6-fwd.fif...
        Reading a source space...
        Computing patch statistics...
        Patch information added...
        Distance information added...
        [done]
        Reading a source space...
        Computing patch statistics...
        Patch information added...
        Distance information added...
        [done]
        2 source spaces read
        Desired named matrix (kind = 3523) not available
        Read MEG forward solution (7498 sources, 306 channels, free orientations)
        Desired named matrix (kind = 3523) not available
        Read EEG forward solution (7498 sources, 60 channels, free orientations)
        MEG and EEG forward solutions combined
        Source spaces transformed to the forward solution coordinate frame
        Converting to surface-based source orientations...
        Average patch normals will be employed in the rotation to the local surface coordinates....
    [done]


Time-frequency beamforming based on LCMV



.. code-block:: python


    # Setting frequency bins as in Dalal et al. 2008 (high gamma was subdivided)
    freq_bins = [(4, 12), (12, 30), (30, 55), (65, 299)]  # Hz
    win_lengths = [0.3, 0.2, 0.15, 0.1]  # s

    # Setting the time step
    tstep = 0.05

    # Setting the whitened data covariance regularization parameter
    data_reg = 0.001

    # Subtract evoked response prior to computation?
    subtract_evoked = False

    # Calculating covariance from empty room noise. To use baseline data as noise
    # substitute raw for raw_noise, epochs.events for epochs_noise.events, tmin for
    # desired baseline length, and 0 for tmax_plot.
    # Note, if using baseline data, the averaged evoked response in the baseline
    # period should be flat.
    noise_covs = []
    for (l_freq, h_freq) in freq_bins:
        raw_band = raw_noise.copy()
        raw_band.filter(l_freq, h_freq, n_jobs=1)
        epochs_band = mne.Epochs(raw_band, epochs_noise.events, event_id,
                                 tmin=tmin_plot, tmax=tmax_plot, baseline=None,
                                 proj=True)

        noise_cov = compute_covariance(epochs_band, method='shrunk')
        noise_covs.append(noise_cov)
        del raw_band  # to save memory

    # Computing LCMV solutions for time-frequency windows in a label in source
    # space for faster computation, use label=None for full solution
    stcs = tf_lcmv(epochs, forward, noise_covs, tmin, tmax, tstep, win_lengths,
                   freq_bins=freq_bins, subtract_evoked=subtract_evoked,
                   reg=data_reg, label=label)

    # Plotting source spectrogram for source with maximum activity.
    # Note that tmin and tmax are set to display a time range that is smaller than
    # the one for which beamforming estimates were calculated. This ensures that
    # all time bins shown are a result of smoothing across an identical number of
    # time windows.
    plot_source_spectrogram(stcs, freq_bins, tmin=tmin_plot, tmax=tmax_plot,
                            source_index=None, colorbar=True)



.. image:: /auto_examples/inverse/images/sphx_glr_plot_tf_lcmv_001.png
    :align: center


.. rst-class:: sphx-glr-script-out

 Out::

    Setting up band-pass filter from 4 - 12 Hz
    l_trans_bandwidth chosen to be 2.0 Hz
    h_trans_bandwidth chosen to be 3.0 Hz
    Filter length of 1982 samples (3.300 sec) selected
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 481 original time points ...
    0 bad epochs dropped
    Estimating covariance using SHRUNK
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 34632
    [done]
    log-likelihood on unseen data (descending order):
       shrunk: -35.028
    selecting best estimator: shrunk
    Setting up band-pass filter from 12 - 30 Hz
    l_trans_bandwidth chosen to be 3.0 Hz
    h_trans_bandwidth chosen to be 7.5 Hz
    Filter length of 1321 samples (2.199 sec) selected
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 481 original time points ...
    0 bad epochs dropped
    Estimating covariance using SHRUNK
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 34632
    [done]
    log-likelihood on unseen data (descending order):
       shrunk: -38.827
    selecting best estimator: shrunk
    Setting up band-pass filter from 30 - 55 Hz
    l_trans_bandwidth chosen to be 7.5 Hz
    h_trans_bandwidth chosen to be 13.8 Hz
    Filter length of 529 samples (0.881 sec) selected
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 481 original time points ...
    0 bad epochs dropped
    Estimating covariance using SHRUNK
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 34632
    [done]
    log-likelihood on unseen data (descending order):
       shrunk: -39.998
    selecting best estimator: shrunk
    Setting up band-pass filter from 65 - 3e+02 Hz
    l_trans_bandwidth chosen to be 16.2 Hz
    h_trans_bandwidth chosen to be 1.3 Hz
    Filter length of 3032 samples (5.048 sec) selected
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 481 original time points ...
    0 bad epochs dropped
    Estimating covariance using SHRUNK
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 34632
    [done]
    log-likelihood on unseen data (descending order):
       shrunk: -46.416
    selecting best estimator: shrunk
    Loading data for 72 events and 781 original time points ...
    0 bad epochs dropped
    Setting up band-pass filter from 4 - 12 Hz
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 781 original time points ...
    0 bad epochs dropped
    Computing time-frequency LCMV beamformer for time window -550 to -250 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.244
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -500 to -200 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.144
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -450 to -150 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.026
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -400 to -100 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.947
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -350 to -50 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.763
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -300 to 0 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.751
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -250 to 49 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.974
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -200 to 99 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.214
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -150 to 149 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.540
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -100 to 199 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.812
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -50 to 249 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -111.077
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 0 to 300 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -111.140
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 50 to 350 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -111.043
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 99 to 399 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.806
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 150 to 450 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.429
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 199 to 499 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.000
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 250 to 550 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.818
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 300 to 600 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.714
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 350 to 649 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.836
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 400 to 700 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.008
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 449 to 750 ms, in frequency range 4 to 12 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 13032
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -110.190
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Setting up band-pass filter from 12 - 30 Hz
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 781 original time points ...
    0 bad epochs dropped
    Computing time-frequency LCMV beamformer for time window -550 to -350 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.808
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -500 to -300 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.679
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -450 to -250 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.375
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -400 to -200 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.106
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -350 to -150 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.065
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -300 to -100 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.155
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -250 to -49 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.339
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -200 to 0 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.334
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -150 to 49 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.192
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -100 to 99 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.436
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -50 to 149 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.563
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 0 to 200 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.714
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 50 to 250 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.673
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 99 to 300 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.360
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 150 to 350 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.227
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 199 to 399 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.276
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 250 to 450 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.464
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 300 to 500 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.607
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 350 to 550 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.616
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 400 to 600 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.600
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 449 to 649 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.379
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 500 to 700 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.566
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 550 to 750 ms, in frequency range 12 to 30 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 8712
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -109.801
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Setting up band-pass filter from 30 - 55 Hz
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 781 original time points ...
    0 bad epochs dropped
    Computing time-frequency LCMV beamformer for time window -550 to -400 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.461
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -500 to -350 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.516
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -450 to -300 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.452
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -400 to -250 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.221
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -350 to -200 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.103
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -300 to -150 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.174
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -250 to -100 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.388
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -200 to -50 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.363
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -150 to 0 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.296
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -100 to 49 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.193
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -50 to 99 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.357
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 0 to 150 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.545
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 50 to 200 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.427
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 99 to 249 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.391
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 150 to 300 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.354
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 199 to 350 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.308
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 250 to 400 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.190
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 300 to 450 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.145
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 350 to 500 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.140
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 400 to 550 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.190
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 449 to 600 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.120
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 500 to 650 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.129
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 550 to 700 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.234
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 600 to 750 ms, in frequency range 30 to 55 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 6552
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -106.309
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Setting up band-pass filter from 65 - 3e+02 Hz
    72 matching events found
    Created an SSP operator (subspace dimension = 3)
    3 projection items activated
    Loading data for 72 events and 781 original time points ...
    0 bad epochs dropped
    Computing time-frequency LCMV beamformer for time window -550 to -450 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.443
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -500 to -400 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.483
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -450 to -350 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.342
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -400 to -300 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.207
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -350 to -250 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.290
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -300 to -200 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.216
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -250 to -150 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.235
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -200 to -100 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.308
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -150 to -50 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.337
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -100 to 0 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.508
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window -50 to 49 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.434
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 0 to 100 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.415
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 50 to 150 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.406
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 99 to 199 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.308
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 150 to 250 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.256
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 199 to 299 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.267
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 250 to 350 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.341
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 300 to 400 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.310
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 350 to 449 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.279
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 400 to 500 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.332
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 449 to 549 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.438
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 500 to 600 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.409
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 550 to 650 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.307
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 600 to 700 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.227
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Computing time-frequency LCMV beamformer for time window 650 to 750 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.212
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]
    Adding a time window to cover last time points
    Computing time-frequency LCMV beamformer for time window 650 to 750 ms, in frequency range 65 to 299 Hz
    Estimating covariance using EMPIRICAL
    Done.
    Using cross-validation to select the best estimator.
    Number of samples used : 4392
    [done]
    log-likelihood on unseen data (descending order):
       empirical: -112.212
    selecting best estimator: empirical
        13 out of 366 channels remain after picking
        Created an SSP operator (subspace dimension = 3)
    estimated rank (mag): 10
    Setting small MEG eigenvalues to zero.
    Not doing PCA for MEG.
    [done]


**Total running time of the script:** ( 0 minutes  24.884 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_tf_lcmv.py <plot_tf_lcmv.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_tf_lcmv.ipynb <plot_tf_lcmv.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <http://sphinx-gallery.readthedocs.io>`_
