<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EEG processing and Event Related Potentials (ERPs) &#8212; MNE 0.23.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />


    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="d-block devbar alert alert-danger">
This is documentation for the <em>unstable development version</em> of MNE-Python,
<a href="https://mne.tools/dev/install/advanced.html#using-the-development-version-of-mne-python-latest-main">available here</a>.
Or, switch to documentation for the <a href="https://mne.tools/stable">current stable version</a>.

</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.svg"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.23.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
            
            
            <li class="dropdown globaltoc-container">
              <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">More<b class="caret"></b></a>
              <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc">
                <li><a href="https://github.com/mne-tools/mne-python"><i class="fa fa-github"></i> GitHub</a></li>
                <li><a href="../../overview/get_help.html"><i class="fa fa-question-circle"></i> Get help</a></li>
                <li><a href="../../install/contributing.html"><i class="fa fa-code-fork"></i> Contribute</a></li>
                <li><a href="../../overview/cite.html"><i class="fa fa-book"></i> Cite MNE</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.23.dev0
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
                <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-evoked-plot-eeg-erp-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="eeg-processing-and-event-related-potentials-erps">
<span id="tut-erp"></span><span id="sphx-glr-auto-tutorials-evoked-plot-eeg-erp-py"></span><h1>EEG processing and Event Related Potentials (ERPs)<a class="headerlink" href="#eeg-processing-and-event-related-potentials-erps" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="here-we-cover-the-specifics-of-eeg-namely">
<p class="topic-title">Here we cover the specifics of EEG, namely:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#setting-eeg-reference" id="id4">Setting EEG reference</a></p></li>
<li><p><a class="reference internal" href="#global-field-power-gfp" id="id5">Global field power (GFP)</a></p></li>
<li><p><a class="reference internal" href="#evoked-response-averaged-across-channels-by-roi" id="id6">Evoked response averaged across channels by ROI</a></p></li>
<li><p><a class="reference internal" href="#evoked-arithmetic-e-g-differences" id="id7">Evoked arithmetic (e.g. differences)</a></p></li>
<li><p><a class="reference internal" href="#references" id="id8">References</a></p></li>
</ul>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">mne.channels</span> <span class="kn">import</span> <a href="../../generated/mne.channels.combine_channels.html#mne.channels.combine_channels" title="mne.channels.combine_channels" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">combine_channels</span></a>
</pre></div>
</div>
<p>Setup for reading the raw data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis_filt-0-40_raw.fif&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis_filt-0-40_raw-eve.fif&#39;</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
    Read a total of 4 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
        Average EEG reference (1 x 60)  idle
    Range : 6450 ... 48149 =     42.956 ...   320.665 secs
Ready.
</pre></div>
</div>
<p>Let’s restrict the data to the EEG channels</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># This particular dataset already has an average reference projection added</span>
<span class="c1"># that we now want to remove it for the sake of this example.</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.set_eeg_reference" title="mne.io.Raw.set_eeg_reference" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">([])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Removing projector &lt;Projection | PCA-v1, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : False, n_channels : 102&gt;
Reading 0 ... 41699  =      0.000 ...   277.709 secs...
EEG channel type selected for re-referencing
EEG data marked as already having the desired reference.
Removing existing average EEG reference projection.
</pre></div>
</div>
<p>By looking at the measurement info you will see that we have now
59 EEG channels and 1 EOG channel</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Info | 13 non-empty values
 bads: []
 ch_names: EEG 001, EEG 002, EEG 003, EEG 004, EEG 005, EEG 006, EEG 007, ...
 chs: 59 EEG, 1 EOG
 custom_ref_applied: False
 dev_head_t: MEG device -&gt; head transform
 dig: 146 items (3 Cardinal, 4 HPI, 61 EEG, 78 Extra)
 file_id: 4 items (dict)
 highpass: 0.1 Hz
 hpi_meas: 1 item (list)
 hpi_results: 1 item (list)
 lowpass: 40.0 Hz
 meas_date: 2002-12-03 19:01:10 UTC
 meas_id: 4 items (dict)
 nchan: 60
 projs: []
 sfreq: 150.2 Hz
&gt;
</pre></div>
</div>
<p>In practice it’s quite common to have some EEG channels that are actually
EOG channels. To change a channel type you can use the
<a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.io.Raw.set_channel_types()</span></code></a> method. For example
to treat an EOG channel as EEG you can change its type using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span></a><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EOG 061&#39;</span><span class="p">:</span> <span class="s1">&#39;eeg&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Info | 13 non-empty values
 bads: []
 ch_names: EEG 001, EEG 002, EEG 003, EEG 004, EEG 005, EEG 006, EEG 007, ...
 chs: 60 EEG
 custom_ref_applied: False
 dev_head_t: MEG device -&gt; head transform
 dig: 146 items (3 Cardinal, 4 HPI, 61 EEG, 78 Extra)
 file_id: 4 items (dict)
 highpass: 0.1 Hz
 hpi_meas: 1 item (list)
 hpi_results: 1 item (list)
 lowpass: 40.0 Hz
 meas_date: 2002-12-03 19:01:10 UTC
 meas_id: 4 items (dict)
 nchan: 60
 projs: []
 sfreq: 150.2 Hz
&gt;
</pre></div>
</div>
<p>And to change the name of the EOG channel</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.rename_channels" title="mne.io.Raw.rename_channels" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">rename_channels</span></a><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EOG 061&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Let’s reset the EOG channel back to EOG type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span></a><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EOG&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The EEG channels in the sample dataset already have locations.
These locations are available in the ‘loc’ of each channel description.
For the first channel we get</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;chs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;loc&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.03737009  0.10568011  0.07333875  0.00235201  0.11096951 -0.03500458
  0.          1.          0.          0.          0.          1.        ]
</pre></div>
</div>
<p>And it’s actually possible to plot the channel locations using
<a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_sensors" title="mne.io.Raw.plot_sensors"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.io.Raw.plot_sensors()</span></code></a>.
In the case where your data don’t have locations you can use one of the
standard <a class="reference internal" href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Montages</span></code></a> shipped with MNE.
See <a class="reference internal" href="../../auto_examples/visualization/montage.html#plot-montage"><span class="std std-ref">Plotting sensor layouts of EEG systems</span></a> and <a class="reference internal" href="../source-modeling/plot_eeg_no_mri.html#tut-eeg-fsaverage-source-modeling"><span class="std std-ref">EEG forward operator with a template MRI</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_sensors" title="mne.io.Raw.plot_sensors" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">plot_sensors</span></a><span class="p">()</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_sensors" title="mne.io.Raw.plot_sensors" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">plot_sensors</span></a><span class="p">(</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>  <span class="c1"># in 3D</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="plot eeg erp" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_001.png" />
</li>
<li><img alt="plot eeg erp" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_002.png" />
</li>
</ul>
<div class="section" id="setting-eeg-reference">
<h2><a class="toc-backref" href="#id4">Setting EEG reference</a><a class="headerlink" href="#setting-eeg-reference" title="Permalink to this headline">¶</a></h2>
<p>Let’s first inspect our Raw object with its original reference that was
applied during the recording of the data.
We define Epochs and compute an ERP for the left auditory condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">180e-6</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;left/auditory&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="../../generated/mne.read_events.html#mne.read_events" title="mne.read_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span>
                     <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject</span></a><span class="p">)</span>

<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_no_ref</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a> <span class="o">=</span> <span class="s1">&#39;EEG Original reference&#39;</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_no_ref</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">titles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">),</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot_topomap" title="mne.EvokedArray.plot_topomap" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_no_ref</span><span class="o">.</span><span class="n">plot_topomap</span></a><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="EEG Original reference (59 channels)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_003.png" />
</li>
<li><img alt="EEG Original reference, 0.100 s, µV" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_004.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Not setting metadata
Not setting metadata
72 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
0 projection items activated
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 007&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 003&#39;, &#39;EEG 007&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 003&#39;, &#39;EEG 007&#39;]
</pre></div>
</div>
<p><strong>Common average reference (car)</strong>: We add back the average reference
projection that we removed at the beginning of this example (right after
loading the data).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw_car</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="o">=</span> <a href="../../generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="mne.set_eeg_reference" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_car</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw_car</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="k">del</span> <span class="n">raw_car</span>  <span class="c1"># save memory</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a> <span class="o">=</span> <span class="s1">&#39;EEG Average reference&#39;</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_car</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">titles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">),</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot_topomap" title="mne.EvokedArray.plot_topomap" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_car</span><span class="o">.</span><span class="n">plot_topomap</span></a><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="EEG Average reference (59 channels)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_005.png" />
</li>
<li><img alt="EEG Average reference, 0.100 s, µV" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_006.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Adding average EEG reference projection.
1 projection items deactivated
Average reference projection was added, but has not been applied yet. Use the apply_proj method to apply it.
Not setting metadata
Not setting metadata
72 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 1)
1 projection items activated
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
</pre></div>
</div>
<p><strong>Custom reference</strong>: Use the mean of channels EEG 001 and EEG 002 as
a reference</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw_custom</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="o">=</span> <a href="../../generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="mne.set_eeg_reference" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;EEG 001&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 002&#39;</span><span class="p">])</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_custom</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw_custom</span><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="k">del</span> <span class="n">raw_custom</span>  <span class="c1"># save memory</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a> <span class="o">=</span> <span class="s1">&#39;EEG Custom reference&#39;</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_custom</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">titles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">),</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot_topomap" title="mne.EvokedArray.plot_topomap" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_custom</span><span class="o">.</span><span class="n">plot_topomap</span></a><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="EEG Custom reference (59 channels)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_007.png" />
</li>
<li><img alt="EEG Custom reference, 0.100 s, µV" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_008.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>EEG channel type selected for re-referencing
Applying a custom EEG reference.
Removing existing average EEG reference projection.
Not setting metadata
Not setting metadata
72 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
0 projection items activated
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
</pre></div>
</div>
</div>
<div class="section" id="global-field-power-gfp">
<h2><a class="toc-backref" href="#id5">Global field power (GFP)</a><a class="headerlink" href="#global-field-power-gfp" title="Permalink to this headline">¶</a></h2>
<p>Global field power <a class="footnote-reference brackets" href="#lehmann1980" id="id1">1</a><a class="footnote-reference brackets" href="#lehmann1984" id="id2">2</a><a class="footnote-reference brackets" href="#murray2008" id="id3">3</a> is,
generally speaking, a measure of agreement of the signals picked up by all
sensors across the entire scalp: if all sensors have the same value at a
given time point, the GFP will be zero at that time point; if the signals
differ, the GFP will be non-zero at that time point. GFP
peaks may reflect “interesting” brain activity, warranting further
investigation. Mathematically, the GFP is the population standard
deviation across all sensors, calculated separately for every time point.</p>
<p>You can plot the GFP using <a class="reference internal" href="../../generated/mne.Evoked.html#mne.Evoked.plot" title="mne.Evoked.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evoked.plot(gfp=True)</span></code></a>. The GFP
trace will be black if <code class="docutils literal notranslate"><span class="pre">spatial_colors=True</span></code> and green otherwise. The EEG
reference will not affect the GFP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evk</span></a> <span class="ow">in</span> <span class="p">(</span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_car</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_no_ref</span></a><span class="p">):</span>
    <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evk</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp</span></a><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]))</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="EEG (59 channels)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_009.png" />
</li>
<li><img alt="EEG (59 channels)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_010.png" />
</li>
</ul>
<p>To plot the GFP by itself you can pass <code class="docutils literal notranslate"><span class="pre">gfp='only'</span></code> (this makes it easier
to read off the GFP data values, because the scale is aligned):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_car</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp</span></a><span class="o">=</span><span class="s1">&#39;only&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="EEG (59 channels)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_erp_011.png" />
<p>As stated above, the GFP is the population standard deviation of the signal
across channels. To compute it manually, we can leverage
the fact that <a class="reference internal" href="../../generated/mne.Evoked.html#mne.Evoked.data" title="mne.Evoked.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evoked.data</span></code></a> is a NumPy array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp</span></a> <span class="o">=</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.data" title="mne.EvokedArray.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_car</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Reproducing the plot style from above:</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_car</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.fill_between.html#matplotlib.axes.Axes.fill_between" title="matplotlib.axes.Axes.fill_between" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_car</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gfp</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.artist.Artist.set.html#matplotlib.artist.Artist.set" title="matplotlib.artist.Artist.set" class="sphx-glr-backref-module-matplotlib-artist sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set</span></a><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;GFP (µV)&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="EEG" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_erp_012.png" />
</div>
<div class="section" id="evoked-response-averaged-across-channels-by-roi">
<h2><a class="toc-backref" href="#id6">Evoked response averaged across channels by ROI</a><a class="headerlink" href="#evoked-response-averaged-across-channels-by-roi" title="Permalink to this headline">¶</a></h2>
<p>It is possible to average channels by region of interest (for example left
and right) when studying the response to this left auditory stimulus. Here we
use our Raw object on which the average reference projection has been added
back.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a><span class="p">)</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">left_idx</span></a> <span class="o">=</span> <a href="../../generated/mne.pick_channels.html#mne.pick_channels" title="mne.pick_channels" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_channels</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;ch_names&#39;</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;EEG 017&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 018&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 025&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 026&#39;</span><span class="p">])</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">right_idx</span></a> <span class="o">=</span> <a href="../../generated/mne.pick_channels.html#mne.pick_channels" title="mne.pick_channels" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_channels</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;ch_names&#39;</span><span class="p">],</span>
                              <span class="p">[</span><span class="s1">&#39;EEG 023&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 024&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 034&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG 035&#39;</span><span class="p">])</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">roi_dict</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Left</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">left_idx</span></a><span class="p">,</span> <span class="n">Right</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">right_idx</span></a><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_combined</span></a> <span class="o">=</span> <a href="../../generated/mne.channels.combine_channels.html#mne.channels.combine_channels" title="mne.channels.combine_channels" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">combine_channels</span></a><span class="p">(</span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">roi_dict</span></a><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a> <span class="o">=</span> <span class="s1">&#39;Evoked response averaged by side&#39;</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot" title="mne.EvokedArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked_combined</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">titles</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">),</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Evoked response averaged by side (2 channels)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_erp_013.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Not setting metadata
Not setting metadata
72 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 1)
1 projection items activated
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
</pre></div>
</div>
</div>
<div class="section" id="evoked-arithmetic-e-g-differences">
<h2><a class="toc-backref" href="#id7">Evoked arithmetic (e.g. differences)</a><a class="headerlink" href="#evoked-arithmetic-e-g-differences" title="Permalink to this headline">¶</a></h2>
<p>Trial subsets from Epochs can be selected using ‘tags’ separated by ‘/’.
Evoked objects support basic arithmetic.
First, we create an Epochs object containing 4 conditions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;left/auditory&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;right/auditory&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;left/visual&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;right/visual&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span>
                     <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject</span></a><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_params</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Not setting metadata
Not setting metadata
288 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 1)
1 projection items activated
&lt;Epochs |  288 events (good &amp; bad), -0.199795 - 0.499488 sec, baseline [-0.199795, 0] sec, ~2.9 MB, data not loaded,
 &#39;left/auditory&#39;: 72
 &#39;left/visual&#39;: 73
 &#39;right/auditory&#39;: 73
 &#39;right/visual&#39;: 70&gt;
</pre></div>
</div>
<p>Next, we create averages of stimulation-left vs stimulation-right trials.
We can use negative weights in <a class="reference internal" href="../../generated/mne.combine_evoked.html#mne.combine_evoked" title="mne.combine_evoked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.combine_evoked</span></code></a> to construct difference
ERPs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">left</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">right</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">(),</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>

<span class="c1"># create and plot difference ERP</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">joint_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ts_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">),</span>
                    <span class="n">topomap_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<a href="../../generated/mne.combine_evoked.html#mne.combine_evoked" title="mne.combine_evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span></a><span class="p">([</span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">left</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">right</span></a><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">joint_kwargs</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="0.093 s, 0.160 s, 0.213 s" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_erp_014.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
Projections have already been applied. Setting proj attribute to True.
</pre></div>
</div>
<p>This is an equal-weighting difference. If you have imbalanced trial numbers,
you could also consider either equalizing the number of events per
condition (using
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.equalize_event_counts" title="mne.Epochs.equalize_event_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">epochs.equalize_event_counts</span></code></a>) or
use weights proportional to the number of trials averaged together to create
each <a class="reference internal" href="../../generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Evoked</span></code></a> (by passing <code class="docutils literal notranslate"><span class="pre">weights='nave'</span></code> to <a class="reference internal" href="../../generated/mne.combine_evoked.html#mne.combine_evoked" title="mne.combine_evoked"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_evoked</span></code></a>).
As an example, first, we create individual ERPs for each condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aud_l</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;auditory/left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aud_r</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;auditory/right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vis_l</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;visual/left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vis_r</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s2">&quot;visual/right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a> <span class="o">=</span> <span class="p">[</span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aud_l</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">aud_r</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vis_l</span></a><span class="p">,</span> <a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vis_r</span></a><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
[&lt;Evoked | &#39;left/auditory&#39; (average, N=56), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;right/auditory&#39; (average, N=62), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;left/visual&#39; (average, N=67), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;right/visual&#39; (average, N=56), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;]
</pre></div>
</div>
<p>This can be simplified with a Python list comprehension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a> <span class="o">=</span> <span class="p">[</span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span> <span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">)</span>

<span class="c1"># Then, we can construct and plot an unweighted average of left vs. right</span>
<span class="c1"># trials this way, too:</span>
<a href="../../generated/mne.combine_evoked.html#mne.combine_evoked" title="mne.combine_evoked" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">joint_kwargs</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="0.093 s, 0.160 s, 0.213 s" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_erp_015.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
[&lt;Evoked | &#39;left/auditory&#39; (average, N=56), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;left/visual&#39; (average, N=67), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;right/auditory&#39; (average, N=62), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;, &lt;Evoked | &#39;right/visual&#39; (average, N=56), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;]
Projections have already been applied. Setting proj attribute to True.
</pre></div>
</div>
<p>Often, it makes sense to store Evoked objects in a dictionary or a list -
either different conditions, or different subjects.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># If they are stored in a list, they can be easily averaged, for example,</span>
<span class="c1"># for a grand average across subjects (or conditions).</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grand_average</span></a> <span class="o">=</span> <a href="../../generated/mne.grand_average.html#mne.grand_average" title="mne.grand_average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">grand_average</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">)</span>
<span class="c1"># And they can be written to disk like any other evoked data, e.g.:</span>
<span class="c1"># mne.write_evokeds(&#39;tmp-ave.fif&#39;, all_evokeds)</span>

<span class="c1"># If Evokeds objects are stored in a dictionary, they can be retrieved by name.</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a><span class="p">,</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">())</span> <span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">[</span><span class="s1">&#39;left/auditory&#39;</span><span class="p">])</span>

<span class="c1"># Besides for explicit access, this can be used for example to set titles.</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">all_evokeds</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cond</span></a><span class="p">,</span> <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">joint_kwargs</span></a><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="0.093 s, 0.206 s, 0.306 s" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_016.png" />
</li>
<li><img alt="0.087 s, 0.206 s, 0.333 s" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_017.png" />
</li>
<li><img alt="0.180 s, 0.260 s, 0.333 s" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_018.png" />
</li>
<li><img alt="0.093 s, 0.173 s, 0.260 s" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_eeg_erp_019.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Identifying common channels ...
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG&#39;]
&lt;Evoked | &#39;left/auditory&#39; (average, N=56), [-0.1998, 0.49949] sec, 59 ch, ~3.0 MB&gt;
Projections have already been applied. Setting proj attribute to True.
Projections have already been applied. Setting proj attribute to True.
Projections have already been applied. Setting proj attribute to True.
Projections have already been applied. Setting proj attribute to True.
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id8">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-footbibliography-auto_tutorials/evoked/plot_eeg_erp-0"><dl class="footnote brackets">
<dt class="label" id="lehmann1980"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Dietrich Lehmann and Wolfgang Skrandies. Reference-free identification of components of checkerboard-evoked multichannel potential fields. <em>Electroencephalography and Clinical Neurophysiology</em>, 48(6):609–621, jun 1980. <a class="reference external" href="https://doi.org/10.1016/0013-4694(80)90419-8">doi:10.1016/0013-4694(80)90419-8</a>.</p>
</dd>
<dt class="label" id="lehmann1984"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Dietrich Lehmann and Wolfgang Skrandies. Spatial analysis of evoked potentials in man—a review. <em>Progress in Neurobiology</em>, 23(3):227–250, jan 1984. <a class="reference external" href="https://doi.org/10.1016/0301-0082(84)90003-0">doi:10.1016/0301-0082(84)90003-0</a>.</p>
</dd>
<dt class="label" id="murray2008"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Micah M. Murray, Denis Brunet, and Christoph M. Michel. Topographic ERP analyses: A step-by-step tutorial review. <em>Brain Topography</em>, 20(4):249–264, mar 2008. <a class="reference external" href="https://doi.org/10.1007/s10548-008-0054-5">doi:10.1007/s10548-008-0054-5</a>.</p>
</dd>
</dl>
</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  24.239 seconds)</p>
<p><strong>Estimated memory usage:</strong>  8 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-evoked-plot-eeg-erp-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c9a895dbafc04fd2c4f61fac7d519f02/plot_eeg_erp.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_eeg_erp.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5f84ce88b4773e5ca1f9b3502aef334a/plot_eeg_erp.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_eeg_erp.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><div class="row">
    <div class="container col-md-12 institutions">
      <ul class="list-unstyled">
        <li><a href="https://www.massgeneral.org/"><img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a></li>
        <li><a href="https://martinos.org/"><img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a></li>
        <li><a href="https://hms.harvard.edu/"><img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a></li>
        <li><a href="https://web.mit.edu/"><img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a></li>
        <li><a href="https://www.nyu.edu/"><img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a></li>
        <li><a href="http://www.cea.fr/"><img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a></li>
        <li><a href="https://sci.aalto.fi/"><img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a></li>
        <li><a href="https://www.telecom-paris.fr/"><img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a></li>
        <li><a href="https://www.washington.edu/"><img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a></li>
        <li><a href="https://icm-institute.org/"><img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a></li>
        <li><a href="https://www.bu.edu/"><img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a></li>
        <li><a href="https://www.inserm.fr/"><img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a></li>
        <li><a href="https://www.fz-juelich.de/"><img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a></li>
        <li><a href="https://www.tu-ilmenau.de/"><img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a></li>
        <li><a href="https://bids.berkeley.edu/"><img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a></li>
        <li><a href="https://www.inria.fr/"><img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a></li>
        <li><a href="https://www.au.dk/"><img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a></li>
        <li><a href="https://www.uni-graz.at/"><img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a></li>
      </ul>
      <p class="text-center text-muted small">&copy; Copyright 2012-2021, MNE Developers. Last updated <time datetime="2021-02-09T12:34:49.655983+00:00" class="localized">2021-02-09 12:34 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
    </div></div></div>
  </footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>