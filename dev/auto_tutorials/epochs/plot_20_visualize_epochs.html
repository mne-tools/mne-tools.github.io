<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visualizing epoched data &#8212; MNE 0.23.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />


    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="d-block devbar alert alert-danger">
This is documentation for the <em>unstable development version</em> of MNE-Python,
<a href="https://mne.tools/dev/install/advanced.html#using-the-development-version-of-mne-python-latest-master">available here</a>.
Or, switch to documentation for the <a href="https://mne.tools/stable">current stable version</a>.

</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.svg"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.23.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
            
            
            <li class="dropdown globaltoc-container">
              <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">More<b class="caret"></b></a>
              <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc">
                <li><a href="https://github.com/mne-tools/mne-python"><i class="fa fa-github"></i> GitHub</a></li>
                <li><a href="../../overview/get_help.html"><i class="fa fa-question-circle"></i> Get help</a></li>
                <li><a href="../../install/contributing.html"><i class="fa fa-code-fork"></i> Contribute</a></li>
                <li><a href="../../overview/cite.html"><i class="fa fa-book"></i> Cite MNE</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.23.dev0
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
                <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-epochs-plot-20-visualize-epochs-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="visualizing-epoched-data">
<span id="tut-visualize-epochs"></span><span id="sphx-glr-auto-tutorials-epochs-plot-20-visualize-epochs-py"></span><h1>Visualizing epoched data<a class="headerlink" href="#visualizing-epoched-data" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to plot epoched data as time series, how to plot the
spectral density of epoched data, how to plot epochs as an imagemap, and how to
plot the sensor locations and projectors stored in <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a>
objects.</p>
<div class="contents local topic" id="page-contents">
<p class="topic-title">Page contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#plotting-epochs-as-time-series" id="id1">Plotting <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> as time series</a></p></li>
<li><p><a class="reference internal" href="#plotting-projectors-from-an-epochs-object" id="id2">Plotting projectors from an <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> object</a></p></li>
<li><p><a class="reference internal" href="#plotting-sensor-locations" id="id3">Plotting sensor locations</a></p></li>
<li><p><a class="reference internal" href="#plotting-the-power-spectrum-of-epochs" id="id4">Plotting the power spectrum of <code class="docutils literal notranslate"><span class="pre">Epochs</span></code></a></p></li>
<li><p><a class="reference internal" href="#plotting-epochs-as-an-image-map" id="id5">Plotting <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> as an image map</a></p></li>
</ul>
</div>
<p>We’ll start by importing the modules we need, loading the continuous (raw)
sample data, and cropping it to save memory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mne</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_raw_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_raw_file</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">tmax</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
</pre></div>
</div>
<p>To create the <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a> data structure, we’ll extract the event
IDs stored in the <a class="reference internal" href="../../glossary.html#term-stim-channel"><span class="xref std std-term">stim channel</span></a>, map those integer event IDs to more
descriptive condition labels using an event dictionary, and pass those to the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a> constructor, along with the <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a> data
and the desired temporal limits of our epochs, <code class="docutils literal notranslate"><span class="pre">tmin</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code> (for a
detailed explanation of these steps, see <a class="reference internal" href="plot_10_epochs_overview.html#tut-epochs-class"><span class="std std-ref">The Epochs data structure: discontinuous data</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="../../generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI 014&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_dict</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;auditory/left&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;auditory/right&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;visual/left&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s1">&#39;visual/right&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;face&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;button&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_dict</span></a><span class="p">,</span>
                    <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">raw</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>176 events found
Event IDs: [ 1  2  3  4  5 32]
Not setting metadata
Not setting metadata
176 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 3)
3 projection items activated
Loading data for 176 events and 421 original time points ...
1 bad epochs dropped
</pre></div>
</div>
<div class="section" id="plotting-epochs-as-time-series">
<h2><a class="toc-backref" href="#id1">Plotting <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> as time series</a><a class="headerlink" href="#plotting-epochs-as-time-series" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="sidebar-title">Interactivity in pipelines and scripts</p>
<p>To use the interactive features of the <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot" title="mne.Epochs.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a> method
when running your code non-interactively, pass the <code class="docutils literal notranslate"><span class="pre">block=True</span></code>
parameter, which halts the Python interpreter until the figure window is
closed. That way, any channels or epochs that you mark as “bad” will be
taken into account in subsequent processing steps.</p>
</div>
<p>To visualize epoched data as time series (one time series per channel), the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot" title="mne.Epochs.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.Epochs.plot</span></code></a> method is available. It creates an interactive window
where you can scroll through epochs and channels, enable/disable any
unapplied <a class="reference internal" href="../../glossary.html#term-projector"><span class="xref std std-term">SSP projectors</span></a> to see how they affect the
signal, and even manually mark bad channels (by clicking the channel name) or
bad epochs (by clicking the data) for later dropping. Channels marked “bad”
will be shown in light grey color and will be added to
<code class="docutils literal notranslate"><span class="pre">epochs.info['bads']</span></code>; epochs marked as bad will be indicated as <code class="docutils literal notranslate"><span class="pre">'USER'</span></code>
in <code class="docutils literal notranslate"><span class="pre">epochs.drop_log</span></code>.</p>
<p>Here we’ll plot only the “catch” trials from the <a class="reference internal" href="../../overview/datasets_index.html#sample-dataset"><span class="std std-ref">sample dataset</span></a>, and pass in our events array so that the button press
responses also get marked (we’ll plot them in red, and plot the “face” events
defining time zero for each epoch in blue). We also need to pass in
our <code class="docutils literal notranslate"><span class="pre">event_dict</span></code> so that the <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot" title="mne.Epochs.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a> method will know what
we mean by “button” — this is because subsetting the conditions by
calling <code class="docutils literal notranslate"><span class="pre">epochs['face']</span></code> automatically purges the dropped entries from
<code class="docutils literal notranslate"><span class="pre">epochs.event_id</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catch_trials_and_buttonpresses</span></a> <span class="o">=</span> <a href="../../generated/mne.pick_events.html#mne.pick_events" title="mne.pick_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_events</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;face&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catch_trials_and_buttonpresses</span></a><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_dict</span></a><span class="p">,</span>
                    <span class="n">event_color</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">button</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>
</pre></div>
</div>
<img alt="plot 20 visualize epochs" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_001.png" />
<p>To see all sensors at once, we can use butterfly mode and group by selection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;face&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">catch_trials_and_buttonpresses</span></a><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_dict</span></a><span class="p">,</span>
                    <span class="n">event_color</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">button</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
                    <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;selection&#39;</span><span class="p">,</span> <span class="n">butterfly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_002.png" />
</li>
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_003.png" />
</li>
</ul>
</div>
<div class="section" id="plotting-projectors-from-an-epochs-object">
<h2><a class="toc-backref" href="#id2">Plotting projectors from an <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> object</a><a class="headerlink" href="#plotting-projectors-from-an-epochs-object" title="Permalink to this headline">¶</a></h2>
<p>In the plot above we can see heartbeat artifacts in the magnetometer
channels, so before we continue let’s load ECG projectors from disk and apply
them to the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ecg_proj_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;sample_audvis_ecg-proj.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ecg_projs</span></a> <span class="o">=</span> <a href="../../generated/mne.read_proj.html#mne.read_proj" title="mne.read_proj" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_proj</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ecg_proj_file</span></a><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs.add_proj" title="mne.Epochs.add_proj" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">add_proj</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ecg_projs</span></a><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs.apply_proj" title="mne.Epochs.apply_proj" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">apply_proj</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Read a total of 6 projection items:
        ECG-planar-999--0.200-0.400-PCA-01 (1 x 203)  idle
        ECG-planar-999--0.200-0.400-PCA-02 (1 x 203)  idle
        ECG-axial-999--0.200-0.400-PCA-01 (1 x 102)  idle
        ECG-axial-999--0.200-0.400-PCA-02 (1 x 102)  idle
        ECG-eeg-999--0.200-0.400-PCA-01 (1 x 59)  idle
        ECG-eeg-999--0.200-0.400-PCA-02 (1 x 59)  idle
6 projection items deactivated
Created an SSP operator (subspace dimension = 9)
9 projection items activated
SSP projectors applied...
</pre></div>
</div>
<p>Just as we saw in the <a class="reference internal" href="../raw/plot_40_visualize_raw.html#tut-section-raw-plot-proj"><span class="std std-ref">Plotting projectors from Raw objects</span></a> section, we can plot
the projectors present in an <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a> object using the same
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_projs_topomap" title="mne.Epochs.plot_projs_topomap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_projs_topomap</span></code></a> method. Since the original three
empty-room magnetometer projectors were inherited from the
<a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a> file, and we added two ECG projectors for each sensor
type, we should see nine projector topomaps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs.plot_projs_topomap" title="mne.Epochs.plot_projs_topomap" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">plot_projs_topomap</span></a><span class="p">(</span><span class="n">vlim</span><span class="o">=</span><span class="s1">&#39;joint&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="PCA-v1, PCA-v2, PCA-v3, ECG-planar-999--0.200- 0.400-PCA-01, ECG-planar-999--0.200- 0.400-PCA-02, ECG-axial-999--0.200-0 .400-PCA-01, ECG-axial-999--0.200-0 .400-PCA-02, ECG-eeg-999--0.200-0.4 00-PCA-01, ECG-eeg-999--0.200-0.4 00-PCA-02" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_004.png" />
<p>Note that these field maps illustrate aspects of the signal that <em>have
already been removed</em> (because projectors in <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a> data are
applied by default when epoching, and because we called
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.apply_proj" title="mne.Epochs.apply_proj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_proj</span></code></a> after adding additional ECG projectors from
file). You can check this by examining the <code class="docutils literal notranslate"><span class="pre">'active'</span></code> field of the
projectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="n">proj</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;projs&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
<div class="section" id="plotting-sensor-locations">
<h2><a class="toc-backref" href="#id3">Plotting sensor locations</a><a class="headerlink" href="#plotting-sensor-locations" title="Permalink to this headline">¶</a></h2>
<p>Just like <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a> objects, <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a> objects
keep track of sensor locations, which can be visualized with the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_sensors" title="mne.Epochs.plot_sensors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_sensors</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs.plot_sensors" title="mne.Epochs.plot_sensors" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">plot_sensors</span></a><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs.plot_sensors" title="mne.Epochs.plot_sensors" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">plot_sensors</span></a><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;topomap&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_005.png" />
</li>
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_006.png" />
</li>
</ul>
</div>
<div class="section" id="plotting-the-power-spectrum-of-epochs">
<h2><a class="toc-backref" href="#id4">Plotting the power spectrum of <code class="docutils literal notranslate"><span class="pre">Epochs</span></code></a><a class="headerlink" href="#plotting-the-power-spectrum-of-epochs" title="Permalink to this headline">¶</a></h2>
<p>Again, just like <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Raw</span></code></a> objects, <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Epochs</span></code></a> objects
have a <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_psd" title="mne.Epochs.plot_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_psd</span></code></a> method for plotting the <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_density">spectral
density</a> of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="EEG" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_007.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using multitaper spectrum estimation with 7 DPSS windows
</pre></div>
</div>
<p>It is also possible to plot spectral estimates across sensors as a scalp
topography, using <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_psd_topomap" title="mne.Epochs.plot_psd_topomap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_psd_topomap</span></code></a>. The default parameters will
plot five frequency bands (δ, θ, α, β, γ), will compute power based on
magnetometer channels, and will plot the power estimates in decibels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;visual/right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_psd_topomap</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Delta (0-4 Hz), Theta (4-8 Hz), Alpha (8-12 Hz), Beta (12-30 Hz), Gamma (30-45 Hz)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_008.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using multitaper spectrum estimation with 7 DPSS windows
</pre></div>
</div>
<p>Just like <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_projs_topomap" title="mne.Epochs.plot_projs_topomap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_projs_topomap</span></code></a>,
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_psd_topomap" title="mne.Epochs.plot_psd_topomap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_psd_topomap</span></code></a> has a <code class="docutils literal notranslate"><span class="pre">vlim='joint'</span></code> option for fixing
the colorbar limits jointly across all subplots, to give a better sense of
the relative magnitude in each band. You can change which channel type is
used  via the <code class="docutils literal notranslate"><span class="pre">ch_type</span></code> parameter, and if you want to view different
frequency bands than the defaults, the <code class="docutils literal notranslate"><span class="pre">bands</span></code> parameter takes a list of
tuples, with each tuple containing either a single frequency and a subplot
title, or lower/upper frequency limits and a subplot title:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;10 Hz&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;15 Hz&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;20 Hz&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;10-20 Hz&#39;</span><span class="p">)]</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;visual/right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_psd_topomap</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="p">,</span> <span class="n">vlim</span><span class="o">=</span><span class="s1">&#39;joint&#39;</span><span class="p">,</span>
                                        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="10 Hz, 15 Hz, 20 Hz, 10-20 Hz" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_009.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using multitaper spectrum estimation with 7 DPSS windows
</pre></div>
</div>
<p>If you prefer untransformed power estimates, you can pass <code class="docutils literal notranslate"><span class="pre">dB=False</span></code>. It is
also possible to normalize the power estimates by dividing by the total power
across all frequencies, by passing <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code>. See the docstring of
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_psd_topomap" title="mne.Epochs.plot_psd_topomap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_psd_topomap</span></code></a> for details.</p>
</div>
<div class="section" id="plotting-epochs-as-an-image-map">
<h2><a class="toc-backref" href="#id5">Plotting <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> as an image map</a><a class="headerlink" href="#plotting-epochs-as-an-image-map" title="Permalink to this headline">¶</a></h2>
<p>A convenient way to visualize many epochs simultaneously is to plot them as
an image map, with each row of pixels in the image representing a single
epoch, the horizontal axis representing time, and each pixel’s color
representing the signal value at that time sample for that epoch. Of course,
this requires either a separate image map for each channel, or some way of
combining information across channels. The latter is possible using the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> method; the former can be achieved with the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> method (one channel at a time) or with the
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_topo_image" title="mne.Epochs.plot_topo_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_topo_image</span></code></a> method (all sensors at once).</p>
<p>By default, the image map generated by <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> will be
accompanied by a scalebar indicating the range of the colormap, and a time
series showing the average signal across epochs and a bootstrapped 95%
confidence band around the mean. <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> is a highly
customizable method with many parameters, including customization of the
auxiliary colorbar and averaged time series subplots. See the docstrings of
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> and <a class="reference internal" href="../../generated/mne.viz.plot_compare_evokeds.html#mne.viz.plot_compare_evokeds" title="mne.viz.plot_compare_evokeds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.viz.plot_compare_evokeds</span></code></a> (which is
used to plot the average time series) for full details. Here we’ll show the
mean across magnetometers for all epochs with an auditory stimulus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_image</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Magnetometers (mean)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_010.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Not setting metadata
Not setting metadata
81 matching events found
No baseline correction applied
0 projection items activated
0 bad epochs dropped
combining channels using &quot;mean&quot;
</pre></div>
</div>
<p>To plot image maps for individual sensors or a small group of sensors, use
the <code class="docutils literal notranslate"><span class="pre">picks</span></code> parameter. Passing <code class="docutils literal notranslate"><span class="pre">combine=None</span></code> (the default) will yield
separate plots for each sensor in <code class="docutils literal notranslate"><span class="pre">picks</span></code>; passing <code class="docutils literal notranslate"><span class="pre">combine='gfp'</span></code> will
plot the global field power (useful for combining sensors that respond with
opposite polarity).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_image</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEG 0242&#39;</span><span class="p">,</span> <span class="s1">&#39;MEG 0243&#39;</span><span class="p">])</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_image</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEG 0242&#39;</span><span class="p">,</span> <span class="s1">&#39;MEG 0243&#39;</span><span class="p">],</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;gfp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="MEG 0242" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_011.png" />
</li>
<li><img alt="MEG 0243" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_012.png" />
</li>
<li><img alt="MEG 0242, MEG 0243 (GFP)" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_013.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Not setting metadata
Not setting metadata
81 matching events found
No baseline correction applied
0 projection items activated
0 bad epochs dropped
Not setting metadata
Not setting metadata
81 matching events found
No baseline correction applied
0 projection items activated
0 bad epochs dropped
Not setting metadata
Not setting metadata
81 matching events found
No baseline correction applied
0 projection items activated
0 bad epochs dropped
combining channels using &quot;gfp&quot;
</pre></div>
</div>
<p>To plot an image map for <em>all</em> sensors, use
<a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_topo_image" title="mne.Epochs.plot_topo_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_topo_image</span></code></a>, which is optimized for plotting a large
number of image maps simultaneously, and (in interactive sessions) allows you
to click on each small image map to pop open a separate figure with the
full-sized image plot (as if you had called <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_image" title="mne.Epochs.plot_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_image</span></code></a> on
just that sensor). At the small scale shown in this tutorial it’s hard to see
much useful detail in these plots; it’s often best when plotting
interactively to maximize the topo image plots to fullscreen. The default is
a figure with black background, so here we specify a white background and
black foreground text. By default <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_topo_image" title="mne.Epochs.plot_topo_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_topo_image</span></code></a> will
show magnetometers and gradiometers on the same plot (and hence not show a
colorbar, since the sensors are on different scales) so we’ll also pass a
<a class="reference internal" href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Layout</span></code></a> restricting each plot to one channel type.
First, however, we’ll also drop any epochs that have unusually high signal
levels, because they can cause the colormap limits to be too extreme and
therefore mask smaller signal fluctuations of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_criteria</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">mag</span><span class="o">=</span><span class="mf">3000e-15</span><span class="p">,</span>     <span class="c1"># 3000 fT</span>
                       <span class="n">grad</span><span class="o">=</span><span class="mf">3000e-13</span><span class="p">,</span>    <span class="c1"># 3000 fT/cm</span>
                       <span class="n">eeg</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">)</span>       <span class="c1"># 150 µV</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs.drop_bad" title="mne.Epochs.drop_bad" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">drop_bad</span></a><span class="p">(</span><span class="n">reject</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_criteria</span></a><span class="p">)</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">mag</span><span class="o">=</span><span class="s1">&#39;Magnetometers&#39;</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span><span class="s1">&#39;Gradiometers&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">find_layout</span><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="p">)</span>
    <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory/left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topo_image</span><span class="p">(</span><a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a><span class="o">=</span><a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a><span class="p">,</span> <span class="n">fig_facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
                                            <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">title</span></a><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_014.png" />
</li>
<li><img alt="plot 20 visualize epochs" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_015.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 003&#39;, &#39;EEG 004&#39;, &#39;EEG 005&#39;, &#39;EEG 006&#39;, &#39;EEG 007&#39;, &#39;EEG 015&#39;, &#39;EEG 016&#39;, &#39;EEG 023&#39;, &#39;EEG 039&#39;, &#39;EEG 041&#39;, &#39;EEG 044&#39;, &#39;EEG 045&#39;, &#39;EEG 046&#39;, &#39;EEG 047&#39;, &#39;EEG 048&#39;, &#39;EEG 049&#39;, &#39;EEG 050&#39;, &#39;EEG 051&#39;, &#39;EEG 052&#39;, &#39;EEG 054&#39;, &#39;EEG 055&#39;, &#39;EEG 056&#39;, &#39;EEG 057&#39;, &#39;EEG 058&#39;, &#39;EEG 059&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 003&#39;, &#39;EEG 007&#39;, &#39;EEG 048&#39;, &#39;EEG 055&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 007&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 003&#39;, &#39;EEG 007&#39;]
    Rejecting  epoch based on MAG : [&#39;MEG 1711&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 003&#39;, &#39;EEG 007&#39;]
    Rejecting  epoch based on EEG : [&#39;EEG 001&#39;, &#39;EEG 002&#39;, &#39;EEG 007&#39;]
    Rejecting  epoch based on MAG : [&#39;MEG 1711&#39;]
8 bad epochs dropped
Removing projector &lt;Projection | ECG-planar-999--0.200-0.400-PCA-01, active : True, n_channels : 203&gt;
Removing projector &lt;Projection | ECG-planar-999--0.200-0.400-PCA-02, active : True, n_channels : 203&gt;
Removing projector &lt;Projection | ECG-eeg-999--0.200-0.400-PCA-01, active : True, n_channels : 59&gt;
Removing projector &lt;Projection | ECG-eeg-999--0.200-0.400-PCA-02, active : True, n_channels : 59&gt;
Removing projector &lt;Projection | PCA-v1, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | ECG-axial-999--0.200-0.400-PCA-01, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | ECG-axial-999--0.200-0.400-PCA-02, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | ECG-eeg-999--0.200-0.400-PCA-01, active : True, n_channels : 59&gt;
Removing projector &lt;Projection | ECG-eeg-999--0.200-0.400-PCA-02, active : True, n_channels : 59&gt;
</pre></div>
</div>
<p>To plot image maps for all EEG sensors, pass an EEG layout as the <code class="docutils literal notranslate"><span class="pre">layout</span></code>
parameter of <a class="reference internal" href="../../generated/mne.Epochs.html#mne.Epochs.plot_topo_image" title="mne.Epochs.plot_topo_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_topo_image</span></code></a>. Note also here the use of
the <code class="docutils literal notranslate"><span class="pre">sigma</span></code> parameter, which smooths each image map along the vertical
dimension (across epochs) which can make it easier to see patterns across the
small image maps (by smearing noisy epochs onto their neighbors, while
reinforcing parts of the image where adjacent epochs are similar). However,
<code class="docutils literal notranslate"><span class="pre">sigma</span></code> can also disguise epochs that have persistent extreme values and
maybe should have been excluded, so it should be used with caution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">find_layout</span><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ch_type</span></a><span class="o">=</span><span class="s1">&#39;eeg&#39;</span><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;auditory/left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_topo_image</span><span class="p">(</span><a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a><span class="o">=</span><a href="../../generated/mne.channels.Layout.html#mne.channels.Layout" title="mne.channels.Layout" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">layout</span></a><span class="p">,</span> <span class="n">fig_facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
                                        <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot 20 visualize epochs" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_20_visualize_epochs_016.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Removing projector &lt;Projection | PCA-v1, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | ECG-planar-999--0.200-0.400-PCA-01, active : True, n_channels : 203&gt;
Removing projector &lt;Projection | ECG-planar-999--0.200-0.400-PCA-02, active : True, n_channels : 203&gt;
Removing projector &lt;Projection | ECG-axial-999--0.200-0.400-PCA-01, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | ECG-axial-999--0.200-0.400-PCA-02, active : True, n_channels : 102&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  35.451 seconds)</p>
<p><strong>Estimated memory usage:</strong>  193 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-epochs-plot-20-visualize-epochs-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/441713e601854cb25d27eb903427043e/plot_20_visualize_epochs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_20_visualize_epochs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/bc5044f9d3ef1d29067dd6b7d83ceed2/plot_20_visualize_epochs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_20_visualize_epochs.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><div class="row">
    <div class="container col-md-12 institutions">
      <ul class="list-unstyled">
        <li><a href="https://www.massgeneral.org/"><img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a></li>
        <li><a href="https://martinos.org/"><img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a></li>
        <li><a href="https://hms.harvard.edu/"><img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a></li>
        <li><a href="https://web.mit.edu/"><img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a></li>
        <li><a href="https://www.nyu.edu/"><img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a></li>
        <li><a href="http://www.cea.fr/"><img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a></li>
        <li><a href="https://sci.aalto.fi/"><img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a></li>
        <li><a href="https://www.telecom-paris.fr/"><img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a></li>
        <li><a href="https://www.washington.edu/"><img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a></li>
        <li><a href="https://icm-institute.org/"><img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a></li>
        <li><a href="https://www.bu.edu/"><img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a></li>
        <li><a href="https://www.inserm.fr/"><img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a></li>
        <li><a href="https://www.fz-juelich.de/"><img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a></li>
        <li><a href="https://www.tu-ilmenau.de/"><img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a></li>
        <li><a href="https://bids.berkeley.edu/"><img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a></li>
        <li><a href="https://www.inria.fr/"><img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a></li>
        <li><a href="https://www.au.dk/"><img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a></li>
        <li><a href="https://www.uni-graz.at/"><img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a></li>
      </ul>
      <p class="text-center text-muted small">&copy; Copyright 2012-2020, MNE Developers. Last updated on 2020-03-27.</p>
    </div></div></div>
  </footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>