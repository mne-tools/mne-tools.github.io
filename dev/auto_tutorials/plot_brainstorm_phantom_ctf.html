<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Brainstorm CTF phantom tutorial dataset &#8212; MNE 0.14.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.14.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="row devbar alert alert-danger">
This documentation is for the <strong>development version (0.14.dev0)</strong> - <a href="http://martinos.org/mne/stable">switch to Stable</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.14.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Get started</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../manual/index.html">Manual</a></li>
                <li><a href="../contribute_to_mne.html">Contribute</a></li>
                <li><a href="../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Brainstorm CTF phantom tutorial dataset</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="brainstorm-ctf-phantom-tutorial-dataset">
<span id="sphx-glr-auto-tutorials-plot-brainstorm-phantom-ctf-py"></span><h1>Brainstorm CTF phantom tutorial dataset<a class="headerlink" href="#brainstorm-ctf-phantom-tutorial-dataset" title="Permalink to this headline">¶</a></h1>
<p>Here we compute the evoked from raw for the Brainstorm CTF phantom
tutorial dataset. For comparison, see <a class="footnote-reference" href="#id2" id="id1">[1]</a> and:</p>
<blockquote>
<div><a class="reference external" href="http://neuroimage.usc.edu/brainstorm/Tutorials/PhantomCtf">http://neuroimage.usc.edu/brainstorm/Tutorials/PhantomCtf</a></div></blockquote>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Tadel F, Baillet S, Mosher JC, Pantazis D, Leahy RM.
Brainstorm: A User-Friendly Application for MEG/EEG Analysis.
Computational Intelligence and Neuroscience, vol. 2011, Article ID
879716, 13 pages, 2011. doi:10.1155/2011/879716</td></tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Authors: Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">os.path</span> <span class="kn">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne</span> <span class="kn">import</span> <a href="../generated/mne.fit_dipole.html#mne.fit_dipole" title="View documentation for mne.fit_dipole"><span class="n">fit_dipole</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets.brainstorm</span> <span class="kn">import</span> <span class="n">bst_phantom_ctf</span>
<span class="kn">from</span> <span class="nn">mne.io</span> <span class="kn">import</span> <a href="../generated/mne.io.read_raw_ctf.html#mne.io.read_raw_ctf" title="View documentation for mne.io.read_raw_ctf"><span class="n">read_raw_ctf</span></a>

<span class="k">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p>The data were collected with a CTF system at 2400 Hz.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">bst_phantom_ctf</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>

<span class="c1"># Switch to these to use the higher-SNR data:</span>
<span class="c1"># raw_path = op.join(data_path, &#39;phantom_200uA_20150709_01.ds&#39;)</span>
<span class="c1"># dip_freq = 7.</span>
<span class="n">raw_path</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;phantom_20uA_20150603_03.ds&#39;</span><span class="p">)</span>
<span class="n">dip_freq</span> <span class="o">=</span> <span class="mf">23.</span>
<span class="n">erm_path</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;emptyroom_20150709_01.ds&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../generated/mne.io.read_raw_ctf.html#mne.io.read_raw_ctf" title="View documentation for mne.io.read_raw_ctf"><span class="n">read_raw_ctf</span></a><span class="p">(</span><span class="n">raw_path</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="n">directory</span> <span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mne_data</span><span class="o">/</span><span class="n">MNE</span><span class="o">-</span><span class="n">brainstorm</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">bst_phantom_ctf</span><span class="o">/</span><span class="n">phantom_20uA_20150603_03</span><span class="o">.</span><span class="n">ds</span>
    <span class="n">res4</span> <span class="n">data</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">hc</span> <span class="n">data</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">Separate</span> <span class="n">EEG</span> <span class="n">position</span> <span class="n">data</span> <span class="n">file</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">Quaternion</span> <span class="n">matching</span> <span class="p">(</span><span class="n">desired</span> <span class="n">vs</span><span class="o">.</span> <span class="n">transformed</span><span class="p">):</span>
      <span class="o">-</span><span class="mf">0.39</span>   <span class="mf">74.35</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>   <span class="o">-</span><span class="mf">0.39</span>   <span class="mf">74.35</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>  <span class="o">-</span><span class="mf">39.23</span>   <span class="mf">63.82</span> <span class="o">-</span><span class="mf">204.07</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
       <span class="mf">0.39</span>  <span class="o">-</span><span class="mf">74.35</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>    <span class="mf">0.39</span>  <span class="o">-</span><span class="mf">74.35</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>   <span class="mf">65.69</span>  <span class="o">-</span><span class="mf">41.53</span> <span class="o">-</span><span class="mf">205.68</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
      <span class="mf">75.00</span>    <span class="mf">0.00</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>   <span class="mf">75.00</span>   <span class="o">-</span><span class="mf">0.00</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>   <span class="mf">64.32</span>   <span class="mf">61.80</span> <span class="o">-</span><span class="mf">226.08</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
    <span class="n">Coordinate</span> <span class="n">transformations</span> <span class="n">established</span><span class="o">.</span>
    <span class="n">Polhemus</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">3</span> <span class="n">HPI</span> <span class="n">coils</span> <span class="n">added</span>
    <span class="n">Device</span> <span class="n">coordinate</span> <span class="n">locations</span> <span class="k">for</span> <span class="mi">3</span> <span class="n">HPI</span> <span class="n">coils</span> <span class="n">added</span>
    <span class="n">Measurement</span> <span class="n">info</span> <span class="n">composed</span><span class="o">.</span>
<span class="n">Finding</span> <span class="n">samples</span> <span class="k">for</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mne_data</span><span class="o">/</span><span class="n">MNE</span><span class="o">-</span><span class="n">brainstorm</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">bst_phantom_ctf</span><span class="o">/</span><span class="n">phantom_20uA_20150603_03</span><span class="o">.</span><span class="n">ds</span><span class="o">/</span><span class="n">phantom_20uA_20150603_03</span><span class="o">.</span><span class="n">meg4</span><span class="p">:</span>
    <span class="n">System</span> <span class="n">clock</span> <span class="n">channel</span> <span class="ow">is</span> <span class="n">available</span><span class="p">,</span> <span class="n">checking</span> <span class="n">which</span> <span class="n">samples</span> <span class="n">are</span> <span class="n">valid</span><span class="o">.</span>
    <span class="mi">10</span> <span class="n">x</span> <span class="mi">2400</span> <span class="o">=</span> <span class="mi">24000</span> <span class="n">samples</span> <span class="kn">from</span> <span class="mi">304</span> <span class="n">chs</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">3</span>
<span class="n">Reading</span> <span class="mi">0</span> <span class="o">...</span> <span class="mi">23999</span>  <span class="o">=</span>      <span class="mf">0.000</span> <span class="o">...</span>    <span class="mf">10.000</span> <span class="n">secs</span><span class="o">...</span>
</pre></div>
</div>
<p>The sinusoidal signal is generated on channel HDAC006, so we can use
that to obtain precise timing.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sinusoid</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;HDAC006-4408&#39;</span><span class="p">)]</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="View documentation for matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">times</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">sinusoid</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">times</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_brainstorm_phantom_ctf_001.png" class="align-center" src="../_images/sphx_glr_plot_brainstorm_phantom_ctf_001.png" />
<p>Let&#8217;s create some events using this signal by thresholding the sinusoid.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sinusoid</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">raw</span><span class="o">.</span><span class="n">first_samp</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">events</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">events</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>The CTF software compensation works reasonably well:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_brainstorm_phantom_ctf_002.png" class="align-center" src="../_images/sphx_glr_plot_brainstorm_phantom_ctf_002.png" />
<p>But here we can get slightly better noise suppression, lower localization
bias, and a better dipole goodness of fit with spatio-temporal (tSSS)
Maxwell filtering:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">apply_gradient_compensation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># must un-do software compensation first</span>
<span class="n">mf_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">st_duration</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">maxwell_filter</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="o">**</span><span class="n">mf_kwargs</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_brainstorm_phantom_ctf_003.png" class="align-center" src="../_images/sphx_glr_plot_brainstorm_phantom_ctf_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">Compensator</span> <span class="n">constructed</span> <span class="n">to</span> <span class="n">change</span> <span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">0</span>
<span class="n">Applying</span> <span class="n">compensator</span> <span class="n">to</span> <span class="n">loaded</span> <span class="n">data</span>
<span class="n">Maxwell</span> <span class="n">filtering</span> <span class="n">raw</span> <span class="n">data</span>
    <span class="n">Using</span> <span class="n">loaded</span> <span class="n">raw</span> <span class="n">data</span>
    <span class="n">No</span> <span class="n">bad</span> <span class="n">MEG</span> <span class="n">channels</span>
    <span class="n">Processing</span> <span class="mi">0</span> <span class="n">gradiometers</span> <span class="ow">and</span> <span class="mi">299</span> <span class="n">magnetometers</span>
    <span class="n">Using</span> <span class="n">origin</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">head</span> <span class="n">frame</span>
    <span class="n">Processing</span> <span class="n">data</span> <span class="n">using</span> <span class="n">tSSS</span> <span class="k">with</span> <span class="n">st_duration</span><span class="o">=</span><span class="mf">10.0</span>
    <span class="n">Computing</span> <span class="n">regularization</span>
        <span class="n">Using</span> <span class="mi">86</span><span class="o">/</span><span class="mi">95</span> <span class="n">harmonic</span> <span class="n">components</span> <span class="k">for</span>    <span class="mf">0.000</span>  <span class="p">(</span><span class="mi">71</span><span class="o">/</span><span class="mi">80</span> <span class="ow">in</span><span class="p">,</span> <span class="mi">15</span><span class="o">/</span><span class="mi">15</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">Processing</span> <span class="mi">1</span> <span class="n">data</span> <span class="n">chunks</span> <span class="n">of</span> <span class="p">(</span><span class="n">at</span> <span class="n">least</span><span class="p">)</span> <span class="mf">10.0</span> <span class="n">sec</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>    <span class="mf">0.000</span> <span class="o">-</span>   <span class="mf">10.000</span> <span class="n">sec</span> <span class="p">(</span><span class="c1">#1/1)</span>
<span class="p">[</span><span class="n">done</span><span class="p">]</span>
</pre></div>
</div>
<p>Our choice of tmin and tmax should capture exactly one cycle, so
we can make the unusual choice of baselining using the entire epoch
when creating our evoked data. We also then crop to a single time point
(&#64;t=0) because this is a peak in our signal.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dip_freq</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="o">-</span><span class="n">tmin</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../generated/mne.Epochs.html#mne.Epochs" title="View documentation for mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
<span class="n">evoked</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">evoked</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="k">del</span> <span class="n">raw</span><span class="p">,</span> <span class="n">epochs</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_brainstorm_phantom_ctf_004.png" class="align-center" src="../_images/sphx_glr_plot_brainstorm_phantom_ctf_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="mi">460</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="mi">0</span> <span class="n">projection</span> <span class="n">items</span> <span class="n">activated</span>
</pre></div>
</div>
<p>To do a dipole fit, let&#8217;s use the covariance provided by the empty room
recording.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw_erm</span> <span class="o">=</span> <a href="../generated/mne.io.read_raw_ctf.html#mne.io.read_raw_ctf" title="View documentation for mne.io.read_raw_ctf"><span class="n">read_raw_ctf</span></a><span class="p">(</span><span class="n">erm_path</span><span class="p">)</span><span class="o">.</span><span class="n">apply_gradient_compensation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">raw_erm</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">maxwell_filter</span><span class="p">(</span><span class="n">raw_erm</span><span class="p">,</span> <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;meg&#39;</span><span class="p">,</span>
                                           <span class="o">**</span><span class="n">mf_kwargs</span><span class="p">)</span>
<span class="n">cov</span> <span class="o">=</span> <a href="../generated/mne.compute_raw_covariance.html#mne.compute_raw_covariance" title="View documentation for mne.compute_raw_covariance"><span class="n">mne</span><span class="o">.</span><span class="n">compute_raw_covariance</span></a><span class="p">(</span><span class="n">raw_erm</span><span class="p">)</span>
<span class="k">del</span> <span class="n">raw_erm</span>
<span class="n">sphere</span> <span class="o">=</span> <a href="../generated/mne.make_sphere_model.html#mne.make_sphere_model" title="View documentation for mne.make_sphere_model"><span class="n">mne</span><span class="o">.</span><span class="n">make_sphere_model</span></a><span class="p">(</span><span class="n">r0</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">head_radius</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">dip</span> <span class="o">=</span> <a href="../generated/mne.fit_dipole.html#mne.fit_dipole" title="View documentation for mne.fit_dipole"><span class="n">fit_dipole</span></a><span class="p">(</span><span class="n">evoked</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">sphere</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="n">directory</span> <span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mne_data</span><span class="o">/</span><span class="n">MNE</span><span class="o">-</span><span class="n">brainstorm</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">bst_phantom_ctf</span><span class="o">/</span><span class="n">emptyroom_20150709_01</span><span class="o">.</span><span class="n">ds</span>
    <span class="n">res4</span> <span class="n">data</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">hc</span> <span class="n">data</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">Separate</span> <span class="n">EEG</span> <span class="n">position</span> <span class="n">data</span> <span class="n">file</span> <span class="n">read</span><span class="o">.</span>
    <span class="n">Quaternion</span> <span class="n">matching</span> <span class="p">(</span><span class="n">desired</span> <span class="n">vs</span><span class="o">.</span> <span class="n">transformed</span><span class="p">):</span>
      <span class="o">-</span><span class="mf">0.00</span>   <span class="mf">74.50</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>   <span class="o">-</span><span class="mf">0.00</span>   <span class="mf">74.50</span>   <span class="o">-</span><span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>  <span class="o">-</span><span class="mf">50.17</span>   <span class="mf">57.61</span> <span class="o">-</span><span class="mf">188.51</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
       <span class="mf">0.00</span>  <span class="o">-</span><span class="mf">74.50</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>    <span class="mf">0.00</span>  <span class="o">-</span><span class="mf">74.50</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>   <span class="mf">60.49</span>  <span class="o">-</span><span class="mf">42.15</span> <span class="o">-</span><span class="mf">190.81</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
      <span class="mf">74.66</span>    <span class="mf">0.00</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="o">&lt;-&gt;</span>   <span class="mf">74.66</span>   <span class="o">-</span><span class="mf">0.00</span>    <span class="mf">0.00</span> <span class="n">mm</span> <span class="p">(</span><span class="n">orig</span> <span class="p">:</span>   <span class="mf">53.03</span>   <span class="mf">61.29</span> <span class="o">-</span><span class="mf">209.99</span> <span class="n">mm</span><span class="p">)</span> <span class="n">diff</span> <span class="o">=</span>    <span class="mf">0.000</span> <span class="n">mm</span>
    <span class="n">Coordinate</span> <span class="n">transformations</span> <span class="n">established</span><span class="o">.</span>
    <span class="n">Polhemus</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">3</span> <span class="n">HPI</span> <span class="n">coils</span> <span class="n">added</span>
    <span class="n">Device</span> <span class="n">coordinate</span> <span class="n">locations</span> <span class="k">for</span> <span class="mi">3</span> <span class="n">HPI</span> <span class="n">coils</span> <span class="n">added</span>
    <span class="n">Measurement</span> <span class="n">info</span> <span class="n">composed</span><span class="o">.</span>
<span class="n">Finding</span> <span class="n">samples</span> <span class="k">for</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">mne_data</span><span class="o">/</span><span class="n">MNE</span><span class="o">-</span><span class="n">brainstorm</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">bst_phantom_ctf</span><span class="o">/</span><span class="n">emptyroom_20150709_01</span><span class="o">.</span><span class="n">ds</span><span class="o">/</span><span class="n">emptyroom_20150709_01</span><span class="o">.</span><span class="n">meg4</span><span class="p">:</span>
    <span class="n">System</span> <span class="n">clock</span> <span class="n">channel</span> <span class="ow">is</span> <span class="n">available</span><span class="p">,</span> <span class="n">checking</span> <span class="n">which</span> <span class="n">samples</span> <span class="n">are</span> <span class="n">valid</span><span class="o">.</span>
    <span class="mi">100</span> <span class="n">x</span> <span class="mi">600</span> <span class="o">=</span> <span class="mi">60000</span> <span class="n">samples</span> <span class="kn">from</span> <span class="mi">304</span> <span class="n">chs</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">3</span>
<span class="n">Compensator</span> <span class="n">constructed</span> <span class="n">to</span> <span class="n">change</span> <span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">0</span>
<span class="n">Maxwell</span> <span class="n">filtering</span> <span class="n">raw</span> <span class="n">data</span>
    <span class="n">Loading</span> <span class="n">raw</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">disk</span>
    <span class="n">No</span> <span class="n">bad</span> <span class="n">MEG</span> <span class="n">channels</span>
    <span class="n">Processing</span> <span class="mi">0</span> <span class="n">gradiometers</span> <span class="ow">and</span> <span class="mi">299</span> <span class="n">magnetometers</span>
    <span class="n">Using</span> <span class="n">origin</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">meg</span> <span class="n">frame</span>
    <span class="n">Processing</span> <span class="n">data</span> <span class="n">using</span> <span class="n">tSSS</span> <span class="k">with</span> <span class="n">st_duration</span><span class="o">=</span><span class="mf">10.0</span>
    <span class="n">Computing</span> <span class="n">regularization</span>
        <span class="n">Using</span> <span class="mi">93</span><span class="o">/</span><span class="mi">95</span> <span class="n">harmonic</span> <span class="n">components</span> <span class="k">for</span>    <span class="mf">0.000</span>  <span class="p">(</span><span class="mi">78</span><span class="o">/</span><span class="mi">80</span> <span class="ow">in</span><span class="p">,</span> <span class="mi">15</span><span class="o">/</span><span class="mi">15</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">Processing</span> <span class="mi">10</span> <span class="n">data</span> <span class="n">chunks</span> <span class="n">of</span> <span class="p">(</span><span class="n">at</span> <span class="n">least</span><span class="p">)</span> <span class="mf">10.0</span> <span class="n">sec</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>    <span class="mf">0.000</span> <span class="o">-</span>    <span class="mf">9.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#1/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">10.000</span> <span class="o">-</span>   <span class="mf">19.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#2/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">20.000</span> <span class="o">-</span>   <span class="mf">29.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#3/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">30.000</span> <span class="o">-</span>   <span class="mf">39.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#4/10)</span>
        <span class="n">Projecting</span>  <span class="mi">9</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">40.000</span> <span class="o">-</span>   <span class="mf">49.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#5/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">50.000</span> <span class="o">-</span>   <span class="mf">59.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#6/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">60.000</span> <span class="o">-</span>   <span class="mf">69.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#7/10)</span>
        <span class="n">Projecting</span>  <span class="mi">9</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">70.000</span> <span class="o">-</span>   <span class="mf">79.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#8/10)</span>
        <span class="n">Projecting</span>  <span class="mi">9</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">80.000</span> <span class="o">-</span>   <span class="mf">89.998</span> <span class="n">sec</span>  <span class="p">(</span><span class="c1">#9/10)</span>
        <span class="n">Projecting</span>  <span class="mi">8</span> <span class="n">intersecting</span> <span class="n">tSSS</span> <span class="n">components</span> <span class="k">for</span>   <span class="mf">90.000</span> <span class="o">-</span>   <span class="mf">99.998</span> <span class="n">sec</span> <span class="p">(</span><span class="c1">#10/10)</span>
<span class="p">[</span><span class="n">done</span><span class="p">]</span>
<span class="n">Using</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">499</span> <span class="n">segments</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">samples</span> <span class="n">used</span> <span class="p">:</span> <span class="mi">59880</span>
<span class="p">[</span><span class="n">done</span><span class="p">]</span>
<span class="n">BEM</span>               <span class="p">:</span> <span class="o">&lt;</span><span class="n">ConductorModel</span>  <span class="o">|</span>  <span class="n">Sphere</span> <span class="p">(</span><span class="n">no</span> <span class="n">layers</span><span class="p">):</span> <span class="n">r0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="n">mm</span><span class="o">&gt;</span>
<span class="n">Sphere</span> <span class="n">model</span>      <span class="p">:</span> <span class="n">origin</span> <span class="n">at</span> <span class="p">(</span>   <span class="mf">0.00</span>    <span class="mf">0.00</span>    <span class="mf">0.00</span><span class="p">)</span> <span class="n">mm</span><span class="p">,</span> <span class="n">max_rad</span> <span class="o">=</span>    <span class="mf">0.1</span> <span class="n">mm</span>
<span class="n">Guess</span> <span class="n">grid</span>        <span class="p">:</span>   <span class="mf">20.0</span> <span class="n">mm</span>
<span class="n">Guess</span> <span class="n">mindist</span>     <span class="p">:</span>    <span class="mf">5.0</span> <span class="n">mm</span>
<span class="n">Guess</span> <span class="n">exclude</span>     <span class="p">:</span>   <span class="mf">20.0</span> <span class="n">mm</span>
<span class="n">Using</span> <span class="n">standard</span> <span class="n">MEG</span> <span class="n">coil</span> <span class="n">definitions</span><span class="o">.</span>

<span class="n">Coordinate</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">head</span> <span class="o">-&gt;</span> <span class="n">MRI</span> <span class="p">(</span><span class="n">surface</span> <span class="n">RAS</span><span class="p">)</span>
     <span class="mf">1.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>       <span class="mf">0.00</span> <span class="n">mm</span>
     <span class="mf">0.000000</span>  <span class="mf">1.000000</span>  <span class="mf">0.000000</span>       <span class="mf">0.00</span> <span class="n">mm</span>
     <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">1.000000</span>       <span class="mf">0.00</span> <span class="n">mm</span>
     <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>       <span class="mf">1.00</span>
<span class="n">Coordinate</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">MEG</span> <span class="n">device</span> <span class="o">-&gt;</span> <span class="n">head</span>
     <span class="mf">0.999939</span> <span class="o">-</span><span class="mf">0.002039</span> <span class="o">-</span><span class="mf">0.010868</span>      <span class="o">-</span><span class="mf">2.00</span> <span class="n">mm</span>
    <span class="o">-</span><span class="mf">0.001115</span>  <span class="mf">0.959234</span> <span class="o">-</span><span class="mf">0.282612</span>     <span class="o">-</span><span class="mf">20.74</span> <span class="n">mm</span>
     <span class="mf">0.011001</span>  <span class="mf">0.282607</span>  <span class="mf">0.959173</span>       <span class="mf">9.38</span> <span class="n">mm</span>
     <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>       <span class="mf">1.00</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">channels</span> <span class="n">total</span>
<span class="n">Read</span> <span class="mi">273</span> <span class="n">MEG</span> <span class="n">channels</span> <span class="kn">from</span> <span class="nn">info</span>
<span class="n">Read</span>  <span class="mi">26</span> <span class="n">MEG</span> <span class="n">compensation</span> <span class="n">channels</span> <span class="kn">from</span> <span class="nn">info</span>
<span class="mi">81</span> <span class="n">coil</span> <span class="n">definitions</span> <span class="n">read</span>
<span class="n">Coordinate</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">MEG</span> <span class="n">device</span> <span class="o">-&gt;</span> <span class="n">head</span>
     <span class="mf">0.999939</span> <span class="o">-</span><span class="mf">0.002039</span> <span class="o">-</span><span class="mf">0.010868</span>      <span class="o">-</span><span class="mf">2.00</span> <span class="n">mm</span>
    <span class="o">-</span><span class="mf">0.001115</span>  <span class="mf">0.959234</span> <span class="o">-</span><span class="mf">0.282612</span>     <span class="o">-</span><span class="mf">20.74</span> <span class="n">mm</span>
     <span class="mf">0.011001</span>  <span class="mf">0.282607</span>  <span class="mf">0.959173</span>       <span class="mf">9.38</span> <span class="n">mm</span>
     <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span>       <span class="mf">1.00</span>
<span class="mi">5</span> <span class="n">compensation</span> <span class="n">data</span> <span class="n">sets</span> <span class="ow">in</span> <span class="n">info</span>
<span class="n">MEG</span> <span class="n">coil</span> <span class="n">definitions</span> <span class="n">created</span> <span class="ow">in</span> <span class="n">head</span> <span class="n">coordinates</span><span class="o">.</span>
<span class="n">Decomposing</span> <span class="n">the</span> <span class="n">sensor</span> <span class="n">noise</span> <span class="n">covariance</span> <span class="n">matrix</span><span class="o">...</span>

<span class="o">----</span> <span class="n">Computing</span> <span class="n">the</span> <span class="n">forward</span> <span class="n">solution</span> <span class="k">for</span> <span class="n">the</span> <span class="n">guesses</span><span class="o">...</span>
<span class="n">Making</span> <span class="n">a</span> <span class="n">spherical</span> <span class="n">guess</span> <span class="n">space</span> <span class="k">with</span> <span class="n">radius</span>    <span class="mf">98.6</span> <span class="n">mm</span><span class="o">...</span>
<span class="n">Filtering</span> <span class="p">(</span><span class="n">grid</span> <span class="o">=</span>     <span class="mi">20</span> <span class="n">mm</span><span class="p">)</span><span class="o">...</span>
<span class="n">Surface</span> <span class="n">CM</span> <span class="o">=</span> <span class="p">(</span>   <span class="mf">0.0</span>   <span class="o">-</span><span class="mf">0.0</span>    <span class="mf">0.0</span><span class="p">)</span> <span class="n">mm</span>
<span class="n">Surface</span> <span class="n">fits</span> <span class="n">inside</span> <span class="n">a</span> <span class="n">sphere</span> <span class="k">with</span> <span class="n">radius</span>   <span class="mf">98.6</span> <span class="n">mm</span>
<span class="n">Surface</span> <span class="n">extent</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">98.6</span> <span class="o">...</span>   <span class="mf">98.6</span> <span class="n">mm</span>
    <span class="n">y</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">98.6</span> <span class="o">...</span>   <span class="mf">98.6</span> <span class="n">mm</span>
    <span class="n">z</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">98.6</span> <span class="o">...</span>   <span class="mf">98.6</span> <span class="n">mm</span>
<span class="n">Grid</span> <span class="n">extent</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.0</span> <span class="o">...</span>  <span class="mf">100.0</span> <span class="n">mm</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.0</span> <span class="o">...</span>  <span class="mf">100.0</span> <span class="n">mm</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100.0</span> <span class="o">...</span>  <span class="mf">100.0</span> <span class="n">mm</span>
<span class="mi">1331</span> <span class="n">sources</span> <span class="n">before</span> <span class="n">omitting</span> <span class="nb">any</span><span class="o">.</span>
<span class="mi">481</span> <span class="n">sources</span> <span class="n">after</span> <span class="n">omitting</span> <span class="n">infeasible</span> <span class="n">sources</span><span class="o">.</span>
<span class="n">Source</span> <span class="n">spaces</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">MRI</span> <span class="n">coordinates</span><span class="o">.</span>
<span class="n">Checking</span> <span class="n">that</span> <span class="n">the</span> <span class="n">sources</span> <span class="n">are</span> <span class="n">inside</span> <span class="n">the</span> <span class="n">bounding</span> <span class="n">surface</span> <span class="ow">and</span> <span class="n">at</span> <span class="n">least</span>    <span class="mf">5.0</span> <span class="n">mm</span> <span class="n">away</span> <span class="p">(</span><span class="n">will</span> <span class="n">take</span> <span class="n">a</span> <span class="n">few</span><span class="o">...</span><span class="p">)</span>
<span class="mi">4</span> <span class="n">source</span> <span class="n">space</span> <span class="n">point</span> <span class="n">omitted</span> <span class="n">because</span> <span class="n">of</span> <span class="n">the</span>    <span class="mf">5.0</span><span class="o">-</span><span class="n">mm</span> <span class="n">distance</span> <span class="n">limit</span><span class="o">.</span>
<span class="n">Thank</span> <span class="n">you</span> <span class="k">for</span> <span class="n">waiting</span><span class="o">.</span>
<span class="mi">477</span> <span class="n">sources</span> <span class="n">remaining</span> <span class="n">after</span> <span class="n">excluding</span> <span class="n">the</span> <span class="n">sources</span> <span class="n">outside</span> <span class="n">the</span> <span class="n">surface</span> <span class="ow">and</span> <span class="n">less</span> <span class="n">than</span>    <span class="mf">5.0</span> <span class="n">mm</span> <span class="n">inside</span><span class="o">.</span>
<span class="n">Go</span> <span class="n">through</span> <span class="nb">all</span> <span class="n">guess</span> <span class="n">source</span> <span class="n">locations</span><span class="o">...</span>
<span class="p">[</span><span class="n">done</span> <span class="mi">477</span> <span class="n">sources</span><span class="p">]</span>
<span class="o">----</span> <span class="n">Fitted</span> <span class="p">:</span>     <span class="mf">0.0</span> <span class="n">ms</span>
<span class="mi">1</span> <span class="n">time</span> <span class="n">points</span> <span class="n">fitted</span>
</pre></div>
</div>
<p>Compare the actual position with the estimated one.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">expected_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">18.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">49.</span><span class="p">])</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">dip</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">-</span> <span class="n">expected_pos</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Actual pos:     </span><span class="si">%s</span><span class="s1"> mm&#39;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">expected_pos</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Estimated pos:  </span><span class="si">%s</span><span class="s1"> mm&#39;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="n">dip</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Difference:     </span><span class="si">%0.1f</span><span class="s1"> mm&#39;</span> <span class="o">%</span> <span class="n">diff</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Amplitude:      </span><span class="si">%0.1f</span><span class="s1"> nAm&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">1e9</span> <span class="o">*</span> <span class="n">dip</span><span class="o">.</span><span class="n">amplitude</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;GOF:            </span><span class="si">%0.1f</span><span class="s1"> </span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dip</span><span class="o">.</span><span class="n">gof</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">Actual</span> <span class="n">pos</span><span class="p">:</span>     <span class="p">[</span> <span class="mf">18.</span>   <span class="mf">0.</span>  <span class="mf">49.</span><span class="p">]</span> <span class="n">mm</span>
<span class="n">Estimated</span> <span class="n">pos</span><span class="p">:</span>  <span class="p">[</span> <span class="mf">18.4</span>  <span class="o">-</span><span class="mf">2.1</span>  <span class="mf">44.8</span><span class="p">]</span> <span class="n">mm</span>
<span class="n">Difference</span><span class="p">:</span>     <span class="mf">4.7</span> <span class="n">mm</span>
<span class="n">Amplitude</span><span class="p">:</span>      <span class="mf">10.0</span> <span class="n">nAm</span>
<span class="n">GOF</span><span class="p">:</span>            <span class="mf">96.0</span> <span class="o">%</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  23.653 seconds)</p>
<div class="sphx-glr-footer container">
<div class="sphx-glr-download container">
<a class="reference download internal" href="../_downloads/plot_brainstorm_phantom_ctf.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_brainstorm_phantom_ctf.py</span></code></a></div>
<div class="sphx-glr-download container">
<a class="reference download internal" href="../_downloads/plot_brainstorm_phantom_ctf.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_brainstorm_phantom_ctf.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="http://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2017, MNE Developers. Last updated on 2017-02-24.<br/>
    </p>
  </div>
</footer>
  </body>
</html>