<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Epoching and averaging (ERP/ERF) &mdash; MNE 0.12.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="MNE 0.12.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials.html" />
    <link rel="next" title="EEG processing and Event Related Potentials (ERPs)" href="plot_eeg_erp.html" />
    <link rel="prev" title="Artifact correction with Maxwell filter" href="plot_artifacts_correction_maxwell_filtering.html" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body role="document">

<div class="devbar">
This documentation is for the development version (0.12.0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/mne_logo_small.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.12.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../getting_started.html">Get started</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Gallery</a></li>
                <li><a href="../python_reference.html">API</a></li>
                <li><a href="../manual/index.html">Manual</a></li>
                <li><a href="../faq.html">FAQ</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contribute to MNE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python_reference.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What&#8217;s new</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite MNE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Related publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cited.html">Publications from MNE users</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Epoching and averaging (ERP/ERF)</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Epoching and averaging (ERP/ERF)</a></li>
</ul>

  <li>
    <a href="plot_artifacts_correction_maxwell_filtering.html" title="Previous Chapter: Artifact correction with Maxwell filter"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Artifact corr...</span>
    </a>
  </li>
  <li>
    <a href="plot_eeg_erp.html" title="Next Chapter: EEG processing and Event Related Potentials (ERPs)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">EEG processin... &raquo;</span>
    </a>
  </li>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="epoching-and-averaging-erp-erf">
<span id="tut-epoching-and-averaging"></span><span id="sphx-glr-auto-tutorials-plot-epoching-and-averaging-py"></span><h1>Epoching and averaging (ERP/ERF)<a class="headerlink" href="#epoching-and-averaging-erp-erf" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span> <span class="kn">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">mne</span>
</pre></div>
</div>
<p>In MNE, <cite>epochs</cite> refers to a collection of <cite>single trials</cite> or short segments
of time locked raw data. If you haven&#8217;t already, you might want to check out
<a class="reference internal" href="plot_object_epochs.html#tut-epochs-objects"><span>The Epochs data structure: epoched data</span></a>. In this tutorial we take a deeper look into
construction of epochs and averaging the epoch data to evoked instances.
First let&#8217;s read in the raw sample data.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span><span class="p">()</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <a href="../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Opening raw data file /home/ubuntu/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
Current compensation grade : 0
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Adding average EEG reference projection.
1 projection items deactivated
</pre></div>
</div>
<p>To create time locked epochs, we first need a set of events that contain the
information about the times. In this tutorial we use the stimulus channel to
define the events. Let&#8217;s look at the raw data.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.10.1/reference/generated/numpy.arange.html#numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;nchan&#39;</span><span class="p">])</span>
<span class="n">order</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">312</span>  <span class="c1"># We exchange the plotting order of two channels</span>
<span class="n">order</span><span class="p">[</span><span class="mi">312</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>  <span class="c1"># to show the trigger channel as the 10th channel.</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_epoching_and_averaging_001.png" class="align-center" src="../_images/sphx_glr_plot_epoching_and_averaging_001.png" />
<p>Notice channel <code class="docutils literal"><span class="pre">STI</span> <span class="pre">014</span></code> at the bottom. It is the trigger channel that
was used for combining all the events to a single channel. We can see that it
has several pulses of different amplitude throughout the recording. These
pulses correspond to different stimuli presented to the subject during the
acquisition. The pulses have values of 1, 2, 3, 4, 5 and 32. These are the
events we are going to align the epochs to. To create an event list from raw
data, we simply call a function dedicated just for that. Since the event list
is simply a numpy array, you can also manually create one. If you create one
from an outside source (like a separate file of events), pay special
attention in aligning the events correctly with the raw data.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <a href="../generated/mne.find_events.html#mne.find_events"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

<span class="c1"># Plot the events to get an idea of the paradigm</span>
<span class="c1"># Specify colors and an event_id dictionary for the legend.</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Auditory/Left&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Auditory/Right&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;Visual/Left&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Visual/Right&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;smiley&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;button&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>
<span class="n">color</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">}</span>

<a href="../generated/mne.viz.plot_events.html#mne.viz.plot_events"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span></a><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">],</span> <span class="n">raw</span><span class="o">.</span><span class="n">first_samp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_epoching_and_averaging_002.png" class="align-center" src="../_images/sphx_glr_plot_epoching_and_averaging_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>320 events found
Events id: [ 1  2  3  4  5 32]
[[ 27977      0      2]
 [ 28345      0      3]
 [ 28771      0      1]
 [ 29219      0      4]
 [ 29652      0      2]
 [ 30025      0      3]
 [ 30450      0      1]
 [ 30839      0      4]
 [ 31240      0      2]
 [ 31665      0      3]
 [ 32101      0      1]
 [ 32519      0      4]
 [ 32935      0      2]
 [ 33325      0      3]
 [ 33712      0      1]
 [ 34089      0      5]
 [ 34532      0      2]
 [ 34649      0     32]
 [ 34956      0      3]
 [ 35428      0      1]
 [ 35850      0      4]
 [ 36211      0      2]
 [ 36576      0      3]
 [ 37007      0      1]
 [ 37460      0      4]
 [ 37910      0      2]
 [ 38326      0      3]
 [ 38711      0      1]
 [ 39130      0      4]
 [ 39563      0      2]
 [ 39926      0      3]
 [ 40405      0      1]
 [ 40880      0      4]
 [ 41260      0      2]
 [ 41646      0      3]
 [ 42126      0      1]
 [ 42598      0      5]
 [ 42938      0     32]
 [ 42960      0      2]
 [ 43346      0      3]
 [ 43781      0      1]
 [ 44170      0      4]
 [ 44649      0      2]
 [ 45115      0      3]
 [ 45486      0      1]
 [ 45860      0      4]
 [ 46240      0      2]
 [ 46686      0      3]
 [ 47095      0      1]
 [ 47530      0      4]
 [ 47895      0      2]
 [ 48287      0      3]
 [ 48722      0      1]
 [ 49101      0      4]
 [ 49469      0      2]
 [ 49897      0      3]
 [ 50269      0      1]
 [ 50682      0      4]
 [ 51046      0      2]
 [ 51437      0      5]
 [ 51803      0     32]
 [ 51881      0      1]
 [ 52252      0      4]
 [ 52675      0      2]
 [ 53118      0      3]
 [ 53494      0      1]
 [ 53912      0      4]
 [ 54320      0      2]
 [ 54699      0      3]
 [ 55100      0      1]
 [ 55463      0      4]
 [ 55878      0      2]
 [ 56269      0      3]
 [ 56717      0      1]
 [ 57183      0      4]
 [ 57612      0      2]
 [ 58079      0      3]
 [ 58448      0      1]
 [ 58913      0      4]
 [ 59320      0      5]
 [ 59677      0     32]
 [ 59739      0      3]
 [ 60129      0      1]
 [ 60563      0      4]
 [ 61035      0      2]
 [ 61458      0      3]
 [ 61868      0      1]
 [ 62283      0      4]
 [ 62682      0      2]
 [ 63069      0      3]
 [ 63532      0      1]
 [ 63923      0      4]
 [ 64387      0      2]
 [ 64769      0      3]
 [ 65181      0      1]
 [ 65643      0      4]
 [ 66071      0      2]
 [ 66538      0      3]
 [ 66964      0      1]
 [ 67401      0      5]
 [ 67782      0     32]
 [ 67811      0      2]
 [ 68198      0      3]
 [ 68666      0      1]
 [ 69063      0      4]
 [ 69458      0      2]
 [ 69859      0      3]
 [ 70259      0      1]
 [ 70663      0      4]
 [ 71128      0      2]
 [ 71608      0      3]
 [ 71991      0      1]
 [ 72442      0      4]
 [ 72824      0      2]
 [ 73258      0      3]
 [ 73718      0      1]
 [ 74172      0      4]
 [ 74540      0      2]
 [ 74919      0      3]
 [ 75305      0      5]
 [ 75624      0     32]
 [ 75724      0      4]
 [ 76086      0      2]
 [ 76479      0      3]
 [ 76894      0      1]
 [ 77304      0      4]
 [ 77682      0      2]
 [ 78130      0      3]
 [ 78539      0      1]
 [ 78934      0      4]
 [ 79361      0      2]
 [ 79819      0      3]
 [ 80209      0      1]
 [ 80624      0      4]
 [ 81017      0      2]
 [ 81440      0      3]
 [ 81911      0      1]
 [ 82334      0      4]
 [ 82715      0      2]
 [ 83150      0      3]
 [ 83568      0      1]
 [ 83984      0      4]
 [ 84446      0      2]
 [ 84898      0      5]
 [ 85111      0     32]
 [ 85299      0      1]
 [ 85664      0      4]
 [ 86107      0      2]
 [ 86520      0      3]
 [ 86971      0      1]
 [ 87354      0      4]
 [ 87724      0      2]
 [ 88150      0      3]
 [ 88593      0      1]
 [ 89024      0      4]
 [ 89496      0      2]
 [ 89949      0      3]
 [ 90419      0      1]
 [ 90813      0      4]
 [ 91194      0      2]
 [ 91600      0      3]
 [ 92038      0      1]
 [ 92414      0      4]
 [ 92801      0      5]
 [ 93018      0     32]
 [ 93270      0      3]
 [ 93669      0      1]
 [ 94094      0      4]
 [ 94541      0      2]
 [ 94960      0      3]
 [ 95435      0      1]
 [ 95883      0      4]
 [ 96329      0      2]
 [ 96789      0      3]
 [ 97234      0      1]
 [ 97703      0      4]
 [ 98113      0      2]
 [ 98499      0      3]
 [ 98903      0      1]
 [ 99363      0      4]
 [ 99795      0      2]
 [100159      0      3]
 [100620      0      1]
 [101091      0      5]
 [101468      0      2]
 [101540      0     32]
 [101908      0      3]
 [102288      0      1]
 [102713      0      4]
 [103192      0      2]
 [103588      0      3]
 [104033      0      1]
 [104433      0      4]
 [104909      0      2]
 [105348      0      3]
 [105760      0      1]
 [106172      0      4]
 [106620      0      2]
 [106988      0      3]
 [107355      0      1]
 [107743      0      4]
 [108170      0      2]
 [108619      0      3]
 [108975      0      5]
 [109324      0     32]
 [109364      0      4]
 [109741      0      2]
 [110209      0      3]
 [110574      0      1]
 [111004      0      4]
 [111440      0      2]
 [111839      0      3]
 [112292      0      1]
 [112743      0      4]
 [113140      0      2]
 [113589      0      3]
 [113952      0      1]
 [114324      0      4]
 [114740      0      2]
 [115160      0      3]
 [115619      0      1]
 [116083      0      4]
 [116527      0      2]
 [116929      0      3]
 [117304      0      1]
 [117714      0      4]
 [118101      0      5]
 [118369      0     32]
 [118480      0      3]
 [118879      0      1]
 [119235      0      4]
 [119696      0      2]
 [120110      0      3]
 [120539      0      1]
 [120984      0      4]
 [121392      0      2]
 [121800      0      3]
 [122218      0      1]
 [122684      0      4]
 [123065      0      2]
 [123451      0      3]
 [123931      0      1]
 [124404      0      4]
 [124830      0      2]
 [125300      0      3]
 [125709      0      1]
 [126123      0      5]
 [126470      0     32]
 [126546      0      2]
 [126950      0      3]
 [127331      0      1]
 [127705      0      4]
 [128075      0      2]
 [128511      0      3]
 [128925      0      1]
 [129285      0      4]
 [129732      0      2]
 [130111      0      3]
 [130495      0      1]
 [130876      0      4]
 [131253      0      2]
 [131672      0      3]
 [132081      0      1]
 [132556      0      4]
 [132974      0      2]
 [133451      0      3]
 [133927      0      5]
 [134287      0     32]
 [134316      0      4]
 [134729      0      2]
 [135101      0      3]
 [135533      0      1]
 [135916      0      4]
 [136285      0      2]
 [136722      0      3]
 [137133      0      1]
 [137576      0      4]
 [137993      0      2]
 [138412      0      3]
 [138836      0      1]
 [139306      0      4]
 [139737      0      2]
 [140191      0      3]
 [140612      0      1]
 [141085      0      4]
 [141562      0      2]
 [141981      0      3]
 [142446      0      5]
 [142815      0     32]
 [142826      0      4]
 [143218      0      2]
 [143671      0      3]
 [144071      0      1]
 [144545      0      4]
 [144916      0      2]
 [145291      0      3]
 [145666      0      1]
 [146085      0      4]
 [146545      0      2]
 [147011      0      3]
 [147458      0      1]
 [147855      0      4]
 [148304      0      2]
 [148721      0      3]
 [149162      0      1]
 [149555      0      4]
 [149989      0      2]
 [150430      0      3]
 [150872      0      1]
 [151265      0      4]
 [151626      0      2]
 [152030      0      5]
 [152336      0     32]
 [152426      0      1]
 [152825      0      4]
 [153211      0      2]
 [153681      0      3]
 [154080      0      1]
 [154486      0      4]
 [168672      0     32]]
</pre></div>
</div>
<p>The event list contains three columns. The first column corresponds to
sample number. To convert this to seconds, you should divide the sample
number by the used sampling frequency. The second column is reserved for the
old value of the trigger channel at the time of transition, but is currently
not in use. The third column is the trigger id (amplitude of the pulse).</p>
<p>You might wonder why the samples don&#8217;t seem to align with the plotted data.
For instance, the first event has a sample number of 27977 which should
translate to roughly 46.6 seconds (27977 / 600). However looking at
the pulses we see the first pulse at 3.6 seconds. This is because Neuromag
recordings have an attribute <code class="docutils literal"><span class="pre">first_samp</span></code> which refers to the offset
between the system start and the start of the recording. Our data has a
<code class="docutils literal"><span class="pre">first_samp</span></code> equal to 25800. This means that the first sample you see with
<code class="docutils literal"><span class="pre">raw.plot</span></code> is the sample number 25800. Generally you don&#8217;t need to worry
about this offset as it is taken into account with MNE functions, but it is
good to be aware of. Just to confirm, let&#8217;s plot the events together with the
raw data. Notice how the vertical lines (events) align nicely with the pulses
on <cite>STI 014</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_epoching_and_averaging_003.png" class="align-center" src="../_images/sphx_glr_plot_epoching_and_averaging_003.png" />
<p>In this tutorial we are only interested in triggers 1, 2, 3 and 4. These
triggers correspond to auditory and visual stimuli. The <code class="docutils literal"><span class="pre">event_id</span></code> here
can be an int, a list of ints or a dict. With dicts it is possible to assign
these ids to distinct categories. When using ints or lists this information
is lost. First we shall define some parameters to feed to the
<a class="reference internal" href="../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-class docutils literal"><span class="pre">mne.Epochs</span></code></a> constructor. The values <code class="docutils literal"><span class="pre">tmin</span></code> and <code class="docutils literal"><span class="pre">tmax</span></code> refer to
offsets in relation to the events. Here we make epochs that collect the data
from 200 ms before to 500 ms after the event.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="n">event_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Auditory/Left&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Auditory/Right&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;Visual/Left&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Visual/Right&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="c1"># Only pick MEG and EOG channels.</span>
<span class="n">picks</span> <span class="o">=</span> <a href="../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we have everything we need to construct the epochs. To get some
meaningful results, we also want to baseline the epochs. Baselining computes
the mean over the baseline period and adjusts the data accordingly. The
epochs constructor uses a baseline period from <code class="docutils literal"><span class="pre">tmin</span></code> to 0.0 seconds by
default, but it is wise to be explicit. That way you are less likely to end
up with surprises along the way. <code class="docutils literal"><span class="pre">None</span></code> as the first element of the tuple
refers to the start of the time window (-200 ms in this case).
See <a class="reference internal" href="../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs"><code class="xref py py-class docutils literal"><span class="pre">mne.Epochs</span></code></a> for more.</p>
<p>We also define rejection thresholds to get rid of noisy epochs. The
rejection thresholds are defined as peak-to-peak values within the epoch time
window. They are defined as T/m for gradiometers, T for magnetometers and V
for EEG and EOG electrodes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this tutorial, we don&#8217;t preprocess the data. This is not
something you would normally do. See our <a class="reference internal" href="../tutorials.html#tutorials"><span>Tutorials</span></a> on
preprocessing for more.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">reject</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mag&#39;</span><span class="p">:</span> <span class="mf">4e-12</span><span class="p">,</span> <span class="s1">&#39;eog&#39;</span><span class="p">:</span> <span class="mf">200e-6</span><span class="p">}</span>
<span class="n">epochs</span> <span class="o">=</span> <a href="../generated/mne.Epochs.html#mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
                    <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="n">reject</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>289 matching events found
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 3)
4 projection items activated
</pre></div>
</div>
<p>Let&#8217;s plot the epochs to see the results. The number at the top refers to the
id number. We can see that 128 good epochs out of total of 145 events got
through the rejection process. Visual inspection also reveals that some
epochs containing saccades or blinks got through. You can also reject epochs
by hand by clicking on the epoch in the browser window. The selected epochs
get rejected when you close the epochs browser. How you should reject the
epochs and which thresholds to use is not a trivial question and this
tutorial takes no stand on that matter.</p>
<p>To see all the interactive features of the epochs browser, click &#8216;Help&#8217; in
the lower left corner of the browser window.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_epoching_and_averaging_004.png" class="align-center" src="../_images/sphx_glr_plot_epoching_and_averaging_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-python"><div class="highlight"><pre><span></span>Loading data for 289 events and 421 original time points ...
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on MAG : [u&#39;MEG 1711&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on MAG : [u&#39;MEG 1711&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [u&#39;EOG 061&#39;]
28 bad epochs dropped
Loading data for 20 events and 421 original time points ...
</pre></div>
</div>
<p>To see why the epochs were rejected, we can plot the drop log.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot_drop_log</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_epoching_and_averaging_005.png" class="align-center" src="../_images/sphx_glr_plot_epoching_and_averaging_005.png" />
<p>To get the evoked response you can simply do <code class="docutils literal"><span class="pre">epochs.average()</span></code>. It
includes only the data channels by default. For the sake of example, we use
picks to include the EOG channels as well. Notice that we cannot use the
same picks as before as the indices are different. &#8216;Why are they different?&#8217;
you might ask. They&#8217;re different because <code class="docutils literal"><span class="pre">picks</span></code> is simply a list of
channel indices and as the epochs were constructed, also a new info structure
is created where the channel indices run from 0 to <code class="docutils literal"><span class="pre">epochs.info['nchan']</span></code>.
See <a class="reference internal" href="plot_info.html#tut-info-objects"><span>The Info data structure</span></a> for more information.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">picks</span> <span class="o">=</span> <a href="../generated/mne.pick_types.html#mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">evoked_left</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Auditory/Left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
<span class="n">evoked_right</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Auditory/Right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice we have used forward slashes (&#8216;/&#8217;) to separate the factors of the
conditions of the experiment. We can use these &#8216;tags&#8217; to select for example
all left trials (both visual left and auditory right) ...</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">epochs_left</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Left&#39;</span><span class="p">]</span>

<span class="c1"># ... or to select a very specific subset. This is the same as above:</span>
<span class="n">evoked_left</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;Auditory&#39;</span><span class="p">,</span> <span class="s1">&#39;Left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, let&#8217;s plot the evoked responses.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">evoked_left</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">evoked_right</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_epoching_and_averaging_006.png"><img alt="../_images/sphx_glr_plot_epoching_and_averaging_006.png" src="../_images/sphx_glr_plot_epoching_and_averaging_006.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_epoching_and_averaging_007.png"><img alt="../_images/sphx_glr_plot_epoching_and_averaging_007.png" src="../_images/sphx_glr_plot_epoching_and_averaging_007.png" style="width: 376.0px; height: 282.0px;" /></a>
</li>
</ul>
<p><strong>Total running time of the script:</strong>
(0 minutes 16.670 seconds)</p>
<div class="sphx-glr-download container">
<strong>Download Python source code:</strong> <a class="reference download internal" href="../_downloads/plot_epoching_and_averaging.py"><code class="xref download docutils literal"><span class="pre">plot_epoching_and_averaging.py</span></code></a></div>
<div class="sphx-glr-download container">
<strong>Download IPython notebook:</strong> <a class="reference download internal" href="../_downloads/plot_epoching_and_averaging.ipynb"><code class="xref download docutils literal"><span class="pre">plot_epoching_and_averaging.ipynb</span></code></a></div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2012-2016, MNE Developers. Last updated on 2016-05-10.<br/>
    </p>
  </div>
</footer>
  </body>
</html>