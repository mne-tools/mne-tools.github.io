
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Extracting and visualizing subject head movement &#8212; MNE 0.23.dev0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.951c8c8e3af89de180a2f03968e0e7cb.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
    <!-- add `style` or `link` tags with your CSS `@font-face` declarations here -->
    <!-- ... and a `style` tag with setting `font-family` in `body` and `.header-style` -->
    <!-- ... and optionally preload the `woff2` for snappier page loads -->
    <!-- or add a `style` tag with a font fallback chain with good cross-platform coverage -->
    <style>
        body,.header-style {font-family: 'Source Sans Pro', sans-serif;}
        code,kbd,pre,samp {font-family: 'Source Code Pro', monospace;}
    </style>

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-sans-pro.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-code-pro.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.014cad6f3a039303089e.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Signal-space separation (SSS) and Maxwell filtering" href="plot_60_maxwell_filtering_sss.html" />
    <link rel="prev" title="Setting the EEG reference" href="plot_55_setting_eeg_reference.html" />
    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/scrollfix.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
  
    <div class="container-fluid alert-danger devbar">
      <div class="row no-gutters">
        <div class="col-12 text-center">
          This is documentation for the <em>unstable development version</em> of MNE-Python. <a class="alert-link" href="https://mne.tools/stable">Click here</a> to switch to the stable version.
        </div>
      </div>
    </div>
  

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
    <a class="navbar-brand" href="../../index.html">
        
        <img src="../../_static/mne_logo_small.svg" class="logo" alt="logo" />
        
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-auto col-lg-9 collapse navbar-collapse">
        <ul id="navbar-main-elements" class="navbar-nav mr-auto">
            
            
            <li class="nav-item ">
                <a class="nav-link" href="../../install/index.html">Install</a>
            </li>
            
            <li class="nav-item active">
                <a class="nav-link" href="../../overview/index.html">Documentation</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../python_reference.html">API Reference</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/get_help.html">Get help</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/development.html">Development</a>
            </li>
            
            
        </ul>

        

        <ul class="navbar-nav">
            <!-- version dropdown -->
            <li class="mr-2 dropdown">
                <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
                    v0.23.dev0
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                    <li><a href="https://mne-tools.github.io/dev/index.html">v0.23 (devel)</a></li>
                    <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                    <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                    <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                    <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                    <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
                </ul>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="https://github.com/mne-tools/mne-python" target="_blank" rel="noopener">
                    <span><i class="fab fa-github-square"></i></span>
                </a>
            </li>
            
            
            <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/mne_python" target="_blank" rel="noopener">
                    <span><i class="fab fa-twitter-square"></i></span>
                </a>
            </li>
            
            <!-- discourse forum link -->
            <li class="nav-item">
                <a class="nav-link" href="https://mne.discourse.group" target="_blank" rel="noopener">
                    <span><i class="fab fa-discourse"></i></span>
                </a>
            </li>
        </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
      <li class="toctree-l2 current active">
 <a class="reference internal" href="../index.html">
  Tutorials
 </a>
 <ul class="current">
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_10_overview.html">
    Overview of MEG/EEG analysis with MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_20_events_from_raw.html">
    Parsing events from raw data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_30_info.html">
    The Info data structure
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_40_sensor_locations.html">
    Working with sensor locations
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_50_configure_mne.html">
    Configuring MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_10_reading_meg_data.html">
    Importing data from MEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_20_reading_eeg_data.html">
    Importing data from EEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_30_reading_fnirs_data.html">
    Importing data from fNIRS devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_10_raw_overview.html">
    The Raw data structure: continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_20_event_arrays.html">
    Working with events
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_30_annotate_raw.html">
    Annotating continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_40_visualize_raw.html">
    Built-in plotting methods for Raw objects
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_10_preprocessing_overview.html">
    Overview of artifact detection
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_15_handling_bad_channels.html">
    Interpolating bad channels
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_20_rejecting_bad_data.html">
    Rejecting bad data spans
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_30_filtering_resampling.html">
    Filtering and resampling data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_35_artifact_correction_regression.html">
    Repairing artifacts with regression
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_40_artifact_correction_ica.html">
    Repairing artifacts with ICA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_45_projectors_background.html">
    Background on projectors and projections
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_50_artifact_correction_ssp.html">
    Repairing artifacts with SSP
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_55_setting_eeg_reference.html">
    Setting the EEG reference
   </a>
  </li>
  <li class="toctree-l3 current active">
   <a class="current reference internal" href="#">
    Extracting and visualizing subject head movement
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_60_maxwell_filtering_sss.html">
    Signal-space separation (SSS) and Maxwell filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_70_fnirs_processing.html">
    Preprocessing functional near-infrared spectroscopy (fNIRS) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_10_epochs_overview.html">
    The Epochs data structure: discontinuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_20_visualize_epochs.html">
    Visualizing epoched data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_30_epochs_metadata.html">
    Working with Epoch metadata
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_40_epochs_to_data_frame.html">
    Exporting Epochs to Pandas DataFrames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_10_evoked_overview.html">
    The Evoked data structure: evoked/averaged data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_20_visualize_evoked.html">
    Visualizing Evoked data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_eeg_erp.html">
    EEG processing and Event Related Potentials (ERPs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_whitened.html">
    Plotting whitened data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../time-freq/plot_sensors_time_frequency.html">
    Frequency and time-frequency sensor analysis
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_background_freesurfer.html">
    FreeSurfer MRI reconstruction
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_background_freesurfer_mne.html">
    How MNE uses FreeSurfer’s outputs
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_beamformer_lcmv.html">
    Source reconstruction using an LCMV beamformer
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_compute_covariance.html">
    Computing a covariance matrix
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_dipole_fit.html">
    Source localization with equivalent current dipole (ECD) fit
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_dipole_orientations.html">
    The role of dipole orientations in distributed source localization
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_eeg_mri_coords.html">
    EEG source localization given electrode locations on an MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_eeg_no_mri.html">
    EEG forward operator with a template MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_fix_bem_in_blender.html">
    Editing BEM surfaces in Blender
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_forward.html">
    Head model and forward computation
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_mne_dspm_source_localization.html">
    Source localization with MNE/dSPM/sLORETA/eLORETA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_mne_solutions.html">
    Computing various MNE solutions
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_object_source_estimate.html">
    The
    <code class="xref py py-class docutils literal notranslate">
     <span class="pre">
      SourceEstimate
     </span>
    </code>
    data structure
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_source_alignment.html">
    Source alignment and coordinate frames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../source-modeling/plot_visualize_stc.html">
    Visualize source time courses (stcs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_1samp_test_time_frequency.html">
    Non-parametric 1 sample cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_erp.html">
    Visualising statistical significance thresholds on EEG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_time_frequency.html">
    Non-parametric between conditions cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_spatio_temporal_cluster_sensors.html">
    Spatiotemporal permutation F-test on full sensor data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal.html">
    Permutation t-test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_2samp.html">
    2 samples permutation test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_repeated_measures_anova.html">
    Repeated measures ANOVA on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_time_frequency_repeated_measures_anova.html">
    Mass-univariate twoway repeated measures ANOVA on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_receptive_field.html">
    Spectro-temporal receptive field (STRF) estimation on continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_sensors_decoding.html">
    Decoding (MVPA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_creating_data_structures.html">
    Creating MNE-Python data structures from scratch
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_dics.html">
    DICS for power mapping
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_point_spread.html">
    Corrupt known signal with point spread
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_auditory.html">
    Brainstorm auditory tutorial dataset
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_ctf.html">
    Brainstorm CTF phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_elekta.html">
    Brainstorm Elekta phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_phantom_4DBTi.html">
    4D Neuroimaging/BTi phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_sleep.html">
    Sleep stage classification from polysomnography (PSG) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_filtering.html">
    Background information on filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_ica.html">
    Background on Independent Component Analysis (ICA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_statistics.html">
    Statistical inference
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_ecog.html">
    Working with ECoG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_modifying_data_inplace.html">
    Modifying data in-place
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_report.html">
    Getting started with
    <code class="docutils literal notranslate">
     <span class="pre">
      mne.Report
     </span>
    </code>
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_seeg.html">
    Working with sEEG data
   </a>
  </li>
 </ul>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../auto_examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../glossary.html">
  Glossary
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/implementation.html">
  Implementation details
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/design_philosophy.html">
  Design philosophy
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/datasets_index.html">
  Example datasets
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../generated/commands.html">
  Command-line tools
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/migrating.html">
  Migrating from other analysis software
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cookbook.html">
  The typical M/EEG workflow
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cite.html">
  How to cite MNE-Python
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../cited.html">
  Papers citing MNE-Python
 </a>
</li>

    </ul>
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>



<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hpi-frequencies">
   HPI frequencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-continuous-head-position">
   Estimating continuous head position
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-continuous-head-position">
   Visualizing continuous head position
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
<div>
  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-preprocessing-plot-59-head-positions-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="extracting-and-visualizing-subject-head-movement">
<span id="tut-head-pos"></span><span id="sphx-glr-auto-tutorials-preprocessing-plot-59-head-positions-py"></span><h1>Extracting and visualizing subject head movement<a class="headerlink" href="#extracting-and-visualizing-subject-head-movement" title="Permalink to this headline">¶</a></h1>
<p>Continuous head movement can be encoded during MEG recordings by use of
HPI coils that continuously emit sinusoidal signals. These signals can then be
extracted from the recording and used to estimate head position as a function
of time. Here we show an example of how to do this, and how to visualize
the result.</p>
<div class="section" id="hpi-frequencies">
<h2>HPI frequencies<a class="headerlink" href="#hpi-frequencies" title="Permalink to this headline">¶</a></h2>
<p>First let’s load a short bit of raw data where the subject intentionally moved
their head during the recording. Its power spectral density shows five peaks
(most clearly visible in the gradiometers) corresponding to the HPI coil
frequencies, plus other peaks related to power line interference (60 Hz and
harmonics).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">op</span>

<span class="kn">import</span> <span class="nn">mne</span>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="s1">&#39;SSS&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;test_move_anon_raw.fif&#39;</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a><span class="p">,</span> <span class="n">allow_maxshield</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_psd" title="mne.io.Raw.plot_psd" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">plot_psd</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="EEG, Gradiometers, Magnetometers" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-testing-data/SSS/test_move_anon_raw.fif...
    Read a total of 12 projection items:
        mag.fif : PCA-v1 (1 x 306)  idle
        mag.fif : PCA-v2 (1 x 306)  idle
        mag.fif : PCA-v3 (1 x 306)  idle
        mag.fif : PCA-v4 (1 x 306)  idle
        mag.fif : PCA-v5 (1 x 306)  idle
        mag.fif : PCA-v6 (1 x 306)  idle
        mag.fif : PCA-v7 (1 x 306)  idle
        grad.fif : PCA-v1 (1 x 306)  idle
        grad.fif : PCA-v2 (1 x 306)  idle
        grad.fif : PCA-v3 (1 x 306)  idle
        grad.fif : PCA-v4 (1 x 306)  idle
        Average EEG reference (1 x 60)  idle
    Range : 10800 ... 31199 =      9.000 ...    25.999 secs
Ready.
Reading 0 ... 20399  =      0.000 ...    16.999 secs...
Effective window size : 1.707 (s)
Effective window size : 1.707 (s)
Effective window size : 1.707 (s)
</pre></div>
</div>
</div>
<div class="section" id="estimating-continuous-head-position">
<h2>Estimating continuous head position<a class="headerlink" href="#estimating-continuous-head-position" title="Permalink to this headline">¶</a></h2>
<p>First, let’s extract the HPI coil amplitudes as a function of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_amplitudes</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_chpi_amplitudes.html#mne.chpi.compute_chpi_amplitudes" title="mne.chpi.compute_chpi_amplitudes" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_chpi_amplitudes</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using 5 HPI coils: 83 143 203 263 323 Hz
Line interference frequencies: 60 120 180 240 300 360 Hz
Using time window: 83.3 ms
Fitting 5 HPI coil locations at up to 1696 time points (17.0 sec duration)

  0%|          | cHPI amplitudes : 0/1696 [00:00&lt;?,       ?it/s]
  0%|          | cHPI amplitudes : 1/1696 [00:02&lt;1:11:49,    2.54s/it]
  1%|1         | cHPI amplitudes : 22/1696 [00:02&lt;03:05,    9.03it/s]
  3%|2         | cHPI amplitudes : 44/1696 [00:02&lt;01:29,   18.37it/s]
  4%|3         | cHPI amplitudes : 62/1696 [00:02&lt;01:02,   26.29it/s]
  5%|4         | cHPI amplitudes : 84/1696 [00:02&lt;00:44,   36.38it/s]
  6%|5         | cHPI amplitudes : 101/1696 [00:02&lt;00:36,   43.38it/s]
  7%|7         | cHPI amplitudes : 119/1696 [00:02&lt;00:30,   52.00it/s]
  8%|8         | cHPI amplitudes : 140/1696 [00:02&lt;00:24,   62.49it/s]
  9%|9         | cHPI amplitudes : 161/1696 [00:02&lt;00:20,   73.34it/s]
 10%|9         | cHPI amplitudes : 162/1696 [00:02&lt;00:21,   71.80it/s]
 10%|#         | cHPI amplitudes : 178/1696 [00:02&lt;00:18,   80.39it/s]
 12%|#1        | cHPI amplitudes : 199/1696 [00:02&lt;00:16,   92.28it/s]
 13%|#2        | cHPI amplitudes : 220/1696 [00:02&lt;00:14,  104.56it/s]
 13%|#3        | cHPI amplitudes : 221/1696 [00:02&lt;00:14,  101.73it/s]
 14%|#4        | cHPI amplitudes : 240/1696 [00:02&lt;00:12,  113.25it/s]
 15%|#5        | cHPI amplitudes : 261/1696 [00:02&lt;00:11,  126.55it/s]
 17%|#6        | cHPI amplitudes : 282/1696 [00:02&lt;00:10,  135.23it/s]
 18%|#7        | cHPI amplitudes : 299/1696 [00:02&lt;00:09,  145.92it/s]
 19%|#8        | cHPI amplitudes : 320/1696 [00:03&lt;00:08,  159.96it/s]
 20%|##        | cHPI amplitudes : 342/1696 [00:03&lt;00:08,  168.38it/s]
 21%|##1       | cHPI amplitudes : 359/1696 [00:03&lt;00:07,  179.50it/s]
 22%|##2       | cHPI amplitudes : 378/1696 [00:03&lt;00:06,  192.48it/s]
 23%|##3       | cHPI amplitudes : 396/1696 [00:03&lt;00:06,  196.63it/s]
 24%|##4       | cHPI amplitudes : 413/1696 [00:03&lt;00:06,  208.18it/s]
 26%|##5       | cHPI amplitudes : 435/1696 [00:03&lt;00:05,  224.29it/s]
 27%|##6       | cHPI amplitudes : 456/1696 [00:03&lt;00:05,  239.99it/s]
 27%|##6       | cHPI amplitudes : 457/1696 [00:03&lt;00:05,  229.77it/s]
 28%|##7       | cHPI amplitudes : 472/1696 [00:03&lt;00:05,  240.30it/s]
 29%|##9       | cHPI amplitudes : 493/1696 [00:03&lt;00:04,  256.98it/s]
 30%|###       | cHPI amplitudes : 514/1696 [00:03&lt;00:04,  260.56it/s]
 31%|###1      | cHPI amplitudes : 532/1696 [00:03&lt;00:04,  274.12it/s]
 33%|###2      | cHPI amplitudes : 553/1696 [00:03&lt;00:03,  291.14it/s]
 34%|###3      | cHPI amplitudes : 574/1696 [00:03&lt;00:03,  292.50it/s]
 35%|###4      | cHPI amplitudes : 592/1696 [00:03&lt;00:03,  306.18it/s]
 36%|###6      | cHPI amplitudes : 614/1696 [00:03&lt;00:03,  324.38it/s]
 37%|###7      | cHPI amplitudes : 633/1696 [00:03&lt;00:03,  321.68it/s]
 38%|###8      | cHPI amplitudes : 651/1696 [00:03&lt;00:03,  335.46it/s]
 40%|###9      | cHPI amplitudes : 672/1696 [00:03&lt;00:02,  352.77it/s]
 41%|####      | cHPI amplitudes : 693/1696 [00:03&lt;00:02,  350.05it/s]
 42%|####1     | cHPI amplitudes : 709/1696 [00:03&lt;00:02,  361.80it/s]
 43%|####3     | cHPI amplitudes : 730/1696 [00:03&lt;00:02,  379.60it/s]
 44%|####4     | cHPI amplitudes : 752/1696 [00:03&lt;00:02,  398.56it/s]
 44%|####4     | cHPI amplitudes : 753/1696 [00:03&lt;00:02,  375.25it/s]
 46%|####5     | cHPI amplitudes : 772/1696 [00:03&lt;00:02,  391.02it/s]
 47%|####6     | cHPI amplitudes : 794/1696 [00:03&lt;00:02,  410.64it/s]
 48%|####7     | cHPI amplitudes : 814/1696 [00:03&lt;00:02,  401.64it/s]
 49%|####9     | cHPI amplitudes : 833/1696 [00:03&lt;00:02,  417.30it/s]
 50%|#####     | cHPI amplitudes : 855/1696 [00:03&lt;00:01,  436.90it/s]
 52%|#####1    | cHPI amplitudes : 874/1696 [00:03&lt;00:01,  424.13it/s]
 53%|#####2    | cHPI amplitudes : 894/1696 [00:03&lt;00:01,  440.81it/s]
 54%|#####3    | cHPI amplitudes : 915/1696 [00:04&lt;00:01,  459.34it/s]
 55%|#####5    | cHPI amplitudes : 937/1696 [00:04&lt;00:01,  447.80it/s]
 56%|#####6    | cHPI amplitudes : 955/1696 [00:04&lt;00:01,  461.77it/s]
 58%|#####7    | cHPI amplitudes : 977/1696 [00:04&lt;00:01,  481.17it/s]
 59%|#####8    | cHPI amplitudes : 997/1696 [00:04&lt;00:01,  465.52it/s]
 60%|#####9    | cHPI amplitudes : 1014/1696 [00:04&lt;00:01,  477.98it/s]
 61%|######1   | cHPI amplitudes : 1035/1696 [00:04&lt;00:01,  496.39it/s]
 62%|######2   | cHPI amplitudes : 1057/1696 [00:04&lt;00:01,  515.88it/s]
 62%|######2   | cHPI amplitudes : 1058/1696 [00:04&lt;00:01,  480.75it/s]
 63%|######3   | cHPI amplitudes : 1076/1696 [00:04&lt;00:01,  495.12it/s]
 65%|######4   | cHPI amplitudes : 1097/1696 [00:04&lt;00:01,  514.20it/s]
 66%|######5   | cHPI amplitudes : 1117/1696 [00:04&lt;00:01,  493.95it/s]
 67%|######6   | cHPI amplitudes : 1133/1696 [00:04&lt;00:01,  505.57it/s]
 68%|######8   | cHPI amplitudes : 1155/1696 [00:04&lt;00:01,  525.61it/s]
 69%|######9   | cHPI amplitudes : 1173/1696 [00:04&lt;00:01,  500.97it/s]
 70%|#######   | cHPI amplitudes : 1191/1696 [00:04&lt;00:00,  515.31it/s]
 71%|#######1  | cHPI amplitudes : 1212/1696 [00:04&lt;00:00,  534.23it/s]
 73%|#######2  | cHPI amplitudes : 1233/1696 [00:04&lt;00:00,  512.95it/s]
 74%|#######3  | cHPI amplitudes : 1250/1696 [00:04&lt;00:00,  525.52it/s]
 75%|#######5  | cHPI amplitudes : 1272/1696 [00:04&lt;00:00,  545.29it/s]
 76%|#######6  | cHPI amplitudes : 1294/1696 [00:04&lt;00:00,  524.53it/s]
 77%|#######7  | cHPI amplitudes : 1312/1696 [00:04&lt;00:00,  538.26it/s]
 79%|#######8  | cHPI amplitudes : 1333/1696 [00:04&lt;00:00,  556.81it/s]
 80%|#######9  | cHPI amplitudes : 1354/1696 [00:04&lt;00:00,  575.41it/s]
 80%|#######9  | cHPI amplitudes : 1355/1696 [00:04&lt;00:00,  532.41it/s]
 81%|########  | cHPI amplitudes : 1371/1696 [00:04&lt;00:00,  543.87it/s]
 82%|########2 | cHPI amplitudes : 1391/1696 [00:04&lt;00:00,  561.37it/s]
 83%|########3 | cHPI amplitudes : 1413/1696 [00:04&lt;00:00,  537.75it/s]
 84%|########4 | cHPI amplitudes : 1428/1696 [00:04&lt;00:00,  547.41it/s]
 85%|########5 | cHPI amplitudes : 1449/1696 [00:04&lt;00:00,  566.61it/s]
 87%|########6 | cHPI amplitudes : 1470/1696 [00:04&lt;00:00,  585.82it/s]
 87%|########6 | cHPI amplitudes : 1471/1696 [00:04&lt;00:00,  539.93it/s]
 88%|########7 | cHPI amplitudes : 1490/1696 [00:04&lt;00:00,  556.29it/s]
 89%|########9 | cHPI amplitudes : 1511/1696 [00:05&lt;00:00,  575.84it/s]
 90%|######### | cHPI amplitudes : 1531/1696 [00:05&lt;00:00,  546.90it/s]
 91%|#########1| cHPI amplitudes : 1550/1696 [00:05&lt;00:00,  562.52it/s]
 93%|#########2| cHPI amplitudes : 1572/1696 [00:05&lt;00:00,  583.01it/s]
 94%|#########3| cHPI amplitudes : 1593/1696 [00:05&lt;00:00,  555.65it/s]
 95%|#########5| cHPI amplitudes : 1613/1696 [00:05&lt;00:00,  572.51it/s]
 96%|#########6| cHPI amplitudes : 1635/1696 [00:05&lt;00:00,  592.56it/s]
 98%|#########7| cHPI amplitudes : 1656/1696 [00:05&lt;00:00,  564.43it/s]
 99%|#########8| cHPI amplitudes : 1673/1696 [00:05&lt;00:00,  576.27it/s]
100%|#########9| cHPI amplitudes : 1694/1696 [00:05&lt;00:00,  593.99it/s]
100%|##########| cHPI amplitudes : 1696/1696 [00:05&lt;00:00,  319.08it/s]
</pre></div>
</div>
<p>Second, let’s compute time-varying HPI coil locations from these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_locs</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_chpi_locs.html#mne.chpi.compute_chpi_locs" title="mne.chpi.compute_chpi_locs" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_chpi_locs</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_amplitudes</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing 4385 HPI location guesses (1 cm grid in a 10.7 cm sphere)
HPIFIT: 5 coils digitized in order 5 1 4 3 2
HPI consistency of isotrak and hpifit is OK.

  0%|          | cHPI locations  : 0/1696 [00:00&lt;?,       ?it/s]
  0%|          | cHPI locations  : 1/1696 [00:00&lt;18:48,    1.50it/s]
  2%|2         | cHPI locations  : 41/1696 [00:00&lt;00:26,   63.11it/s]
  5%|4         | cHPI locations  : 81/1696 [00:00&lt;00:14,  113.95it/s]
  6%|5         | cHPI locations  : 101/1696 [00:00&lt;00:14,  108.26it/s]
  8%|7         | cHPI locations  : 131/1696 [00:01&lt;00:11,  131.59it/s]
 10%|9         | cHPI locations  : 162/1696 [00:01&lt;00:09,  164.27it/s]
 12%|#1        | cHPI locations  : 201/1696 [00:01&lt;00:08,  169.88it/s]
 14%|#3        | cHPI locations  : 237/1696 [00:01&lt;00:07,  190.31it/s]
 16%|#5        | cHPI locations  : 271/1696 [00:01&lt;00:06,  220.15it/s]
 18%|#7        | cHPI locations  : 301/1696 [00:01&lt;00:06,  208.80it/s]
 20%|#9        | cHPI locations  : 335/1696 [00:01&lt;00:06,  222.12it/s]
 22%|##1       | cHPI locations  : 372/1696 [00:01&lt;00:05,  250.83it/s]
 24%|##3       | cHPI locations  : 401/1696 [00:01&lt;00:05,  236.43it/s]
 26%|##6       | cHPI locations  : 441/1696 [00:01&lt;00:04,  265.46it/s]
 28%|##8       | cHPI locations  : 483/1696 [00:01&lt;00:04,  296.91it/s]
 29%|##9       | cHPI locations  : 497/1696 [00:01&lt;00:04,  293.20it/s]
 30%|##9       | cHPI locations  : 501/1696 [00:02&lt;00:04,  250.38it/s]
 32%|###1      | cHPI locations  : 542/1696 [00:02&lt;00:04,  278.77it/s]
 33%|###2      | cHPI locations  : 559/1696 [00:02&lt;00:04,  235.64it/s]
 33%|###3      | cHPI locations  : 568/1696 [00:02&lt;00:05,  200.67it/s]
 34%|###3      | cHPI locations  : 573/1696 [00:03&lt;00:06,  166.16it/s]
 34%|###4      | cHPI locations  : 577/1696 [00:03&lt;00:07,  145.13it/s]
 34%|###4      | cHPI locations  : 581/1696 [00:03&lt;00:08,  128.56it/s]
 35%|###4      | cHPI locations  : 587/1696 [00:04&lt;00:09,  116.04it/s]
 35%|###5      | cHPI locations  : 598/1696 [00:04&lt;00:09,  116.77it/s]
 35%|###5      | cHPI locations  : 600/1696 [00:04&lt;00:10,  107.83it/s]
 37%|###6      | cHPI locations  : 626/1696 [00:04&lt;00:09,  114.51it/s]
 39%|###8      | cHPI locations  : 659/1696 [00:04&lt;00:08,  126.97it/s]
 41%|####1     | cHPI locations  : 700/1696 [00:04&lt;00:07,  128.29it/s]
 44%|####3     | cHPI locations  : 741/1696 [00:04&lt;00:06,  143.54it/s]
 46%|####6     | cHPI locations  : 781/1696 [00:04&lt;00:05,  155.42it/s]
 47%|####6     | cHPI locations  : 789/1696 [00:05&lt;00:06,  140.31it/s]
 47%|####6     | cHPI locations  : 794/1696 [00:05&lt;00:07,  127.22it/s]
 47%|####7     | cHPI locations  : 800/1696 [00:05&lt;00:07,  116.53it/s]
 47%|####7     | cHPI locations  : 805/1696 [00:06&lt;00:08,  107.10it/s]
 48%|####7     | cHPI locations  : 810/1696 [00:06&lt;00:08,   98.87it/s]
 48%|####8     | cHPI locations  : 815/1696 [00:06&lt;00:09,   91.68it/s]
 48%|####8     | cHPI locations  : 819/1696 [00:06&lt;00:10,   85.13it/s]
 49%|####8     | cHPI locations  : 823/1696 [00:07&lt;00:11,   79.21it/s]
 49%|####8     | cHPI locations  : 827/1696 [00:07&lt;00:11,   73.96it/s]
 49%|####9     | cHPI locations  : 833/1696 [00:07&lt;00:12,   69.83it/s]
 50%|#####     | cHPI locations  : 848/1696 [00:08&lt;00:12,   66.85it/s]
 52%|#####2    | cHPI locations  : 889/1696 [00:08&lt;00:10,   77.04it/s]
 55%|#####4    | cHPI locations  : 928/1696 [00:08&lt;00:08,   87.13it/s]
 55%|#####5    | cHPI locations  : 938/1696 [00:08&lt;00:08,   88.44it/s]
 56%|#####5    | cHPI locations  : 948/1696 [00:08&lt;00:09,   81.68it/s]
 58%|#####8    | cHPI locations  : 989/1696 [00:08&lt;00:07,   92.51it/s]
 61%|######    | cHPI locations  : 1031/1696 [00:08&lt;00:06,  104.09it/s]
 61%|######1   | cHPI locations  : 1040/1696 [00:09&lt;00:06,   96.21it/s]
 62%|######1   | cHPI locations  : 1051/1696 [00:09&lt;00:06,   93.42it/s]
 63%|######2   | cHPI locations  : 1062/1696 [00:09&lt;00:07,   87.28it/s]
 63%|######3   | cHPI locations  : 1072/1696 [00:09&lt;00:07,   84.91it/s]
 64%|######3   | cHPI locations  : 1082/1696 [00:10&lt;00:07,   85.82it/s]
 64%|######4   | cHPI locations  : 1086/1696 [00:10&lt;00:07,   81.91it/s]
 65%|######4   | cHPI locations  : 1098/1696 [00:10&lt;00:07,   83.42it/s]
 67%|######6   | cHPI locations  : 1132/1696 [00:10&lt;00:06,   92.58it/s]
 69%|######9   | cHPI locations  : 1174/1696 [00:10&lt;00:04,  104.47it/s]
 70%|######9   | cHPI locations  : 1186/1696 [00:10&lt;00:04,  102.15it/s]
 70%|#######   | cHPI locations  : 1195/1696 [00:10&lt;00:04,  102.50it/s]
 73%|#######2  | cHPI locations  : 1230/1696 [00:10&lt;00:04,  112.99it/s]
 75%|#######5  | cHPI locations  : 1272/1696 [00:10&lt;00:03,  126.22it/s]
 76%|#######5  | cHPI locations  : 1286/1696 [00:10&lt;00:03,  122.94it/s]
 76%|#######6  | cHPI locations  : 1296/1696 [00:11&lt;00:03,  114.90it/s]
 77%|#######6  | cHPI locations  : 1301/1696 [00:11&lt;00:03,  106.28it/s]
 77%|#######7  | cHPI locations  : 1306/1696 [00:11&lt;00:03,   98.51it/s]
 77%|#######7  | cHPI locations  : 1311/1696 [00:12&lt;00:04,   91.61it/s]
 78%|#######7  | cHPI locations  : 1315/1696 [00:12&lt;00:04,   85.42it/s]
 78%|#######7  | cHPI locations  : 1319/1696 [00:12&lt;00:04,   79.89it/s]
 78%|#######8  | cHPI locations  : 1325/1696 [00:12&lt;00:04,   75.32it/s]
 78%|#######8  | cHPI locations  : 1331/1696 [00:13&lt;00:05,   71.14it/s]
 79%|#######9  | cHPI locations  : 1341/1696 [00:13&lt;00:05,   68.39it/s]
 81%|########1 | cHPI locations  : 1382/1696 [00:13&lt;00:04,   78.47it/s]
 83%|########3 | cHPI locations  : 1413/1696 [00:13&lt;00:03,   85.05it/s]
 85%|########4 | cHPI locations  : 1441/1696 [00:13&lt;00:02,   87.58it/s]
 87%|########6 | cHPI locations  : 1472/1696 [00:13&lt;00:02,   93.87it/s]
 89%|########8 | cHPI locations  : 1508/1696 [00:13&lt;00:01,  103.51it/s]
 91%|######### | cHPI locations  : 1541/1696 [00:14&lt;00:01,  106.73it/s]
 91%|#########1| cHPI locations  : 1551/1696 [00:14&lt;00:01,  107.24it/s]
 92%|#########2| cHPI locations  : 1565/1696 [00:14&lt;00:01,  101.66it/s]
 93%|#########2| cHPI locations  : 1573/1696 [00:14&lt;00:01,   95.71it/s]
 93%|#########3| cHPI locations  : 1580/1696 [00:15&lt;00:01,   90.25it/s]
 94%|#########3| cHPI locations  : 1586/1696 [00:15&lt;00:01,   85.04it/s]
 94%|#########3| cHPI locations  : 1590/1696 [00:15&lt;00:01,   79.69it/s]
 94%|#########3| cHPI locations  : 1594/1696 [00:16&lt;00:01,   74.93it/s]
 94%|#########4| cHPI locations  : 1599/1696 [00:16&lt;00:01,   70.85it/s]
 95%|#########4| cHPI locations  : 1609/1696 [00:16&lt;00:01,   68.15it/s]
 97%|#########6| cHPI locations  : 1643/1696 [00:16&lt;00:00,   74.89it/s]
 97%|#########7| cHPI locations  : 1652/1696 [00:16&lt;00:00,   73.02it/s]
 98%|#########7| cHPI locations  : 1657/1696 [00:17&lt;00:00,   72.90it/s]
100%|#########9| cHPI locations  : 1695/1696 [00:17&lt;00:00,   82.32it/s]
100%|##########| cHPI locations  : 1696/1696 [00:17&lt;00:00,   99.32it/s]
</pre></div>
</div>
<p>Lastly, compute head positions from the coil locations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.compute_head_pos.html#mne.chpi.compute_head_pos" title="mne.chpi.compute_head_pos" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">compute_head_pos</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chpi_locs</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>t=9.000:     5/5 good HPI fits, movements [mm/s] =      0.1 /      0.1 /      0.5 /      0.2 /      0.3
t=10.000:    5/5 good HPI fits, movements [mm/s] =      0.1 /      0.3 /      0.0 /      0.2 /      0.1
t=11.000:    5/5 good HPI fits, movements [mm/s] =      0.1 /      0.1 /      0.1 /      0.0 /      0.1
t=12.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.0 /      0.1 /      0.0 /      0.0
t=13.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.1 /      0.0 /      0.0 /      0.1
t=14.000:    5/5 good HPI fits, movements [mm/s] =      0.0 /      0.1 /      0.1 /      0.1 /      0.1
t=14.580:    5/5 good HPI fits, movements [mm/s] =      5.0 /      4.8 /      6.1 /      5.5 /      4.9
t=14.670:    5/5 good HPI fits, movements [mm/s] =     33.5 /     33.9 /     39.9 /     38.1 /     30.4
t=14.720:    5/5 good HPI fits, movements [mm/s] =     48.9 /     47.9 /     60.5 /     59.3 /     44.5
t=14.760:    5/5 good HPI fits, movements [mm/s] =     65.3 /     63.1 /     72.9 /     71.0 /     55.8
t=14.800:    5/5 good HPI fits, movements [mm/s] =     66.7 /     59.2 /     82.9 /     78.0 /     61.4
t=14.860:    5/5 good HPI fits, movements [mm/s] =     54.3 /     52.1 /     57.8 /     61.9 /     47.1
t=14.990:    5/5 good HPI fits, movements [mm/s] =     23.4 /     22.5 /     24.0 /     27.1 /     19.8
t=15.990:    5/5 good HPI fits, movements [mm/s] =      0.7 /      0.9 /      0.8 /      0.8 /      0.9
t=16.880:    5/5 good HPI fits, movements [mm/s] =      2.6 /      3.4 /      2.9 /      3.8 /      3.3
t=16.930:    5/5 good HPI fits, movements [mm/s] =     51.9 /     55.3 /     58.0 /     67.4 /     59.1
t=16.990:    5/5 good HPI fits, movements [mm/s] =     56.9 /     53.7 /     62.2 /     64.8 /     57.8
t=17.040:    5/5 good HPI fits, movements [mm/s] =     53.8 /     50.1 /     60.0 /     61.9 /     49.4
t=17.090:    5/5 good HPI fits, movements [mm/s] =     57.5 /     50.1 /     66.6 /     64.8 /     51.6
t=17.140:    5/5 good HPI fits, movements [mm/s] =     60.5 /     54.7 /     72.6 /     67.3 /     57.6
t=17.180:    5/5 good HPI fits, movements [mm/s] =     63.7 /     61.6 /     74.4 /     72.3 /     61.6
t=17.220:    5/5 good HPI fits, movements [mm/s] =     60.8 /     57.4 /     75.5 /     71.2 /     63.4
t=17.260:    5/5 good HPI fits, movements [mm/s] =     68.0 /     65.5 /     73.4 /     69.0 /     69.3
t=17.320:    5/5 good HPI fits, movements [mm/s] =     49.4 /     50.5 /     55.0 /     54.9 /     52.3
t=17.470:    5/5 good HPI fits, movements [mm/s] =     18.6 /     21.3 /     19.2 /     20.5 /     17.4
t=18.470:    5/5 good HPI fits, movements [mm/s] =      1.9 /      2.7 /      2.0 /      2.4 /      1.9
t=19.390:    5/5 good HPI fits, movements [mm/s] =      2.4 /      2.7 /      1.9 /      2.9 /      2.5
t=19.500:    5/5 good HPI fits, movements [mm/s] =     23.0 /     25.2 /     19.4 /     28.8 /     27.6
t=19.610:    5/5 good HPI fits, movements [mm/s] =     21.2 /     25.6 /     21.8 /     31.7 /     31.5
t=19.710:    5/5 good HPI fits, movements [mm/s] =     21.7 /     20.6 /     23.0 /     29.7 /     27.6
t=19.850:    5/5 good HPI fits, movements [mm/s] =     16.5 /     14.7 /     18.7 /     21.8 /     20.1
t=20.850:    5/5 good HPI fits, movements [mm/s] =      2.3 /      1.9 /      2.0 /      2.5 /      2.2
t=21.850:    5/5 good HPI fits, movements [mm/s] =      0.5 /      1.7 /      1.7 /      2.0 /      1.9
t=21.950:    5/5 good HPI fits, movements [mm/s] =     25.8 /     26.9 /     24.1 /     32.0 /     26.3
t=22.000:    5/5 good HPI fits, movements [mm/s] =     65.6 /     59.5 /     46.5 /     64.9 /     52.1
t=22.050:    5/5 good HPI fits, movements [mm/s] =     60.5 /     61.9 /     51.0 /     69.2 /     57.9
t=22.100:    5/5 good HPI fits, movements [mm/s] =     61.0 /     65.9 /     58.5 /     74.9 /     64.5
t=22.140:    5/5 good HPI fits, movements [mm/s] =     74.7 /     74.2 /     62.3 /     80.1 /     67.8
t=22.180:    5/5 good HPI fits, movements [mm/s] =     63.6 /     59.3 /     53.3 /     67.6 /     54.1
t=22.240:    5/5 good HPI fits, movements [mm/s] =     38.6 /     39.0 /     36.7 /     47.7 /     42.1
t=22.300:    5/5 good HPI fits, movements [mm/s] =     41.9 /     40.3 /     33.3 /     47.5 /     39.1
t=22.400:    5/5 good HPI fits, movements [mm/s] =     31.9 /     28.5 /     22.2 /     30.8 /     24.9
t=23.400:    5/5 good HPI fits, movements [mm/s] =      1.8 /      1.8 /      1.1 /      1.5 /      1.2
t=24.400:    5/5 good HPI fits, movements [mm/s] =      1.3 /      0.8 /      0.7 /      0.8 /      0.7
t=24.640:    5/5 good HPI fits, movements [mm/s] =     12.6 /     11.5 /     11.5 /     13.1 /     10.9
t=24.720:    5/5 good HPI fits, movements [mm/s] =     30.2 /     33.2 /     31.7 /     38.8 /     35.2
t=24.790:    5/5 good HPI fits, movements [mm/s] =     31.2 /     35.9 /     33.1 /     42.9 /     40.9
t=24.850:    5/5 good HPI fits, movements [mm/s] =     37.6 /     41.1 /     35.7 /     45.2 /     42.1
t=24.890:    5/5 good HPI fits, movements [mm/s] =     50.2 /     51.3 /     49.5 /     59.9 /     53.2
t=24.930:    5/5 good HPI fits, movements [mm/s] =     55.5 /     55.2 /     59.1 /     68.2 /     62.0
t=24.980:    5/5 good HPI fits, movements [mm/s] =     47.4 /     47.6 /     51.1 /     58.8 /     53.8
t=25.080:    5/5 good HPI fits, movements [mm/s] =     23.7 /     19.2 /     23.1 /     28.1 /     26.3
t=25.510:    5/5 good HPI fits, movements [mm/s] =      2.4 /      6.5 /      7.4 /      6.5 /      7.8
</pre></div>
</div>
<p>Note that these can then be written to disk or read from disk with
<a class="reference internal" href="../../generated/mne.chpi.write_head_pos.html#mne.chpi.write_head_pos" title="mne.chpi.write_head_pos"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.write_head_pos()</span></code></a> and <a class="reference internal" href="../../generated/mne.chpi.read_head_pos.html#mne.chpi.read_head_pos" title="mne.chpi.read_head_pos"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.read_head_pos()</span></code></a>,
respectively.</p>
</div>
<div class="section" id="visualizing-continuous-head-position">
<h2>Visualizing continuous head position<a class="headerlink" href="#visualizing-continuous-head-position" title="Permalink to this headline">¶</a></h2>
<p>We can plot as traces, which is especially useful for long recordings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_head_positions.html#mne.viz.plot_head_positions" title="mne.viz.plot_head_positions" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_head_positions</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;traces&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Position (mm), Rotation (quat)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_002.png" />
<p>Or we can visualize them as a continuous field (with the vectors pointing
in the head-upward direction):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_head_positions.html#mne.viz.plot_head_positions" title="mne.viz.plot_head_positions" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_head_positions</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot 59 head positions" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_59_head_positions_003.png" />
<p>These head positions can then be used with
<a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.preprocessing.maxwell_filter()</span></code></a> to compensate for movement,
or with <a class="reference internal" href="../../generated/mne.preprocessing.annotate_movement.html#mne.preprocessing.annotate_movement" title="mne.preprocessing.annotate_movement"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.preprocessing.annotate_movement()</span></code></a> to mark segments as
bad that deviate too much from the average head position.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  36.773 seconds)</p>
<p><strong>Estimated memory usage:</strong>  15 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-preprocessing-plot-59-head-positions-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4f4ac0e628d8f537de7f45bc3da419e1/plot_59_head_positions.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_59_head_positions.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7aed4bc8cd1643f9a23125c34f543ae6/plot_59_head_positions.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_59_head_positions.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


  
</div>

              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="plot_55_setting_eeg_reference.html" title="previous page">Setting the EEG reference</a>
    <a class='right-next' id="next-link" href="plot_60_maxwell_filtering_sss.html" title="next page">Signal-space separation (SSS) and Maxwell filtering</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.014cad6f3a039303089e.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-37225609-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
<footer class="footer mt-5 mt-md-0">
  <div class="container institutions">
    <div class="d-flex flex-wrap flex-row justify-content-center">
      <div class="m-2">
          <a href="https://www.massgeneral.org/">
            <img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://martinos.org/">
            <img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://hms.harvard.edu/">
            <img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://web.mit.edu/">
            <img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.nyu.edu/">
            <img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="http://www.cea.fr/">
            <img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://sci.aalto.fi/">
            <img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.telecom-paris.fr/">
            <img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.washington.edu/">
            <img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://icm-institute.org/">
            <img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.bu.edu/">
            <img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inserm.fr/">
            <img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.fz-juelich.de/">
            <img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.tu-ilmenau.de/">
            <img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://bids.berkeley.edu/">
            <img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inria.fr/">
            <img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.au.dk/">
            <img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.uni-graz.at/">
            <img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/>
          </a>
        </div>
      
    </div>
  </div>
  <p class="text-center text-muted small">&copy; Copyright 2012–2021, MNE Developers. Last updated <time datetime="2021-02-19T12:28:42.787072+00:00" class="localized">2021-02-19 12:28 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
</footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>