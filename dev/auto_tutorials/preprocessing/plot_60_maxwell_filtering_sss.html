<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Signal-space separation (SSS) and Maxwell filtering &#8212; MNE 0.21.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="d-block devbar alert alert-danger">
This documentation is for <strong>development version 0.21.dev0</strong>.
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.svg"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.21.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
            
            
            <li class="dropdown globaltoc-container">
              <a role="button" id="dLabelGlobalToc" data-toggle="dropdown" data-target="#" href="#">More<b class="caret"></b></a>
              <ul class="dropdown-menu globaltoc" role="menu" aria-labelledby="dLabelGlobalToc">
                <li><a href="https://github.com/mne-tools/mne-python"><i class="fa fa-github"></i> GitHub</a></li>
                <li><a href="../../overview/get_help.html"><i class="fa fa-question-circle"></i> Get help</a></li>
                <li><a href="../../install/contributing.html"><i class="fa fa-code-fork"></i> Contribute</a></li>
                <li><a href="../../overview/cite.html"><i class="fa fa-book"></i> Cite MNE</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown" style="margin-left: 10px">
              v0.21.dev0
              <span class="caret"></span>
            </button>
              <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
                <li><a href="https://mne-tools.github.io/stable/index.html">v0.20 (stable)</a></li>
                <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
              </ul>
            </li>

            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.svg" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Signal-space separation (SSS) and Maxwell filtering</a><ul>
<li><a class="reference internal" href="#background-on-sss-and-maxwell-filtering">Background on SSS and Maxwell filtering</a></li>
<li><a class="reference internal" href="#using-sss-and-maxwell-filtering-in-mne-python">Using SSS and Maxwell filtering in MNE-Python</a></li>
<li><a class="reference internal" href="#spatiotemporal-sss-tsss">Spatiotemporal SSS (tSSS)</a></li>
<li><a class="reference internal" href="#movement-compensation">Movement compensation</a></li>
<li><a class="reference internal" href="#caveats-to-using-sss-maxwell-filtering">Caveats to using SSS / Maxwell filtering</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-preprocessing-plot-60-maxwell-filtering-sss-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="signal-space-separation-sss-and-maxwell-filtering">
<span id="tut-artifact-sss"></span><span id="sphx-glr-auto-tutorials-preprocessing-plot-60-maxwell-filtering-sss-py"></span><h1>Signal-space separation (SSS) and Maxwell filtering<a class="headerlink" href="#signal-space-separation-sss-and-maxwell-filtering" title="Permalink to this headline">¶</a></h1>
<p>This tutorial covers reducing environmental noise and compensating for head
movement with SSS and Maxwell filtering.</p>
<div class="contents local topic" id="page-contents">
<p class="topic-title">Page contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#background-on-sss-and-maxwell-filtering" id="id5">Background on SSS and Maxwell filtering</a></p></li>
<li><p><a class="reference internal" href="#using-sss-and-maxwell-filtering-in-mne-python" id="id6">Using SSS and Maxwell filtering in MNE-Python</a></p></li>
<li><p><a class="reference internal" href="#spatiotemporal-sss-tsss" id="id7">Spatiotemporal SSS (tSSS)</a></p></li>
<li><p><a class="reference internal" href="#movement-compensation" id="id8">Movement compensation</a></p></li>
<li><p><a class="reference internal" href="#caveats-to-using-sss-maxwell-filtering" id="id9">Caveats to using SSS / Maxwell filtering</a></p></li>
<li><p><a class="reference internal" href="#references" id="id10">References</a></p></li>
</ul>
</div>
<p>As usual we’ll start by importing the modules we need, loading some
<a class="reference internal" href="../../overview/datasets_index.html#sample-dataset"><span class="std std-ref">example data</span></a>, and cropping it to save on memory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mne</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_raw_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_raw_file</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.crop" title="mne.io.Raw.crop" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">crop</span></a><span class="p">(</span><span class="n">tmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="background-on-sss-and-maxwell-filtering">
<h2><a class="toc-backref" href="#id5">Background on SSS and Maxwell filtering</a><a class="headerlink" href="#background-on-sss-and-maxwell-filtering" title="Permalink to this headline">¶</a></h2>
<p>Signal-space separation (SSS) <a class="footnote-reference brackets" href="#taulukajola2005" id="id1">1</a><a class="footnote-reference brackets" href="#taulusimola2006" id="id2">2</a>
is a technique based on the physics
of electromagnetic fields. SSS separates the measured signal into components
attributable to sources <em>inside</em> the measurement volume of the sensor array
(the <em>internal components</em>), and components attributable to sources <em>outside</em>
the measurement volume (the <em>external components</em>). The internal and external
components are linearly independent, so it is possible to simply discard the
external components to reduce environmental noise. <em>Maxwell filtering</em> is a
related procedure that omits the higher-order components of the internal
subspace, which are dominated by sensor noise. Typically, Maxwell filtering
and SSS are performed together (in MNE-Python they are implemented together
in a single function).</p>
<p>Like <a class="reference internal" href="plot_50_artifact_correction_ssp.html#tut-artifact-ssp"><span class="std std-ref">SSP</span></a>, SSS is a form of projection. Whereas SSP
empirically determines a noise subspace based on data (empty-room recordings,
EOG or ECG activity, etc) and projects the measurements onto a subspace
orthogonal to the noise, SSS mathematically constructs the external and
internal subspaces from <a class="reference external" href="https://en.wikipedia.org/wiki/Spherical_harmonics">spherical harmonics</a> and reconstructs the sensor
signals using only the internal subspace (i.e., does an oblique projection).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Maxwell filtering was originally developed for Elekta Neuromag® systems,
and should be considered <em>experimental</em> for non-Neuromag data. See the
Notes section of the <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a> docstring
for details.</p>
</div>
<p>The MNE-Python implementation of SSS / Maxwell filtering currently provides
the following features:</p>
<ul class="simple">
<li><p>Basic bad channel detection
(<a class="reference internal" href="../../generated/mne.preprocessing.find_bad_channels_maxwell.html#mne.preprocessing.find_bad_channels_maxwell" title="mne.preprocessing.find_bad_channels_maxwell"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_bad_channels_maxwell()</span></code></a>)</p></li>
<li><p>Bad channel reconstruction</p></li>
<li><p>Cross-talk cancellation</p></li>
<li><p>Fine calibration correction</p></li>
<li><p>tSSS</p></li>
<li><p>Coordinate frame translation</p></li>
<li><p>Regularization of internal components using information theory</p></li>
<li><p>Raw movement compensation (using head positions estimated by MaxFilter)</p></li>
<li><p>cHPI subtraction (see <a class="reference internal" href="../../generated/mne.chpi.filter_chpi.html#mne.chpi.filter_chpi" title="mne.chpi.filter_chpi"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.filter_chpi()</span></code></a>)</p></li>
<li><p>Handling of 3D (in addition to 1D) fine calibration files</p></li>
<li><p>Epoch-based movement compensation as described in
<a class="footnote-reference brackets" href="#taulukajola2005" id="id3">1</a> through <a class="reference internal" href="../../generated/mne.epochs.average_movements.html#mne.epochs.average_movements" title="mne.epochs.average_movements"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.epochs.average_movements()</span></code></a></p></li>
<li><p><strong>Experimental</strong> processing of data from (un-compensated) non-Elekta
systems</p></li>
</ul>
</div>
<div class="section" id="using-sss-and-maxwell-filtering-in-mne-python">
<h2><a class="toc-backref" href="#id6">Using SSS and Maxwell filtering in MNE-Python</a><a class="headerlink" href="#using-sss-and-maxwell-filtering-in-mne-python" title="Permalink to this headline">¶</a></h2>
<p>For optimal use of SSS with data from Elekta Neuromag® systems, you should
provide the path to the fine calibration file (which encodes site-specific
information about sensor orientation and calibration) as well as a crosstalk
compensation file (which reduces interference between Elekta’s co-located
magnetometer and paired gradiometer sensor units).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fine_cal_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a><span class="p">,</span> <span class="s1">&#39;SSS&#39;</span><span class="p">,</span> <span class="s1">&#39;sss_cal_mgh.dat&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crosstalk_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sample_data_folder</span></a><span class="p">,</span> <span class="s1">&#39;SSS&#39;</span><span class="p">,</span> <span class="s1">&#39;ct_sparse_mgh.fif&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Before we perform SSS we’ll look for bad channels — <code class="docutils literal notranslate"><span class="pre">MEG</span> <span class="pre">2443</span></code> is quite
noisy.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is critical to mark bad channels in <code class="docutils literal notranslate"><span class="pre">raw.info['bads']</span></code> <em>before</em>
calling <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a> in order to prevent
bad channel noise from spreading.</p>
</div>
<p>Let’s see if we can automatically detect it. To do this we need to
operate on a signal without line noise or cHPI signals, which is most
easily achieved using <a class="reference internal" href="../../generated/mne.chpi.filter_chpi.html#mne.chpi.filter_chpi" title="mne.chpi.filter_chpi"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.filter_chpi()</span></code></a>,
<a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw.notch_filter" title="mne.io.Raw.notch_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.io.Raw.notch_filter()</span></code></a>, or <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mne.io.Raw.filter()</span></code></a>. For simplicity
we just low-pass filter these data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_check</span></a> <span class="o">=</span> <a href="../../generated/mne.io.Raw.html#mne.io.Raw.copy" title="mne.io.Raw.copy" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">copy</span></a><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_noisy_chs</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_flat_chs</span></a> <span class="o">=</span> <a href="../../generated/mne.preprocessing.find_bad_channels_maxwell.html#mne.preprocessing.find_bad_channels_maxwell" title="mne.preprocessing.find_bad_channels_maxwell" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">find_bad_channels_maxwell</span></a><span class="p">(</span>
    <a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_check</span></a><span class="p">,</span> <span class="n">cross_talk</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crosstalk_file</span></a><span class="p">,</span> <span class="n">calibration</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fine_cal_file</span></a><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_noisy_chs</span></a><span class="p">)</span>  <span class="c1"># we should find them!</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_flat_chs</span></a><span class="p">)</span>  <span class="c1"># none for this dataset</span>
<a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_noisy_chs</span></a> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">auto_flat_chs</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Scanning for bad channels in 12 intervals (5.0 sec) ...
    No bad MEG channels
    Processing 204 gradiometers and 102 magnetometers
    Using fine calibration sss_cal_mgh.dat
        Adjusting non-orthogonal EX and EY
        Adjusted coil positions by (μ ± σ): 0.5° ± 0.4° (max: 2.1°)
    Automatic origin fit: head of radius 91.0 mm
    Using origin -4.1, 16.0, 51.7 mm in the head frame
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
    Static bad channels:  [&#39;MEG 2443&#39;]
    Static flat channels: []
[done]
[&#39;MEG 2443&#39;]
[]
</pre></div>
</div>
<p>But this algorithm is not perfect. For example, it misses <code class="docutils literal notranslate"><span class="pre">MEG</span> <span class="pre">2313</span></code>,
which has some flux jumps, because there are not enough flux jumps in the
recording. So it can still be useful to manually inspect and mark bad
channels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;MEG 2313&#39;</span><span class="p">]</span>  <span class="c1"># from manual inspection</span>
</pre></div>
</div>
<p>After that, performing SSS and Maxwell filtering is done with a
single call to <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a>, with the crosstalk
and fine calibration filenames provided (if available):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_sss</span></a> <span class="o">=</span> <a href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">maxwell_filter</span></a><span class="p">(</span>
    <a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">cross_talk</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">crosstalk_file</span></a><span class="p">,</span> <span class="n">calibration</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fine_cal_file</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Maxwell filtering raw data
    Bad MEG channels being reconstructed: [&#39;MEG 2443&#39;, &#39;MEG 2313&#39;]
    Processing 204 gradiometers and 102 magnetometers
    Using fine calibration sss_cal_mgh.dat
        Adjusting non-orthogonal EX and EY
        Adjusted coil positions by (μ ± σ): 0.5° ± 0.4° (max: 2.1°)
    Automatic origin fit: head of radius 91.0 mm
    Using origin -4.1, 16.0, 51.7 mm in the head frame
        Using 87/95 harmonic components for    0.000  (72/80 in, 15/15 out)
    Loading raw data from disk
    Processing 6 data chunks
[done]
</pre></div>
</div>
<p>To see the effect, we can plot the data before and after SSS / Maxwell
filtering.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.pick" title="mne.io.Raw.pick" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick</span></a><span class="p">([</span><span class="s1">&#39;meg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">butterfly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.pick" title="mne.io.Raw.pick" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw_sss</span><span class="o">.</span><span class="n">pick</span></a><span class="p">([</span><span class="s1">&#39;meg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">butterfly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="plot 60 maxwell filtering sss" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_60_maxwell_filtering_sss_001.png" />
</li>
<li><img alt="plot 60 maxwell filtering sss" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_60_maxwell_filtering_sss_002.png" />
</li>
</ul>
<p>Notice that channels marked as “bad” have been effectively repaired by SSS,
eliminating the need to perform <a class="reference internal" href="plot_15_handling_bad_channels.html#tut-bad-channels"><span class="std std-ref">interpolation</span></a>.
The heartbeat artifact has also been substantially reduced.</p>
<p>The <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a> function has parameters
<code class="docutils literal notranslate"><span class="pre">int_order</span></code> and <code class="docutils literal notranslate"><span class="pre">ext_order</span></code> for setting the order of the spherical
harmonic expansion of the interior and exterior components; the default
values are appropriate for most use cases. Additional parameters include
<code class="docutils literal notranslate"><span class="pre">coord_frame</span></code> and <code class="docutils literal notranslate"><span class="pre">origin</span></code> for controlling the coordinate frame (“head”
or “meg”) and the origin of the sphere; the defaults are appropriate for most
studies that include digitization of the scalp surface / electrodes. See the
documentation of <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a> for details.</p>
</div>
<div class="section" id="spatiotemporal-sss-tsss">
<h2><a class="toc-backref" href="#id7">Spatiotemporal SSS (tSSS)</a><a class="headerlink" href="#spatiotemporal-sss-tsss" title="Permalink to this headline">¶</a></h2>
<p>An assumption of SSS is that the measurement volume (the spherical shell
where the sensors are physically located) is free of electromagnetic sources.
The thickness of this source-free measurement shell should be 4-8 cm for SSS
to perform optimally. In practice, there may be sources falling within that
measurement volume; these can often be mitigated by using Spatiotemporal
Signal Space Separation (tSSS) <a class="footnote-reference brackets" href="#taulusimola2006" id="id4">2</a>.
tSSS works by looking for temporal
correlation between components of the internal and external subspaces, and
projecting out any components that are common to the internal and external
subspaces. The projection is done in an analogous way to
<a class="reference internal" href="plot_50_artifact_correction_ssp.html#tut-artifact-ssp"><span class="std std-ref">SSP</span></a>, except that the noise vector is computed
across time points instead of across sensors.</p>
<p>To use tSSS in MNE-Python, pass a time (in seconds) to the parameter
<code class="docutils literal notranslate"><span class="pre">st_duration</span></code> of <a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a>. This will
determine the “chunk duration” over which to compute the temporal projection.
The chunk duration effectively acts as a high-pass filter with a cutoff
frequency of <span class="math notranslate nohighlight">\(\frac{1}{\mathtt{st\_duration}}~\mathrm{Hz}\)</span>; this
effective high-pass has an important consequence:</p>
<ul class="simple">
<li><p>In general, larger values of <code class="docutils literal notranslate"><span class="pre">st_duration</span></code> are better (provided that your
computer has sufficient memory) because larger values of <code class="docutils literal notranslate"><span class="pre">st_duration</span></code>
will have a smaller effect on the signal.</p></li>
</ul>
<p>If the chunk duration does not evenly divide your data length, the final
(shorter) chunk will be added to the prior chunk before filtering, leading
to slightly different effective filtering for the combined chunk (the
effective cutoff frequency differing at most by a factor of 2). If you need
to ensure identical processing of all analyzed chunks, either:</p>
<ul class="simple">
<li><p>choose a chunk duration that evenly divides your data length (only
recommended if analyzing a single subject or run), or</p></li>
<li><p>include at least <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">st_duration</span></code> of post-experiment recording time at
the end of the <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw"><code class="xref py py-class docutils literal notranslate"><span class="pre">Raw</span></code></a> object, so that the data you intend to
further analyze is guaranteed not to be in the final or penultimate chunks.</p></li>
</ul>
<p>Additional parameters affecting tSSS include <code class="docutils literal notranslate"><span class="pre">st_correlation</span></code> (to set the
correlation value above which correlated internal and external components
will be projected out) and <code class="docutils literal notranslate"><span class="pre">st_only</span></code> (to apply only the temporal projection
without also performing SSS and Maxwell filtering). See the docstring of
<a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a> for details.</p>
</div>
<div class="section" id="movement-compensation">
<h2><a class="toc-backref" href="#id8">Movement compensation</a><a class="headerlink" href="#movement-compensation" title="Permalink to this headline">¶</a></h2>
<p>If you have information about subject head position relative to the sensors
(i.e., continuous head position indicator coils, or <a class="reference internal" href="../../glossary.html#term-HPI"><span class="xref std std-term">cHPI</span></a>), SSS
can take that into account when projecting sensor data onto the internal
subspace. Head position data can be computed using
<a class="reference internal" href="../../generated/mne.chpi.compute_chpi_locs.html#mne.chpi.compute_chpi_locs" title="mne.chpi.compute_chpi_locs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.compute_chpi_locs()</span></code></a> and <a class="reference internal" href="../../generated/mne.chpi.compute_head_pos.html#mne.chpi.compute_head_pos" title="mne.chpi.compute_head_pos"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.chpi.compute_head_pos()</span></code></a>,
or loaded with the:func:<a class="reference internal" href="../../generated/mne.chpi.read_head_pos.html#mne.chpi.read_head_pos" title="mne.chpi.read_head_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.chpi.read_head_pos</span></code></a> function. The
<a class="reference internal" href="../../overview/datasets_index.html#sample-dataset"><span class="std std-ref">example data</span></a> doesn’t include cHPI, so here we’ll
load a <code class="file docutils literal notranslate"><span class="pre">.pos</span></code> file used for testing, just to demonstrate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos_file</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">data_path</span><span class="p">(),</span> <span class="s1">&#39;SSS&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;test_move_anon_raw.pos&#39;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a> <span class="o">=</span> <a href="../../generated/mne.chpi.read_head_pos.html#mne.chpi.read_head_pos" title="mne.chpi.read_head_pos" class="sphx-glr-backref-module-mne-chpi sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">chpi</span><span class="o">.</span><span class="n">read_head_pos</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos_file</span></a><span class="p">)</span>
<a href="../../generated/mne.viz.plot_head_positions.html#mne.viz.plot_head_positions" title="mne.viz.plot_head_positions" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_head_positions</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_pos</span></a><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;traces&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Position (mm), Rotation (quat)" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_60_maxwell_filtering_sss_003.png" />
<p>The cHPI data file could also be passed as the <code class="docutils literal notranslate"><span class="pre">head_pos</span></code> parameter of
<a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a>. Not only would this account for
movement within a given recording session, but also would effectively
normalize head position across different measurement sessions and subjects.
See <a class="reference internal" href="../../auto_examples/preprocessing/plot_movement_compensation.html#example-movement-comp"><span class="std std-ref">here</span></a> for an extended example of applying
movement compensation during Maxwell filtering / SSS. Another option is to
apply movement compensation when averaging epochs into an
<a class="reference internal" href="../../generated/mne.Evoked.html#mne.Evoked" title="mne.Evoked"><code class="xref py py-class docutils literal notranslate"><span class="pre">Evoked</span></code></a> instance, using the <a class="reference internal" href="../../generated/mne.epochs.average_movements.html#mne.epochs.average_movements" title="mne.epochs.average_movements"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.epochs.average_movements()</span></code></a>
function.</p>
<p>Each of these approaches requires time-varying estimates of head position,
which is obtained from MaxFilter using the <code class="docutils literal notranslate"><span class="pre">-headpos</span></code> and <code class="docutils literal notranslate"><span class="pre">-hp</span></code>
arguments (see the MaxFilter manual for details).</p>
</div>
<div class="section" id="caveats-to-using-sss-maxwell-filtering">
<h2><a class="toc-backref" href="#id9">Caveats to using SSS / Maxwell filtering</a><a class="headerlink" href="#caveats-to-using-sss-maxwell-filtering" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>There are patents related to the Maxwell filtering algorithm, which may
legally preclude using it in commercial applications. More details are
provided in the documentation of
<a class="reference internal" href="../../generated/mne.preprocessing.maxwell_filter.html#mne.preprocessing.maxwell_filter" title="mne.preprocessing.maxwell_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwell_filter()</span></code></a>.</p></li>
<li><p>SSS works best when both magnetometers and gradiometers are present, and
is most effective when gradiometers are planar (due to the need for very
accurate sensor geometry and fine calibration information). Thus its
performance is dependent on the MEG system used to collect the data.</p></li>
</ol>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id10">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-footbibliography-auto_tutorials/preprocessing/plot_60_maxwell_filtering_sss-0"><dl class="footnote brackets">
<dt class="label" id="taulukajola2005"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Samu Taulu and Matti Kajola. Presentation of electromagnetic multichannel data: the signal space separation method. <em>Journal of Applied Physics</em>, 97(12):124905, 2005. <a class="reference external" href="https://doi.org/10.1063/1.1935742">doi:10.1063/1.1935742</a>.</p>
</dd>
<dt class="label" id="taulusimola2006"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Samu Taulu and Juha Simola. Spatiotemporal signal space separation method for rejecting nearby interference in MEG measurements. <em>Physics in Medicine and Biology</em>, 51(7):1759–1768, 2006. <a class="reference external" href="https://doi.org/10.1088/0031-9155/51/7/008">doi:10.1088/0031-9155/51/7/008</a>.</p>
</dd>
</dl>
</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  14.718 seconds)</p>
<p><strong>Estimated memory usage:</strong>  195 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-preprocessing-plot-60-maxwell-filtering-sss-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e96762cef64b72a796cf49772449fc35/plot_60_maxwell_filtering_sss.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_60_maxwell_filtering_sss.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/243172b1ef6a2d804d3245b8c0a927ef/plot_60_maxwell_filtering_sss.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_60_maxwell_filtering_sss.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container"><div class="row">
    <div class="container col-md-12 institutions">
      <ul class="list-unstyled">
        <li><a href="https://www.massgeneral.org/"><img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a></li>
        <li><a href="https://martinos.org/"><img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a></li>
        <li><a href="https://hms.harvard.edu/"><img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a></li>
        <li><a href="https://web.mit.edu/"><img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a></li>
        <li><a href="https://www.nyu.edu/"><img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a></li>
        <li><a href="http://www.cea.fr/"><img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a></li>
        <li><a href="https://sci.aalto.fi/"><img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a></li>
        <li><a href="https://www.telecom-paris.fr/"><img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a></li>
        <li><a href="https://www.washington.edu/"><img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a></li>
        <li><a href="https://icm-institute.org/"><img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a></li>
        <li><a href="https://www.bu.edu/"><img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a></li>
        <li><a href="https://www.inserm.fr/"><img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a></li>
        <li><a href="https://www.fz-juelich.de/"><img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a></li>
        <li><a href="https://www.tu-ilmenau.de/"><img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a></li>
        <li><a href="https://bids.berkeley.edu/"><img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a></li>
        <li><a href="https://www.inria.fr/"><img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a></li>
        <li><a href="https://www.au.dk/"><img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a></li>
        <li><a href="https://www.uni-graz.at/"><img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a></li>
      </ul>
      <p class="text-center text-muted small">&copy; Copyright 2012-2020, MNE Developers. Last updated on 2020-03-27.</p>
    </div></div></div>
  </footer>
  </body>
</html>