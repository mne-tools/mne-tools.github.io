
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Source alignment and coordinate frames &#8212; MNE 0.23.dev0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.951c8c8e3af89de180a2f03968e0e7cb.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
    <!-- add `style` or `link` tags with your CSS `@font-face` declarations here -->
    <!-- ... and a `style` tag with setting `font-family` in `body` and `.header-style` -->
    <!-- ... and optionally preload the `woff2` for snappier page loads -->
    <!-- or add a `style` tag with a font fallback chain with good cross-platform coverage -->
    <style>
        body,.header-style {font-family: 'Source Sans Pro', sans-serif;}
        code,kbd,pre,samp {font-family: 'Source Code Pro', monospace;}
    </style>

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-sans-pro.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-code-pro.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.014cad6f3a039303089e.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Visualize source time courses (stcs)" href="plot_visualize_stc.html" />
    <link rel="prev" title="The SourceEstimate data structure" href="plot_object_source_estimate.html" />
    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/scrollfix.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
    <a class="navbar-brand" href="../../index.html">
        
        <img src="../../_static/mne_logo_small.svg" class="logo" alt="logo" />
        
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-auto col-lg-9 collapse navbar-collapse">
        <ul id="navbar-main-elements" class="navbar-nav mr-auto">
            
            
            <li class="nav-item ">
                <a class="nav-link" href="../../install/index.html">Install</a>
            </li>
            
            <li class="nav-item active">
                <a class="nav-link" href="../../overview/index.html">Documentation</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../python_reference.html">API Reference</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/get_help.html">Get help</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/development.html">Development</a>
            </li>
            
            
        </ul>

        

        <ul class="navbar-nav">
            <!-- version dropdown -->
            <li class="mr-2 dropdown">
                <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
                    v0.23.dev0
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                    <li><a href="https://mne-tools.github.io/dev/index.html">v0.23 (devel)</a></li>
                    <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                    <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                    <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                    <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                    <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
                </ul>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="https://github.com/mne-tools/mne-python" target="_blank" rel="noopener">
                    <span><i class="fab fa-github-square"></i></span>
                </a>
            </li>
            
            
            <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/mne_python" target="_blank" rel="noopener">
                    <span><i class="fab fa-twitter-square"></i></span>
                </a>
            </li>
            
            <!-- discourse forum link -->
            <li class="nav-item">
                <a class="nav-link" href="https://mne.discourse.group" target="_blank" rel="noopener">
                    <span><i class="fab fa-discourse"></i></span>
                </a>
            </li>
        </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
      <li class="toctree-l2 current active">
 <a class="reference internal" href="../index.html">
  Tutorials
 </a>
 <ul class="current">
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_10_overview.html">
    Overview of MEG/EEG analysis with MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_20_events_from_raw.html">
    Parsing events from raw data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_30_info.html">
    The Info data structure
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_40_sensor_locations.html">
    Working with sensor locations
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_50_configure_mne.html">
    Configuring MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_10_reading_meg_data.html">
    Importing data from MEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_20_reading_eeg_data.html">
    Importing data from EEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_30_reading_fnirs_data.html">
    Importing data from fNIRS devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_10_raw_overview.html">
    The Raw data structure: continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_20_event_arrays.html">
    Working with events
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_30_annotate_raw.html">
    Annotating continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_40_visualize_raw.html">
    Built-in plotting methods for Raw objects
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_10_preprocessing_overview.html">
    Overview of artifact detection
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_15_handling_bad_channels.html">
    Interpolating bad channels
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_20_rejecting_bad_data.html">
    Rejecting bad data spans
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_30_filtering_resampling.html">
    Filtering and resampling data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_35_artifact_correction_regression.html">
    Repairing artifacts with regression
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_40_artifact_correction_ica.html">
    Repairing artifacts with ICA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_45_projectors_background.html">
    Background on projectors and projections
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_50_artifact_correction_ssp.html">
    Repairing artifacts with SSP
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_55_setting_eeg_reference.html">
    Setting the EEG reference
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_59_head_positions.html">
    Extracting and visualizing subject head movement
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_60_maxwell_filtering_sss.html">
    Signal-space separation (SSS) and Maxwell filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_70_fnirs_processing.html">
    Preprocessing functional near-infrared spectroscopy (fNIRS) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_10_epochs_overview.html">
    The Epochs data structure: discontinuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_20_visualize_epochs.html">
    Visualizing epoched data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_30_epochs_metadata.html">
    Working with Epoch metadata
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_40_epochs_to_data_frame.html">
    Exporting Epochs to Pandas DataFrames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_10_evoked_overview.html">
    The Evoked data structure: evoked/averaged data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_20_visualize_evoked.html">
    Visualizing Evoked data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_eeg_erp.html">
    EEG processing and Event Related Potentials (ERPs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_whitened.html">
    Plotting whitened data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../time-freq/plot_sensors_time_frequency.html">
    Frequency and time-frequency sensor analysis
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_background_freesurfer.html">
    FreeSurfer MRI reconstruction
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_background_freesurfer_mne.html">
    How MNE uses FreeSurfer’s outputs
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_beamformer_lcmv.html">
    Source reconstruction using an LCMV beamformer
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_compute_covariance.html">
    Computing a covariance matrix
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_dipole_fit.html">
    Source localization with equivalent current dipole (ECD) fit
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_dipole_orientations.html">
    The role of dipole orientations in distributed source localization
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_eeg_mri_coords.html">
    EEG source localization given electrode locations on an MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_eeg_no_mri.html">
    EEG forward operator with a template MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_fix_bem_in_blender.html">
    Editing BEM surfaces in Blender
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_forward.html">
    Head model and forward computation
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_mne_dspm_source_localization.html">
    Source localization with MNE/dSPM/sLORETA/eLORETA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_mne_solutions.html">
    Computing various MNE solutions
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_object_source_estimate.html">
    The
    <code class="xref py py-class docutils literal notranslate">
     <span class="pre">
      SourceEstimate
     </span>
    </code>
    data structure
   </a>
  </li>
  <li class="toctree-l3 current active">
   <a class="current reference internal" href="#">
    Source alignment and coordinate frames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_visualize_stc.html">
    Visualize source time courses (stcs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_1samp_test_time_frequency.html">
    Non-parametric 1 sample cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_erp.html">
    Visualising statistical significance thresholds on EEG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_time_frequency.html">
    Non-parametric between conditions cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_spatio_temporal_cluster_sensors.html">
    Spatiotemporal permutation F-test on full sensor data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal.html">
    Permutation t-test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_2samp.html">
    2 samples permutation test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_repeated_measures_anova.html">
    Repeated measures ANOVA on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_time_frequency_repeated_measures_anova.html">
    Mass-univariate twoway repeated measures ANOVA on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_receptive_field.html">
    Spectro-temporal receptive field (STRF) estimation on continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_sensors_decoding.html">
    Decoding (MVPA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_creating_data_structures.html">
    Creating MNE-Python data structures from scratch
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_dics.html">
    DICS for power mapping
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_point_spread.html">
    Corrupt known signal with point spread
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_auditory.html">
    Brainstorm auditory tutorial dataset
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_ctf.html">
    Brainstorm CTF phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_elekta.html">
    Brainstorm Elekta phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_phantom_4DBTi.html">
    4D Neuroimaging/BTi phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_sleep.html">
    Sleep stage classification from polysomnography (PSG) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_filtering.html">
    Background information on filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_ica.html">
    Background on Independent Component Analysis (ICA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_statistics.html">
    Statistical inference
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_ecog.html">
    Working with ECoG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_modifying_data_inplace.html">
    Modifying data in-place
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_report.html">
    Getting started with
    <code class="docutils literal notranslate">
     <span class="pre">
      mne.Report
     </span>
    </code>
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_seeg.html">
    Working with sEEG data
   </a>
  </li>
 </ul>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../auto_examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../glossary.html">
  Glossary
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/implementation.html">
  Implementation details
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/design_philosophy.html">
  Design philosophy
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/datasets_index.html">
  Example datasets
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../generated/commands.html">
  Command-line tools
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/migrating.html">
  Migrating from other analysis software
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cookbook.html">
  The typical M/EEG workflow
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cite.html">
  How to cite MNE-Python
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../cited.html">
  Papers citing MNE-Python
 </a>
</li>

    </ul>
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>



<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-coordinate-frames">
   Understanding coordinate frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coordinate-frame-definitions">
     Coordinate frame definitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-bad-example">
     A bad example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-good-example">
     A good example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-the-transformations">
   Visualizing the transformations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-mri-defacing">
     Example: MRI defacing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-headmri-trans-using-the-gui">
   Defining the head↔MRI
   <code class="docutils literal notranslate">
    <span class="pre">
     trans
    </span>
   </code>
   using the GUI
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alignment-without-mri">
   Alignment without MRI
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
<div>
  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-source-modeling-plot-source-alignment-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="source-alignment-and-coordinate-frames">
<span id="plot-source-alignment"></span><span id="sphx-glr-auto-tutorials-source-modeling-plot-source-alignment-py"></span><h1>Source alignment and coordinate frames<a class="headerlink" href="#source-alignment-and-coordinate-frames" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how to visually assess the spatial alignment of MEG sensor
locations, digitized scalp landmark and sensor locations, and MRI volumes. This
alignment process is crucial for computing the forward solution, as is
understanding the different coordinate frames involved in this process.</p>
<p>Let’s start out by loading some data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.io.constants</span> <span class="kn">import</span> <span class="n">FIFF</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trans_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;sample_audvis_raw-trans.fif&#39;</span><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <a href="../../generated/mne.read_trans.html#mne.read_trans" title="mne.read_trans" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_trans</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trans_fname</span></a><span class="p">)</span>
<a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a> <span class="o">=</span> <a href="../../generated/mne.read_source_spaces.html#mne.read_source_spaces" title="mne.read_source_spaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_source_spaces</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;bem&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;sample-oct-6-src.fif&#39;</span><span class="p">))</span>

<span class="c1"># Load the T1 file and change the header information to the correct units</span>
<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t1w</span></a> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;mri&#39;</span><span class="p">,</span> <span class="s1">&#39;T1.mgz&#39;</span><span class="p">))</span>
<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t1w</span></a> <span class="o">=</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class"><span class="n">nib</span><span class="o">.</span><span class="n">Nifti1Image</span></a><span class="p">(</span><a href="https://nipy.org/nibabel/reference/nibabel.dataobj_images.html#nibabel.dataobj_images.DataobjImage.dataobj" title="nibabel.dataobj_images.DataobjImage.dataobj" class="sphx-glr-backref-module-nibabel-dataobj_images sphx-glr-backref-type-py-method"><span class="n">t1w</span><span class="o">.</span><span class="n">dataobj</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.spatialimages.html#nibabel.spatialimages.SpatialImage.affine" title="nibabel.spatialimages.SpatialImage.affine" class="sphx-glr-backref-module-nibabel-spatialimages sphx-glr-backref-type-py-method"><span class="n">t1w</span><span class="o">.</span><span class="n">affine</span></a><span class="p">)</span>
<a href="https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.header" title="nibabel.filebasedimages.FileBasedImage.header" class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"><span class="n">t1w</span><span class="o">.</span><span class="n">header</span></a><span class="p">[</span><span class="s1">&#39;xyzt_units&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<a href="https://nipy.org/nibabel/reference/nibabel.freesurfer.html#nibabel.freesurfer.mghformat.MGHImage" title="nibabel.freesurfer.mghformat.MGHImage" class="sphx-glr-backref-module-nibabel-freesurfer-mghformat sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t1_mgh</span></a> <span class="o">=</span> <a href="https://nipy.org/nibabel/reference/nibabel.freesurfer.html#nibabel.freesurfer.mghformat.MGHImage" title="nibabel.freesurfer.mghformat.MGHImage" class="sphx-glr-backref-module-nibabel-freesurfer-mghformat sphx-glr-backref-type-py-class"><span class="n">nib</span><span class="o">.</span><span class="n">MGHImage</span></a><span class="p">(</span><a href="https://nipy.org/nibabel/reference/nibabel.dataobj_images.html#nibabel.dataobj_images.DataobjImage.dataobj" title="nibabel.dataobj_images.DataobjImage.dataobj" class="sphx-glr-backref-module-nibabel-dataobj_images sphx-glr-backref-type-py-method"><span class="n">t1w</span><span class="o">.</span><span class="n">dataobj</span></a><span class="p">,</span> <a href="https://nipy.org/nibabel/reference/nibabel.spatialimages.html#nibabel.spatialimages.SpatialImage.affine" title="nibabel.spatialimages.SpatialImage.affine" class="sphx-glr-backref-module-nibabel-spatialimages sphx-glr-backref-type-py-method"><span class="n">t1w</span><span class="o">.</span><span class="n">affine</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    Reading a source space...
    Computing patch statistics...
    Patch information added...
    Distance information added...
    [done]
    2 source spaces read
</pre></div>
</div>
<style>
.pink {color:DarkSalmon; font-weight:bold}
.blue {color:DeepSkyBlue; font-weight:bold}
.gray {color:Gray; font-weight:bold}
.magenta {color:Magenta; font-weight:bold}
.purple {color:Indigo; font-weight:bold}
.green {color:LimeGreen; font-weight:bold}
.red {color:Red; font-weight:bold}
</style><div class="section" id="understanding-coordinate-frames">
<h2>Understanding coordinate frames<a class="headerlink" href="#understanding-coordinate-frames" title="Permalink to this headline">¶</a></h2>
<p>For M/EEG source imaging, there are three <strong>coordinate frames</strong> must be
brought into alignment using two 3D <a class="reference external" href="https://en.wikipedia.org/wiki/Transformation_matrix">transformation matrices</a>
that define how to rotate and translate points in one coordinate frame
to their equivalent locations in another. The three main coordinate frames
are:</p>
<ul class="simple">
<li><p><span class="blue">“meg”</span>: the coordinate frame for the physical locations of MEG
sensors</p></li>
<li><p><span class="gray">“mri”</span>: the coordinate frame for MRI images, and scalp/skull/brain
surfaces derived from the MRI images</p></li>
<li><p><span class="pink">“head”</span>: the coordinate frame for digitized sensor locations and
scalp landmarks (“fiducials”)</p></li>
</ul>
<p>Each of these are described in more detail in the next section.</p>
<p>A good way to start visualizing these coordinate frames is to use the
<a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mne.viz.plot_alignment</span></code></a> function, which is used for creating or inspecting
the transformations that bring these coordinate frames into alignment, and
displaying the resulting alignment of EEG sensors, MEG sensors, brain
sources, and conductor models. If you provide <code class="docutils literal notranslate"><span class="pre">subjects_dir</span></code> and
<code class="docutils literal notranslate"><span class="pre">subject</span></code> parameters, the function automatically loads the subject’s
Freesurfer MRI surfaces. Important for our purposes, passing
<code class="docutils literal notranslate"><span class="pre">show_axes=True</span></code> to <a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_alignment</span></code></a> will draw the origin of each
coordinate frame in a different color, with axes indicated by different sized
arrows:</p>
<ul class="simple">
<li><p>shortest arrow: (<strong>R</strong>)ight / X</p></li>
<li><p>medium arrow: forward / (<strong>A</strong>)nterior / Y</p></li>
<li><p>longest arrow: up / (<strong>S</strong>)uperior / Z</p></li>
</ul>
<p>Note that all three coordinate systems are <strong>RAS</strong> coordinate frames and
hence are also <a class="reference external" href="https://en.wikipedia.org/wiki/Right-hand_rule">right-handed</a> coordinate systems. Finally, note that the
<code class="docutils literal notranslate"><span class="pre">coord_frame</span></code> parameter sets which coordinate frame the camera
should initially be aligned with. Let’s take a look:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_alignment</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                             <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">surfaces</span><span class="o">=</span><span class="s1">&#39;head-dense&#39;</span><span class="p">,</span>
                             <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="p">[],</span> <span class="n">meg</span><span class="o">=</span><span class="s1">&#39;sensors&#39;</span><span class="p">,</span>
                             <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;meg&#39;</span><span class="p">,</span> <span class="n">mri_fiducials</span><span class="o">=</span><span class="s1">&#39;estimated&#39;</span><span class="p">)</span>
<a href="../../generated/mne.viz.set_3d_view.html#mne.viz.set_3d_view" title="mne.viz.set_3d_view" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">set_3d_view</span></a><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">focalpoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance from head origin to MEG origin: </span><span class="si">%0.1f</span><span class="s1"> mm&#39;</span>
      <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.linalg.norm.html#numpy.linalg.norm" title="numpy.linalg.norm" class="sphx-glr-backref-module-numpy-linalg sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">][</span><span class="s1">&#39;trans&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance from head origin to MRI origin: </span><span class="si">%0.1f</span><span class="s1"> mm&#39;</span>
      <span class="o">%</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.linalg.norm.html#numpy.linalg.norm" title="numpy.linalg.norm" class="sphx-glr-backref-module-numpy-linalg sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span></a><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="s1">&#39;trans&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])))</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dists</span></a> <span class="o">=</span> <a href="../../generated/mne.dig_mri_distances.html#mne.dig_mri_distances" title="mne.dig_mri_distances" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">dig_mri_distances</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                              <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance from </span><span class="si">%s</span><span class="s1"> digitized points to head surface: </span><span class="si">%0.1f</span><span class="s1"> mm&#39;</span>
      <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dists</span></a><span class="p">),</span> <span class="mi">1000</span> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dists</span></a><span class="p">)))</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using lh.seghead for head surface.
Distance from head origin to MEG origin: 65.0 mm
Distance from head origin to MRI origin: 29.9 mm
Using surface from /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-head.fif.
Distance from 72 digitized points to head surface: 1.7 mm
</pre></div>
</div>
<div class="section" id="coordinate-frame-definitions">
<h3>Coordinate frame definitions<a class="headerlink" href="#coordinate-frame-definitions" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><dl>
<dt>Neuromag/Elekta/MEGIN head coordinate frame (“head”, <span class="pink">pink axes</span>)</dt><dd><p>The head coordinate frame is defined through the coordinates of
anatomical landmarks on the subject’s head: usually the Nasion (<a class="reference external" href="https://en.wikipedia.org/wiki/Nasion">NAS</a>),
and the left and right preauricular points (<a class="reference external" href="http://www.fieldtriptoolbox.org/faq/how_are_the_lpa_and_rpa_points_defined/#noqa:E501">LPA</a> and <a class="reference external" href="http://www.fieldtriptoolbox.org/faq/how_are_the_lpa_and_rpa_points_defined/#noqa:E501">RPA</a>).
Different MEG manufacturers may have different definitions of the head
coordinate frame. A good overview can be seen in the
<a class="reference external" href="http://www.fieldtriptoolbox.org/faq/how_are_the_different_head_and_mri_coordinate_systems_defined/#noqa:E501">FieldTrip FAQ on coordinate systems</a>.</p>
<p>For Neuromag/Elekta/MEGIN, the head coordinate frame is defined by the
intersection of</p>
<ol class="arabic simple">
<li><p>the line between the LPA (<span class="red">red sphere</span>) and RPA
(<span class="purple">purple sphere</span>), and</p></li>
<li><p>the line perpendicular to this LPA-RPA line one that goes through
the Nasion (<span class="green">green sphere</span>).</p></li>
</ol>
<p>The axes are oriented as <strong>X</strong> origin→RPA, <strong>Y</strong> origin→NAS,
<strong>Z</strong> origin→upward (orthogonal to X and Y).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The required 3D coordinates for defining the head coordinate
frame (NAS, LPA, RPA) are measured at a stage separate from
the MEG data recording. There exist numerous devices to
perform such measurements, usually called “digitizers”. For
example, see the devices by the company <a class="reference external" href="https://polhemus.com/scanning-digitizing/digitizing-products/">Polhemus</a>.</p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>MEG device coordinate frame (“meg”, <span class="blue">blue axes</span>)</dt><dd><p>The MEG device coordinate frame is defined by the respective MEG
manufacturers. All MEG data is acquired with respect to this coordinate
frame. To account for the anatomy and position of the subject’s head, we
use so-called head position indicator (HPI) coils. The HPI coils are
placed at known locations on the scalp of the subject and emit
high-frequency magnetic fields used to coregister the head coordinate
frame with the device coordinate frame.</p>
<p>From the Neuromag/Elekta/MEGIN user manual:</p>
<blockquote>
<div><p>The origin of the device coordinate system is located at the center
of the posterior spherical section of the helmet with X axis going
from left to right and Y axis pointing front. The Z axis is, again
normal to the plane with positive direction up.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The HPI coils are shown as <span class="magenta">magenta spheres</span>.
Coregistration happens at the beginning of the recording and
the head↔meg transformation matrix is stored in
<code class="docutils literal notranslate"><span class="pre">raw.info['dev_head_t']</span></code>.</p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>MRI coordinate frame (“mri”, <span class="gray">gray axes</span>)</dt><dd><p>Defined by Freesurfer, the “MRI surface RAS” coordinate frame has its
origin at the center of a 256×256×256 1mm anisotropic volume (though the
center may not correspond to the anatomical center of the subject’s
head).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We typically align the MRI coordinate frame to the head
coordinate frame through a
<a class="reference external" href="https://en.wikipedia.org/wiki/Transformation_matrix">rotation and translation matrix</a>,
that we refer to in MNE as <code class="docutils literal notranslate"><span class="pre">trans</span></code>.</p>
</div>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="a-bad-example">
<h3>A bad example<a class="headerlink" href="#a-bad-example" title="Permalink to this headline">¶</a></h3>
<p>Let’s try using <a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_alignment</span></code></a> with <code class="docutils literal notranslate"><span class="pre">trans=None</span></code>, which
(incorrectly!) equates the MRI and head coordinate frames.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_alignment</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="o">=</span><a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="p">,</span>
                       <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">surfaces</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;head-dense&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;meg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using lh.seghead for head surface.
Getting helmet for system 306m
</pre></div>
</div>
</div>
<div class="section" id="a-good-example">
<h3>A good example<a class="headerlink" href="#a-good-example" title="Permalink to this headline">¶</a></h3>
<p>Here is the same plot, this time with the <code class="docutils literal notranslate"><span class="pre">trans</span></code> properly defined
(using a precomputed transformation matrix).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_alignment</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
                       <a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="o">=</span><a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">surfaces</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;head-dense&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;meg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using lh.seghead for head surface.
Getting helmet for system 306m
</pre></div>
</div>
</div>
</div>
<div class="section" id="visualizing-the-transformations">
<h2>Visualizing the transformations<a class="headerlink" href="#visualizing-the-transformations" title="Permalink to this headline">¶</a></h2>
<p>Let’s visualize these coordinate frames using just the scalp surface; this
will make it easier to see their relative orientations. To do this we’ll
first load the Freesurfer scalp surface, then apply a few different
transforms to it. In addition to the three coordinate frames discussed above,
we’ll also show the “mri_voxel” coordinate frame. Unlike MRI Surface RAS,
“mri_voxel” has its origin in the corner of the volume (the left-most,
posterior-most coordinate on the inferior-most MRI slice) instead of at the
center of the volume. “mri_voxel” is also <strong>not</strong> an RAS coordinate system:
rather, its XYZ directions are based on the acquisition order of the T1 image
slices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># The head surface is stored in &quot;mri&quot; coordinate frame</span>
<span class="c1"># (origin at center of volume, units=mm)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_rr</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_tri</span></a> <span class="o">=</span> <a href="../../generated/mne.read_surface.html#mne.read_surface" title="mne.read_surface" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_surface</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;surf&#39;</span><span class="p">,</span> <span class="s1">&#39;lh.seghead&#39;</span><span class="p">))</span>

<span class="c1"># To put the scalp in the &quot;head&quot; coordinate frame, we apply the inverse of</span>
<span class="c1"># the precomputed `trans` (which maps head → mri)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mri_to_head</span></a> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="scipy.linalg.inv" class="sphx-glr-backref-module-scipy-linalg sphx-glr-backref-type-py-function"><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span></a><span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="s1">&#39;trans&#39;</span><span class="p">])</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_pts_in_head_coord</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mri_to_head</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_rr</span></a><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># To put the scalp in the &quot;meg&quot; coordinate frame, we use the inverse of</span>
<span class="c1"># raw.info[&#39;dev_head_t&#39;]</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_to_meg</span></a> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="scipy.linalg.inv" class="sphx-glr-backref-module-scipy-linalg sphx-glr-backref-type-py-function"><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span></a><span class="p">(</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">][</span><span class="s1">&#39;trans&#39;</span><span class="p">])</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_pts_in_meg_coord</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">head_to_meg</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_pts_in_head_coord</span></a><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># The &quot;mri_voxel&quot;→&quot;mri&quot; transform is embedded in the header of the T1 image</span>
<span class="c1"># file. We&#39;ll invert it and then apply it to the original `seghead_rr` points.</span>
<span class="c1"># No unit conversion necessary: this transform expects mm and the scalp surface</span>
<span class="c1"># is defined in mm.</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vox_to_mri</span></a> <span class="o">=</span> <a href="https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.header" title="nibabel.filebasedimages.FileBasedImage.header" class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"><span class="n">t1_mgh</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get_vox2ras_tkr</span></a><span class="p">()</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mri_to_vox</span></a> <span class="o">=</span> <a href="https://scipy.github.io/devdocs/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="scipy.linalg.inv" class="sphx-glr-backref-module-scipy-linalg sphx-glr-backref-type-py-function"><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vox_to_mri</span></a><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_points_in_vox</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mri_to_vox</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_rr</span></a><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we’ve transformed all the points, let’s plot them. We’ll use the
same colors used by <a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_alignment</span></code></a> and use <span class="green">green</span> for the
“mri_voxel” coordinate frame:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
    <span class="n">renderer</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="o">*</span><span class="n">points</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">triangles</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_tri</span></a><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                  <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">)</span>


<span class="n">renderer</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">create_3d_figure</span><span class="p">(</span>
    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seghead_rr</span></a><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_pts_in_meg_coord</span></a><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_pts_in_head_coord</span></a><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">)</span>
<span class="n">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_points_in_vox</span></a><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<a href="../../generated/mne.viz.set_3d_view.html#mne.viz.set_3d_view" title="mne.viz.set_3d_view" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">set_3d_view</span></a><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">renderer</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                    <span class="n">focalpoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">),</span> <span class="n">elevation</span><span class="o">=</span><span class="mi">105</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
<span class="n">renderer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_004.png" />
<p>The relative orientations of the coordinate frames can be inferred by
observing the direction of the subject’s nose. Notice also how the origin of
the <span class="green">mri_voxel</span> coordinate frame is in the corner of the volume
(above, behind, and to the left of the subject), whereas the other three
coordinate frames have their origin roughly in the center of the head.</p>
<div class="section" id="example-mri-defacing">
<h3>Example: MRI defacing<a class="headerlink" href="#example-mri-defacing" title="Permalink to this headline">¶</a></h3>
<p>For a real-world example of using these transforms, consider the task of
defacing the MRI to preserve subject anonymity. If you know the points in
the “head” coordinate frame (as you might if you’re basing the defacing on
digitized points) you would need to transform them into “mri” or “mri_voxel”
in order to apply the blurring or smoothing operations to the MRI surfaces or
images. Here’s what that would look like (we’ll use the nasion landmark as a
representative example):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the nasion</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dig&#39;</span><span class="p">]</span> <span class="k">if</span>
          <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">FIFF</span><span class="o">.</span><span class="n">FIFFV_POINT_CARDINAL</span> <span class="ow">and</span>
          <span class="n">p</span><span class="p">[</span><span class="s1">&#39;ident&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">FIFF</span><span class="o">.</span><span class="n">FIFFV_POINT_NASION</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion</span></a><span class="p">[</span><span class="s1">&#39;coord_frame&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">FIFF</span><span class="o">.</span><span class="n">FIFFV_COORD_HEAD</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion</span></a><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>  <span class="c1"># get just the XYZ values</span>

<span class="c1"># Transform it from head to MRI space (recall that `trans` is head → mri)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion_mri</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion</span></a><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Then transform to voxel space, after converting from meters to millimeters</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion_vox</span></a> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mri_to_vox</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion_mri</span></a> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Plot it to make sure the transforms worked</span>
<span class="n">renderer</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">create_3d_figure</span><span class="p">(</span>
    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">add_head</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalp_points_in_vox</span></a><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">renderer</span><span class="o">.</span><a href="../../generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="p">(</span><span class="n">center</span><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nasion_vox</span></a><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a href="../../generated/mne.viz.set_3d_view.html#mne.viz.set_3d_view" title="mne.viz.set_3d_view" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">set_3d_view</span></a><span class="p">(</span><span class="n">figure</span><span class="o">=</span><span class="n">renderer</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">600.</span><span class="p">,</span>
                    <span class="n">focalpoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">125.</span><span class="p">,</span> <span class="mf">250.</span><span class="p">),</span> <span class="n">elevation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
<span class="n">renderer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_005.png" />
</div>
</div>
<div class="section" id="defining-the-headmri-trans-using-the-gui">
<h2>Defining the head↔MRI <code class="docutils literal notranslate"><span class="pre">trans</span></code> using the GUI<a class="headerlink" href="#defining-the-headmri-trans-using-the-gui" title="Permalink to this headline">¶</a></h2>
<p>You can try creating the head↔MRI transform yourself using
<a class="reference internal" href="../../generated/mne.gui.coregistration.html#mne.gui.coregistration" title="mne.gui.coregistration"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.gui.coregistration()</span></code></a>.</p>
<ul>
<li><p>First you must load the digitization data from the raw file
(<code class="docutils literal notranslate"><span class="pre">Head</span> <span class="pre">Shape</span> <span class="pre">Source</span></code>). The MRI data is already loaded if you provide the
<code class="docutils literal notranslate"><span class="pre">subject</span></code> and <code class="docutils literal notranslate"><span class="pre">subjects_dir</span></code>. Toggle <code class="docutils literal notranslate"><span class="pre">Always</span> <span class="pre">Show</span> <span class="pre">Head</span> <span class="pre">Points</span></code> to see
the digitization points.</p></li>
<li><p>To set the landmarks, toggle <code class="docutils literal notranslate"><span class="pre">Edit</span></code> radio button in <code class="docutils literal notranslate"><span class="pre">MRI</span> <span class="pre">Fiducials</span></code>.</p></li>
<li><p>Set the landmarks by clicking the radio button (LPA, Nasion, RPA) and then
clicking the corresponding point in the image.</p></li>
<li><p>After doing this for all the landmarks, toggle <code class="docutils literal notranslate"><span class="pre">Lock</span></code> radio button. You
can omit outlier points, so that they don’t interfere with the finetuning.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can save the fiducials to a file and pass
<code class="docutils literal notranslate"><span class="pre">mri_fiducials=True</span></code> to plot them in
<a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.viz.plot_alignment()</span></code></a>. The fiducials are saved to the
subject’s bem folder by default.</p>
</div>
</li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Fit</span> <span class="pre">Head</span> <span class="pre">Shape</span></code>. This will align the digitization points to the
head surface. Sometimes the fitting algorithm doesn’t find the correct
alignment immediately. You can try first fitting using LPA/RPA or fiducials
and then align according to the digitization. You can also finetune
manually with the controls on the right side of the panel.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">As...</span></code> (lower right corner of the panel), set the filename
and read it with <a class="reference internal" href="../../generated/mne.read_trans.html#mne.read_trans" title="mne.read_trans"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.read_trans()</span></code></a>.</p></li>
</ul>
<p>For more information, see step by step instructions
<a class="reference external" href="https://www.slideshare.net/mne-python/mnepython-coregistration">in these slides</a>.
Uncomment the following line to align the data yourself.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># mne.gui.coregistration(subject=&#39;sample&#39;, subjects_dir=subjects_dir)</span>
</pre></div>
</div>
</div>
<div class="section" id="alignment-without-mri">
<span id="plot-source-alignment-without-mri"></span><h2>Alignment without MRI<a class="headerlink" href="#alignment-without-mri" title="Permalink to this headline">¶</a></h2>
<p>The surface alignments above are possible if you have the surfaces available
from Freesurfer. <a class="reference internal" href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.viz.plot_alignment()</span></code></a> automatically searches for
the correct surfaces from the provided <code class="docutils literal notranslate"><span class="pre">subjects_dir</span></code>. Another option is
to use a <a class="reference internal" href="../../overview/implementation.html#eeg-sphere-model"><span class="std std-ref">spherical conductor model</span></a>. It is
passed through <code class="docutils literal notranslate"><span class="pre">bem</span></code> parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a> <span class="o">=</span> <a href="../../generated/mne.make_sphere_model.html#mne.make_sphere_model" title="mne.make_sphere_model" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_sphere_model</span></a><span class="p">(</span><span class="n">info</span><span class="o">=</span><a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">head_radius</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a> <span class="o">=</span> <a href="../../generated/mne.setup_volume_source_space.html#mne.setup_volume_source_space" title="mne.setup_volume_source_space" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">setup_volume_source_space</span></a><span class="p">(</span><a href="../../generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="o">=</span><a href="../../generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_alignment</span></a><span class="p">(</span>
    <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="s1">&#39;projected&#39;</span><span class="p">,</span> <span class="n">bem</span><span class="o">=</span><a href="../../generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="p">,</span> <a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="o">=</span><a href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src</span></a><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">surfaces</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;brain&#39;</span><span class="p">,</span> <span class="s1">&#39;inner_skull&#39;</span><span class="p">,</span> <span class="s1">&#39;outer_skull&#39;</span><span class="p">,</span> <span class="s1">&#39;outer_skin&#39;</span><span class="p">],</span>
    <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;meg&#39;</span><span class="p">,</span> <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot source alignment" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_source_alignment_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitted sphere radius:         91.0 mm
Origin head coordinates:      -4.1 16.0 51.7 mm
Origin device coordinates:    1.4 17.8 -10.3 mm

Equiv. model fitting -&gt; RV = 0.00349028 %
mu1 = 0.944696    lambda1 = 0.137193
mu2 = 0.667458    lambda2 = 0.683737
mu3 = -0.26815    lambda3 = -0.0105603
Set up EEG sphere model with scalp radius    91.0 mm

Sphere                : origin at (-4.1 16.0 51.7) mm
              radius  : 81.9 mm
grid                  : 10.0 mm
mindist               : 5.0 mm

Setting up the sphere...
Surface CM = (  -4.1   16.0   51.7) mm
Surface fits inside a sphere with radius   81.9 mm
Surface extent:
    x =  -86.0 ...   77.8 mm
    y =  -65.9 ...   97.9 mm
    z =  -30.2 ...  133.7 mm
Grid extent:
    x =  -90.0 ...   80.0 mm
    y =  -70.0 ...  100.0 mm
    z =  -40.0 ...  140.0 mm
6156 sources before omitting any.
2300 sources after omitting infeasible sources not within 0.0 - 81.9 mm.
1904 sources remaining after excluding the sources outside the surface and less than    5.0 mm inside.
Adjusting the neighborhood info.
Source space : MRI voxel -&gt; MRI (surface RAS)
     0.010000  0.000000  0.000000     -90.00 mm
     0.000000  0.010000  0.000000     -70.00 mm
     0.000000  0.000000  0.010000     -40.00 mm
     0.000000  0.000000  0.000000       1.00
Getting helmet for system 306m
</pre></div>
</div>
<p>It is also possible to use <a class="reference internal" href="../../generated/mne.gui.coregistration.html#mne.gui.coregistration" title="mne.gui.coregistration"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.gui.coregistration()</span></code></a>
to warp a subject (usually <code class="docutils literal notranslate"><span class="pre">fsaverage</span></code>) to subject digitization data, see
<a class="reference external" href="https://www.slideshare.net/mne-python/mnepython-scale-mri">these slides</a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  19.450 seconds)</p>
<p><strong>Estimated memory usage:</strong>  110 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-source-modeling-plot-source-alignment-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4bd3132f565f8eeb8f92269a858f1f3f/plot_source_alignment.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_source_alignment.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ef89d1f7daeb4e357098461753c3af0f/plot_source_alignment.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_source_alignment.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


  
</div>

              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="plot_object_source_estimate.html" title="previous page">The <code class="xref py py-class docutils literal notranslate"><span class="pre">SourceEstimate</span></code> data structure</a>
    <a class='right-next' id="next-link" href="plot_visualize_stc.html" title="next page">Visualize source time courses (stcs)</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.014cad6f3a039303089e.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-37225609-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
<footer class="footer mt-5 mt-md-0">
  <div class="container institutions">
    <div class="d-flex flex-wrap flex-row justify-content-center">
      <div class="m-2">
          <a href="https://www.massgeneral.org/">
            <img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://martinos.org/">
            <img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://hms.harvard.edu/">
            <img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://web.mit.edu/">
            <img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.nyu.edu/">
            <img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="http://www.cea.fr/">
            <img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://sci.aalto.fi/">
            <img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.telecom-paris.fr/">
            <img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.washington.edu/">
            <img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://icm-institute.org/">
            <img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.bu.edu/">
            <img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inserm.fr/">
            <img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.fz-juelich.de/">
            <img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.tu-ilmenau.de/">
            <img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://bids.berkeley.edu/">
            <img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inria.fr/">
            <img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.au.dk/">
            <img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.uni-graz.at/">
            <img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/>
          </a>
        </div>
      
    </div>
  </div>
  <p class="text-center text-muted small">&copy; Copyright 2012–2021, MNE Developers. Last updated <time datetime="2021-02-22T13:16:56.989265+00:00" class="localized">2021-02-22 13:16 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
</footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>