
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EEG source localization given electrode locations on an MRI &#8212; MNE 0.23.dev0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.951c8c8e3af89de180a2f03968e0e7cb.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
    <!-- add `style` or `link` tags with your CSS `@font-face` declarations here -->
    <!-- ... and a `style` tag with setting `font-family` in `body` and `.header-style` -->
    <!-- ... and optionally preload the `woff2` for snappier page loads -->
    <!-- or add a `style` tag with a font fallback chain with good cross-platform coverage -->
    <style>
        body,.header-style {font-family: 'Source Sans Pro', sans-serif;}
        code,kbd,pre,samp {font-family: 'Source Code Pro', monospace;}
    </style>

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-sans-pro.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-source-code-pro.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.014cad6f3a039303089e.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bootstrap_divs.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="EEG forward operator with a template MRI" href="plot_eeg_no_mri.html" />
    <link rel="prev" title="The role of dipole orientations in distributed source localization" href="plot_dipole_orientations.html" />
    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/scrollfix.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
  
    <div class="container-fluid alert-danger devbar">
      <div class="row no-gutters">
        <div class="col-12 text-center">
          This is documentation for the <em>unstable development version</em> of MNE-Python. <a class="alert-link" href="https://mne.tools/stable">Click here</a> to switch to the stable version.
        </div>
      </div>
    </div>
  

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
    <a class="navbar-brand" href="../../index.html">
        
        <img src="../../_static/mne_logo_small.svg" class="logo" alt="logo" />
        
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-auto col-lg-9 collapse navbar-collapse">
        <ul id="navbar-main-elements" class="navbar-nav mr-auto">
            
            
            <li class="nav-item ">
                <a class="nav-link" href="../../install/index.html">Install</a>
            </li>
            
            <li class="nav-item active">
                <a class="nav-link" href="../../overview/index.html">Documentation</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../python_reference.html">API Reference</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/get_help.html">Get help</a>
            </li>
            
            <li class="nav-item ">
                <a class="nav-link" href="../../overview/development.html">Development</a>
            </li>
            
            
        </ul>

        

        <ul class="navbar-nav">
            <!-- version dropdown -->
            <li class="mr-2 dropdown">
                <button type="button" class="btn btn-danger btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
                    v0.23.dev0
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dLabelMore">
                    <li><a href="https://mne-tools.github.io/dev/index.html">v0.23 (devel)</a></li>
                    <li><a href="https://mne-tools.github.io/stable/index.html">v0.22 (stable)</a></li>
                    <li><a href="https://mne-tools.github.io/0.21/index.html">v0.21</a></li>
                    <li><a href="https://mne-tools.github.io/0.20/index.html">v0.20</a></li>
                    <li><a href="https://mne-tools.github.io/0.19/index.html">v0.19</a></li>
                    <li><a href="https://mne-tools.github.io/0.18/index.html">v0.18</a></li>
                    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
                    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
                    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
                    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
                    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
                    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
                    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
                </ul>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="https://github.com/mne-tools/mne-python" target="_blank" rel="noopener">
                    <span><i class="fab fa-github-square"></i></span>
                </a>
            </li>
            
            
            <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/mne_python" target="_blank" rel="noopener">
                    <span><i class="fab fa-twitter-square"></i></span>
                </a>
            </li>
            
            <!-- discourse forum link -->
            <li class="nav-item">
                <a class="nav-link" href="https://mne.discourse.group" target="_blank" rel="noopener">
                    <span><i class="fab fa-discourse"></i></span>
                </a>
            </li>
        </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
      <li class="toctree-l2 current active">
 <a class="reference internal" href="../index.html">
  Tutorials
 </a>
 <ul class="current">
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_10_overview.html">
    Overview of MEG/EEG analysis with MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_20_events_from_raw.html">
    Parsing events from raw data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_30_info.html">
    The Info data structure
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_40_sensor_locations.html">
    Working with sensor locations
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../intro/plot_50_configure_mne.html">
    Configuring MNE-Python
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_10_reading_meg_data.html">
    Importing data from MEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_20_reading_eeg_data.html">
    Importing data from EEG devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../io/plot_30_reading_fnirs_data.html">
    Importing data from fNIRS devices
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_10_raw_overview.html">
    The Raw data structure: continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_20_event_arrays.html">
    Working with events
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_30_annotate_raw.html">
    Annotating continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../raw/plot_40_visualize_raw.html">
    Built-in plotting methods for Raw objects
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_10_preprocessing_overview.html">
    Overview of artifact detection
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_15_handling_bad_channels.html">
    Interpolating bad channels
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_20_rejecting_bad_data.html">
    Rejecting bad data spans
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_30_filtering_resampling.html">
    Filtering and resampling data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_35_artifact_correction_regression.html">
    Repairing artifacts with regression
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_40_artifact_correction_ica.html">
    Repairing artifacts with ICA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_45_projectors_background.html">
    Background on projectors and projections
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_50_artifact_correction_ssp.html">
    Repairing artifacts with SSP
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_55_setting_eeg_reference.html">
    Setting the EEG reference
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_59_head_positions.html">
    Extracting and visualizing subject head movement
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_60_maxwell_filtering_sss.html">
    Signal-space separation (SSS) and Maxwell filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../preprocessing/plot_70_fnirs_processing.html">
    Preprocessing functional near-infrared spectroscopy (fNIRS) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_10_epochs_overview.html">
    The Epochs data structure: discontinuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_20_visualize_epochs.html">
    Visualizing epoched data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_30_epochs_metadata.html">
    Working with Epoch metadata
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../epochs/plot_40_epochs_to_data_frame.html">
    Exporting Epochs to Pandas DataFrames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_10_evoked_overview.html">
    The Evoked data structure: evoked/averaged data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_20_visualize_evoked.html">
    Visualizing Evoked data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_eeg_erp.html">
    EEG processing and Event Related Potentials (ERPs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../evoked/plot_whitened.html">
    Plotting whitened data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../time-freq/plot_sensors_time_frequency.html">
    Frequency and time-frequency sensor analysis
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_background_freesurfer.html">
    FreeSurfer MRI reconstruction
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_background_freesurfer_mne.html">
    How MNE uses FreeSurfer’s outputs
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_beamformer_lcmv.html">
    Source reconstruction using an LCMV beamformer
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_compute_covariance.html">
    Computing a covariance matrix
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_dipole_fit.html">
    Source localization with equivalent current dipole (ECD) fit
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_dipole_orientations.html">
    The role of dipole orientations in distributed source localization
   </a>
  </li>
  <li class="toctree-l3 current active">
   <a class="current reference internal" href="#">
    EEG source localization given electrode locations on an MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_eeg_no_mri.html">
    EEG forward operator with a template MRI
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_fix_bem_in_blender.html">
    Editing BEM surfaces in Blender
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_forward.html">
    Head model and forward computation
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_mne_dspm_source_localization.html">
    Source localization with MNE/dSPM/sLORETA/eLORETA
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_mne_solutions.html">
    Computing various MNE solutions
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_object_source_estimate.html">
    The
    <code class="xref py py-class docutils literal notranslate">
     <span class="pre">
      SourceEstimate
     </span>
    </code>
    data structure
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_source_alignment.html">
    Source alignment and coordinate frames
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="plot_visualize_stc.html">
    Visualize source time courses (stcs)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_1samp_test_time_frequency.html">
    Non-parametric 1 sample cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_erp.html">
    Visualising statistical significance thresholds on EEG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_cluster_time_frequency.html">
    Non-parametric between conditions cluster statistic on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-sensor-space/plot_stats_spatio_temporal_cluster_sensors.html">
    Spatiotemporal permutation F-test on full sensor data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal.html">
    Permutation t-test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_2samp.html">
    2 samples permutation test on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_spatio_temporal_repeated_measures_anova.html">
    Repeated measures ANOVA on source data with spatio-temporal clustering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../stats-source-space/plot_stats_cluster_time_frequency_repeated_measures_anova.html">
    Mass-univariate twoway repeated measures ANOVA on single trial power
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_receptive_field.html">
    Spectro-temporal receptive field (STRF) estimation on continuous data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../machine-learning/plot_sensors_decoding.html">
    Decoding (MVPA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_creating_data_structures.html">
    Creating MNE-Python data structures from scratch
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_dics.html">
    DICS for power mapping
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../simulation/plot_point_spread.html">
    Corrupt known signal with point spread
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_auditory.html">
    Brainstorm auditory tutorial dataset
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_ctf.html">
    Brainstorm CTF phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_brainstorm_phantom_elekta.html">
    Brainstorm Elekta phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_phantom_4DBTi.html">
    4D Neuroimaging/BTi phantom dataset tutorial
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../sample-datasets/plot_sleep.html">
    Sleep stage classification from polysomnography (PSG) data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_filtering.html">
    Background information on filtering
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_ica.html">
    Background on Independent Component Analysis (ICA)
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../discussions/plot_background_statistics.html">
    Statistical inference
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_ecog.html">
    Working with ECoG data
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_modifying_data_inplace.html">
    Modifying data in-place
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_report.html">
    Getting started with
    <code class="docutils literal notranslate">
     <span class="pre">
      mne.Report
     </span>
    </code>
   </a>
  </li>
  <li class="toctree-l3">
   <a class="reference internal" href="../misc/plot_seeg.html">
    Working with sEEG data
   </a>
  </li>
 </ul>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../auto_examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../glossary.html">
  Glossary
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/implementation.html">
  Implementation details
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/design_philosophy.html">
  Design philosophy
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/datasets_index.html">
  Example datasets
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../generated/commands.html">
  Command-line tools
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/migrating.html">
  Migrating from other analysis software
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cookbook.html">
  The typical M/EEG workflow
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../overview/cite.html">
  How to cite MNE-Python
 </a>
</li>

<li class="toctree-l2">
 <a class="reference internal" href="../../cited.html">
  Papers citing MNE-Python
 </a>
</li>

    </ul>
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>



<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-the-mri">
   Visualizing the MRI
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-our-mri-voxel-eeg-locations-to-head-and-mri-surface-ras-coords">
   Getting our MRI voxel EEG locations to head (and MRI surface RAS) coords
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-a-source-estimate">
   Getting a source estimate
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
<div>
  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-source-modeling-plot-eeg-mri-coords-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="eeg-source-localization-given-electrode-locations-on-an-mri">
<span id="tut-eeg-mri-coords"></span><span id="sphx-glr-auto-tutorials-source-modeling-plot-eeg-mri-coords-py"></span><h1>EEG source localization given electrode locations on an MRI<a class="headerlink" href="#eeg-source-localization-given-electrode-locations-on-an-mri" title="Permalink to this headline">¶</a></h1>
<p>This tutorial explains how to compute the forward operator from EEG data
when the electrodes are in MRI voxel coordinates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD Style.</span>

<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>

<span class="kn">import</span> <span class="nn">nibabel</span>
<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="kn">import</span> <a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="nilearn.plotting.plot_glass_brain" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plot_glass_brain</span></a>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.channels</span> <span class="kn">import</span> <a href="../../generated/mne.channels.compute_native_head_t.html#mne.channels.compute_native_head_t" title="mne.channels.compute_native_head_t" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">compute_native_head_t</span></a><span class="p">,</span> <a href="../../generated/mne.channels.read_custom_montage.html#mne.channels.read_custom_montage" title="mne.channels.read_custom_montage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">read_custom_montage</span></a>
<span class="kn">from</span> <span class="nn">mne.viz</span> <span class="kn">import</span> <a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">plot_alignment</span></a>
</pre></div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>For this we will assume that you have:</p>
<ul class="simple">
<li><p>raw EEG data</p></li>
<li><p>your subject’s MRI reconstrcted using FreeSurfer</p></li>
<li><p>an appropriate boundary element model (BEM)</p></li>
<li><p>an appropriate source space (src)</p></li>
<li><p>your EEG electrodes in Freesurfer surface RAS coordinates, stored
in one of the formats <a class="reference internal" href="../../generated/mne.channels.read_custom_montage.html#mne.channels.read_custom_montage" title="mne.channels.read_custom_montage"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.channels.read_custom_montage()</span></code></a> supports</p></li>
</ul>
<p>Let’s set the paths to these files for the <code class="docutils literal notranslate"><span class="pre">sample</span></code> dataset, including
a modified <code class="docutils literal notranslate"><span class="pre">sample</span></code> MRI showing the electrode locations plus a <code class="docutils literal notranslate"><span class="pre">.elc</span></code>
file corresponding to the points in MRI coords (these were <a class="reference external" href="https://gist.github.com/larsoner/0ac6fad57e31cb2d9caa77350a9ff366">synthesized</a>,
and thus are stored as part of the <code class="docutils literal notranslate"><span class="pre">misc</span></code> dataset).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;subjects&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_audvis_raw.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;bem&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_bem</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample-5120-5120-5120-bem-sol.fif&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_src</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem_dir</span></a><span class="p">,</span> <span class="s1">&#39;sample-oct-6-src.fif&#39;</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">misc_path</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.misc.data_path.html#mne.datasets.misc.data_path" title="mne.datasets.misc.data_path" class="sphx-glr-backref-module-mne-datasets-misc sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_T1_electrodes</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">misc_path</span></a><span class="p">,</span> <span class="s1">&#39;sample_eeg_mri&#39;</span><span class="p">,</span> <span class="s1">&#39;T1_electrodes.mgz&#39;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_mon</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">misc_path</span></a><span class="p">,</span> <span class="s1">&#39;sample_eeg_mri&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_mri_montage.elc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualizing-the-mri">
<h2>Visualizing the MRI<a class="headerlink" href="#visualizing-the-mri" title="Permalink to this headline">¶</a></h2>
<p>Let’s take our MRI-with-eeg-locations and adjust the affine to put the data
in MNI space, and plot using <a class="reference external" href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="(in Nilearn)"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.plotting.plot_glass_brain()</span></code></a>,
which does a maximum intensity projection (easy to see the fake electrodes).
This plotting function requires data to be in MNI space.
Because <code class="docutils literal notranslate"><span class="pre">img.affine</span></code> gives the voxel-to-world (RAS) mapping, if we apply a
RAS-to-MNI transform to it, it becomes the voxel-to-MNI transformation we
need. Thus we create a “new” MRI image in MNI coordinates and plot it as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://nipy.org/nibabel/reference/nibabel.freesurfer.html#nibabel.freesurfer.mghformat.MGHImage" title="nibabel.freesurfer.mghformat.MGHImage" class="sphx-glr-backref-module-nibabel-freesurfer-mghformat sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a> <span class="o">=</span> <span class="n">nibabel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_T1_electrodes</span></a><span class="p">)</span>  <span class="c1"># original subject MRI w/EEG</span>
<span class="n">ras_mni_t</span> <span class="o">=</span> <a href="../../generated/mne.transforms.read_ras_mni_t.html#mne.transforms.read_ras_mni_t" title="mne.transforms.read_ras_mni_t" class="sphx-glr-backref-module-mne-transforms sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">read_ras_mni_t</span></a><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">)</span>  <span class="c1"># from FS</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mni_affine</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.dot.html#numpy.dot" title="numpy.dot" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">dot</span></a><span class="p">(</span><span class="n">ras_mni_t</span><span class="p">[</span><span class="s1">&#39;trans&#39;</span><span class="p">],</span> <a href="https://nipy.org/nibabel/reference/nibabel.spatialimages.html#nibabel.spatialimages.SpatialImage.affine" title="nibabel.spatialimages.SpatialImage.affine" class="sphx-glr-backref-module-nibabel-spatialimages sphx-glr-backref-type-py-method"><span class="n">img</span><span class="o">.</span><span class="n">affine</span></a><span class="p">)</span>  <span class="c1"># vox-&gt;ras-&gt;MNI</span>
<a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img_mni</span></a> <span class="o">=</span> <a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class"><span class="n">nibabel</span><span class="o">.</span><span class="n">Nifti1Image</span></a><span class="p">(</span><a href="https://nipy.org/nibabel/reference/nibabel.dataobj_images.html#nibabel.dataobj_images.DataobjImage.dataobj" title="nibabel.dataobj_images.DataobjImage.dataobj" class="sphx-glr-backref-module-nibabel-dataobj_images sphx-glr-backref-type-py-method"><span class="n">img</span><span class="o">.</span><span class="n">dataobj</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mni_affine</span></a><span class="p">)</span>  <span class="c1"># now in MNI coords!</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="nilearn.plotting.plot_glass_brain" class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"><span class="n">plot_glass_brain</span></a><span class="p">(</span><a href="https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image" title="nibabel.nifti1.Nifti1Image" class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img_mni</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot_black_bone&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">resampling_interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot eeg mri coords" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_001.png" />
</div>
<div class="section" id="getting-our-mri-voxel-eeg-locations-to-head-and-mri-surface-ras-coords">
<h2>Getting our MRI voxel EEG locations to head (and MRI surface RAS) coords<a class="headerlink" href="#getting-our-mri-voxel-eeg-locations-to-head-and-mri-surface-ras-coords" title="Permalink to this headline">¶</a></h2>
<p>Let’s load our <a class="reference internal" href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage"><code class="xref py py-class docutils literal notranslate"><span class="pre">DigMontage</span></code></a> using
<a class="reference internal" href="../../generated/mne.channels.read_custom_montage.html#mne.channels.read_custom_montage" title="mne.channels.read_custom_montage"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.channels.read_custom_montage()</span></code></a>, making note of the fact that
we stored our locations in Freesurfer surface RAS (MRI) coordinates.</p>
<div class="card card-info">
<h5 class="card-header">
<a data-toggle="collapse" href="#collapse_question-what-if-my-electrodes-are-in-mri-voxels" role="button" aria-expanded="false" aria-controls="collapse_question-what-if-my-electrodes-are-in-mri-voxels"><i class="fas fa-question"></i> What if my electrodes are in MRI voxels?</a></h5>
<div id="collapse_question-what-if-my-electrodes-are-in-mri-voxels" class="collapse">
<div class="card card-body"><p>If you have voxel coordinates in MRI voxels, you can transform these to
FreeSurfer surface RAS (called “mri” in MNE) coordinates using the
transformations that FreeSurfer computes during reconstruction.
<code class="docutils literal notranslate"><span class="pre">nibabel</span></code> calls this transformation the <code class="docutils literal notranslate"><span class="pre">vox2ras_tkr</span></code> transform
and operates in millimeters, so we can load it, convert it to meters,
and then apply it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_vox</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># loaded from a file somehow</span>
<span class="gp">&gt;&gt;&gt; </span><a href="https://nipy.org/nibabel/reference/nibabel.freesurfer.html#nibabel.freesurfer.mghformat.MGHImage" title="nibabel.freesurfer.mghformat.MGHImage" class="sphx-glr-backref-module-nibabel-freesurfer-mghformat sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a> <span class="o">=</span> <span class="n">nibabel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname_T1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vox2mri_t</span> <span class="o">=</span> <a href="https://nipy.org/nibabel/reference/nibabel.freesurfer.html#nibabel.freesurfer.mghformat.MGHImage" title="nibabel.freesurfer.mghformat.MGHImage" class="sphx-glr-backref-module-nibabel-freesurfer-mghformat sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img</span></a><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get_vox2ras_tkr</span><span class="p">()</span>  <span class="c1"># voxel -&gt; mri trans</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_mri</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">apply_trans</span><span class="p">(</span><span class="n">vox2mri_t</span><span class="p">,</span> <span class="n">pos_vox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_mri</span> <span class="o">/=</span> <span class="mf">1000.</span>  <span class="c1"># mm -&gt; m</span>
</pre></div>
</div>
<p>You can also verify that these are correct (or manually convert voxels
to MRI coords) by looking at the points in Freeview or tkmedit.</p>
</div></div></div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span></a> <span class="o">=</span> <a href="../../generated/mne.channels.read_custom_montage.html#mne.channels.read_custom_montage" title="mne.channels.read_custom_montage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">read_custom_montage</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_mon</span></a><span class="p">,</span> <span class="n">head_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coord_frame</span><span class="o">=</span><span class="s1">&#39;mri&#39;</span><span class="p">)</span>
<a href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage.plot" title="mne.channels.DigMontage.plot" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-method"><span class="n">dig_montage</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="plot eeg mri coords" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Creating RawArray with float64 data, n_channels=61, n_times=1
    Range : 0 ... 0 =      0.000 ...     0.000 secs
Ready.
</pre></div>
</div>
<p>We can then get our transformation from the MRI coordinate frame (where our
points are defined) to the head coordinate frame from the object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trans</span> <span class="o">=</span> <a href="../../generated/mne.channels.compute_native_head_t.html#mne.channels.compute_native_head_t" title="mne.channels.compute_native_head_t" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">compute_native_head_t</span></a><span class="p">(</span><a href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>  <span class="c1"># should be mri-&gt;head, as the &quot;native&quot; space here is MRI</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Transform | MRI (surface RAS)-&gt;head&gt;
[[ 0.99930957  0.00998471 -0.03578661 -0.00316747]
 [ 0.01275917  0.81240435  0.58295487  0.00685511]
 [ 0.03489383 -0.58300899  0.81171605  0.02888406]
 [ 0.          0.          0.          1.        ]]
</pre></div>
</div>
<p>Let’s apply this digitization to our dataset, and in the process
automatically convert our locations to the head coordinate frame, as
shown by <a class="reference internal" href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_sensors" title="mne.io.Raw.plot_sensors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_sensors()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="../../generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_raw</span></a><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.set_montage" title="mne.io.Raw.set_montage" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_montage</span></a><span class="p">(</span><a href="../../generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span></a><span class="p">)</span>
<a href="../../generated/mne.io.Raw.html#mne.io.Raw.plot_sensors" title="mne.io.Raw.plot_sensors" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">plot_sensors</span></a><span class="p">(</span><span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot eeg mri coords" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-sample-data/MEG/sample/sample_audvis_raw.fif...
    Read a total of 3 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
    Range : 25800 ... 192599 =     42.956 ...   320.670 secs
Ready.
Removing projector &lt;Projection | PCA-v1, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : False, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : False, n_channels : 102&gt;
Reading 0 ... 166799  =      0.000 ...   277.714 secs...
</pre></div>
</div>
<p>Now we can do standard sensor-space operations like make joint plots of
evoked data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.io.Raw.html#mne.io.Raw.set_eeg_reference" title="mne.io.Raw.set_eeg_reference" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="../../generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>
<a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="../../generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">)</span>
<a href="../../generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov</span></a> <span class="o">=</span> <a href="../../generated/mne.compute_covariance.html#mne.compute_covariance" title="mne.compute_covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">compute_covariance</span></a><span class="p">(</span><a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a> <span class="o">=</span> <a href="../../generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>  <span class="c1"># trigger 1 in auditory/left</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray.plot_joint" title="mne.EvokedArray.plot_joint" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">evoked</span><span class="o">.</span><span class="n">plot_joint</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="0.093 s, 0.206 s, 0.448 s" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Adding average EEG reference projection.
1 projection items deactivated
Average reference projection was added, but has not been applied yet. Use the apply_proj method to apply it.
320 events found
Event IDs: [ 1  2  3  4  5 32]
Not setting metadata
Not setting metadata
320 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
Created an SSP operator (subspace dimension = 1)
1 projection items activated
Loading data for 72 events and 421 original time points ...
0 bad epochs dropped
Loading data for 73 events and 421 original time points ...
0 bad epochs dropped
Loading data for 73 events and 421 original time points ...
0 bad epochs dropped
Loading data for 71 events and 421 original time points ...
0 bad epochs dropped
Loading data for 15 events and 421 original time points ...
0 bad epochs dropped
Loading data for 16 events and 421 original time points ...
0 bad epochs dropped
Computing rank from data with rank=None
    Using tolerance 7.7e-11 (2.2e-16 eps * 59 dim * 5.9e+03  max singular value)
    Estimated rank (eeg): 58
    EEG: rank 58 computed from 59 data channels with 1 projector
    Created an SSP operator (subspace dimension = 1)
    Setting small EEG eigenvalues to zero (without PCA)
Reducing data rank from 59 -&gt; 58
Estimating covariance using EMPIRICAL
Done.
Number of samples used : 38720
[done]
Projections have already been applied. Setting proj attribute to True.
</pre></div>
</div>
</div>
<div class="section" id="getting-a-source-estimate">
<h2>Getting a source estimate<a class="headerlink" href="#getting-a-source-estimate" title="Permalink to this headline">¶</a></h2>
<p>New we have all of the components we need to compute a forward solution,
but first we should sanity check that everything is well aligned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <a href="../../generated/mne.viz.plot_alignment.html#mne.viz.plot_alignment" title="mne.viz.plot_alignment" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-function"><span class="n">plot_alignment</span></a><span class="p">(</span>
    <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">surfaces</span><span class="o">=</span><span class="s1">&#39;head-dense&#39;</span><span class="p">,</span>
    <span class="n">subject</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="plot eeg mri coords" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_005.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using lh.seghead for head surface.
</pre></div>
</div>
<p>Now we can actually compute the forward:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a> <span class="o">=</span> <a href="../../generated/mne.make_forward_solution.html#mne.make_forward_solution" title="mne.make_forward_solution" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_forward_solution</span></a><span class="p">(</span>
    <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_src</span></a><span class="p">,</span> <span class="n">bem</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fname_bem</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Source space          : /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-oct-6-src.fif
MRI -&gt; head transform : instance of Transform
Measurement data      : instance of Info
Conductor model   : /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-5120-5120-5120-bem-sol.fif
Accurate field computations
Do computations in head coordinates
Free source orientations

Reading /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-oct-6-src.fif...
Read 2 source spaces a total of 8196 active source locations

Coordinate transformation: MRI (surface RAS) -&gt; head
     0.999310  0.009985 -0.035787      -3.17 mm
     0.012759  0.812404  0.582955       6.86 mm
     0.034894 -0.583009  0.811716      28.88 mm
     0.000000  0.000000  0.000000       1.00

Read  60 EEG channels from info
Head coordinate coil definitions created.
Source spaces are now in head coordinates.

Setting up the BEM model using /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-5120-5120-5120-bem-sol.fif...

Loading surfaces...

Loading the solution matrix...

Three-layer model surfaces loaded.
Loaded linear_collocation BEM solution from /home/circleci/mne_data/MNE-sample-data/subjects/sample/bem/sample-5120-5120-5120-bem-sol.fif
Employing the head-&gt;MRI coordinate transform with the BEM model.
BEM model sample-5120-5120-5120-bem-sol.fif is now set up

Source spaces are in head coordinates.
Checking that the sources are inside the surface (will take a few...)
    Skipping interior check for 846 sources that fit inside a sphere of radius   43.6 mm
    Skipping solid angle check for 2 points using Qhull
    2 source space points omitted because they are outside the inner skull surface.
    Computing patch statistics...
    Patch information added...
    Skipping interior check for 875 sources that fit inside a sphere of radius   43.6 mm
    Skipping solid angle check for 0 points using Qhull
    1 source space point omitted because it is outside the inner skull surface.
    Computing patch statistics...
    Patch information added...

Setting up for EEG...
Computing EEG at 8193 source locations (free orientations)...

Finished.
</pre></div>
</div>
<p>Finally let’s compute the inverse and apply it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.minimum_norm.InverseOperator.html#mne.minimum_norm.InverseOperator" title="mne.minimum_norm.InverseOperator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inv</span></a> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">make_inverse_operator</span></a><span class="p">(</span>
    <a href="../../generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="../../generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <a href="../../generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../../generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stc</span></a> <span class="o">=</span> <a href="../../generated/mne.minimum_norm.apply_inverse.html#mne.minimum_norm.apply_inverse" title="mne.minimum_norm.apply_inverse" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">apply_inverse</span></a><span class="p">(</span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked</span></a><span class="p">,</span> <a href="../../generated/mne.minimum_norm.InverseOperator.html#mne.minimum_norm.InverseOperator" title="mne.minimum_norm.InverseOperator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inv</span></a><span class="p">)</span>
<a href="../../generated/mne.viz.Brain.html#mne.viz.Brain" title="mne.viz.Brain" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">brain</span></a> <span class="o">=</span> <a href="../../generated/mne.SourceEstimate.html#mne.SourceEstimate.plot" title="mne.SourceEstimate.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">initial_time</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="plot eeg mri coords" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_eeg_mri_coords_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Converting forward solution to surface orientation
    Average patch normals will be employed in the rotation to the local surface coordinates....
    Converting to surface-based source orientations...
    [done]
info[&quot;bads&quot;] and noise_cov[&quot;bads&quot;] do not match, excluding bad channels from both
Computing inverse operator with 59 channels.
    59 out of 60 channels remain after picking
Selected 59 channels
Creating the depth weighting matrix...
    59 EEG channels
    limit = 8192/8193 = 10.040598
    scale = 157084 exp = 0.8
Applying loose dipole orientations to surface source spaces: 0.2
Whitening the forward solution.
    Created an SSP operator (subspace dimension = 1)
Computing rank from covariance with rank=None
    Using tolerance 1.2e-13 (2.2e-16 eps * 59 dim * 9  max singular value)
    Estimated rank (eeg): 58
    EEG: rank 58 computed from 59 data channels with 1 projector
    Setting small EEG eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.86184
    scaling factor to adjust the trace = 3.24877e+19 (nchan = 59 nzero = 1)
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 72
    Created the regularized inverter
    Created an SSP operator (subspace dimension = 1)
    Created the whitener using a noise covariance matrix with rank 58 (1 small eigenvalues omitted)
    Computing noise-normalization factors (dSPM)...
[done]
Applying inverse operator to &quot;1&quot;...
    Picked 59 channels from the data
    Computing inverse...
    Eigenleads need to be weighted ...
    Computing residual...
    Explained  85.0% variance
    Combining the current components...
    dSPM...
[done]
Using control points [ 4.17591891  4.939572   10.86348066]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  49.793 seconds)</p>
<p><strong>Estimated memory usage:</strong>  680 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-source-modeling-plot-eeg-mri-coords-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/32cd46b7abdaf3b264d0846f66f85edd/plot_eeg_mri_coords.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_eeg_mri_coords.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ddc69c7d64f56b270d77306da97dbe20/plot_eeg_mri_coords.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_eeg_mri_coords.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


  
</div>

              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="plot_dipole_orientations.html" title="previous page">The role of dipole orientations in distributed source localization</a>
    <a class='right-next' id="next-link" href="plot_eeg_no_mri.html" title="next page">EEG forward operator with a template MRI</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.014cad6f3a039303089e.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-37225609-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
<footer class="footer mt-5 mt-md-0">
  <div class="container institutions">
    <div class="d-flex flex-wrap flex-row justify-content-center">
      <div class="m-2">
          <a href="https://www.massgeneral.org/">
            <img class="institution" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://martinos.org/">
            <img class="institution" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://hms.harvard.edu/">
            <img class="institution" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://web.mit.edu/">
            <img class="institution" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.nyu.edu/">
            <img class="institution" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="http://www.cea.fr/">
            <img class="institution" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://sci.aalto.fi/">
            <img class="institution" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.telecom-paris.fr/">
            <img class="institution" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.washington.edu/">
            <img class="institution" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://icm-institute.org/">
            <img class="institution" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.bu.edu/">
            <img class="institution" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inserm.fr/">
            <img class="institution" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.fz-juelich.de/">
            <img class="institution" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.tu-ilmenau.de/">
            <img class="institution" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://bids.berkeley.edu/">
            <img class="institution" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.inria.fr/">
            <img class="institution" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.au.dk/">
            <img class="institution" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/>
          </a>
        </div>
      <div class="m-2">
          <a href="https://www.uni-graz.at/">
            <img class="institution" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/>
          </a>
        </div>
      
    </div>
  </div>
  <p class="text-center text-muted small">&copy; Copyright 2012–2021, MNE Developers. Last updated <time datetime="2021-02-20T17:26:11.514275+00:00" class="localized">2021-02-20 17:26 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
</footer>
  <script src="https://mne.tools/versionwarning.js"></script>
  </body>
</html>