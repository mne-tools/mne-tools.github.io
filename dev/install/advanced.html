
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Advanced setup &#8212; MNE 1.0.dev0 documentation</title>
    
    <link href="../_static/styles/theme.css?digest=3c0a44d549fc2482317d" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3c0a44d549fc2482317d" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3c0a44d549fc2482317d">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bootstrap_divs.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Testing your installation" href="check_installation.html" />
    <link rel="prev" title="Install via pip or conda" href="manual_install.html" />
    <link rel="canonical" href="https://mne.tools/stable/index.html" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-37225609-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/mne_logo_small.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../overview/index.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../python_reference.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../overview/get_help.html">
  Get help
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../overview/development.html">
  Development
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        dev  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables install/advanced and {'json_url': 'https://mne.tools/dev/_static/versions.json', 'url_template': 'https://mne.tools/{version}/', 'version_match': 'dev'}.
-->

<script type="text/javascript">
// Construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://mne.tools/{version}/";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "install/advanced.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://mne.tools/dev/_static/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "install/advanced.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            // get the base URL for that doc version, add the current page's
            // path to it, and set as `href`
            entry.url = buildURL(entry);
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 1.0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "dev") {
                node.classList.add("active");
                $("#version_switcher_button").text(entry.name);
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/mne-tools/mne-python" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/mne_python" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://mne.discourse.group/" rel="noopener" target="_blank" title="Discourse">
            <span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">Discourse</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://discord.gg/rKfvxTuATa" rel="noopener" target="_blank" title="Discord">
            <span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installers.html">
   MNE-Python installers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="manual_install.html">
   Install via
   <code class="code docutils literal notranslate">
    <span class="pre">
     pip
    </span>
   </code>
   or
   <code class="code docutils literal notranslate">
    <span class="pre">
     conda
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Advanced setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="check_installation.html">
   Testing your installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="updating.html">
   Updating MNE-Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="freesurfer.html">
   Installing FreeSurfer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mne_tools_suite.html">
   Overview of the MNE tools suite
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-jupyter-notebooks-and-jupyterlab">
   Working with Jupyter Notebooks and JupyterLab
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing-to-a-headless-server">
   Installing to a headless server
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-development-version">
   Using the development version
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-python-distributions">
   Other Python distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gpu-acceleration-with-cuda">
   GPU acceleration with CUDA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#off-screen-rendering-with-mesa">
   Off-screen rendering with MESA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#troubleshooting-3d-plots">
   Troubleshooting 3D plots
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-plotting-trouble-after-upgrade-on-macos">
     3D plotting trouble after upgrade on macOS
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
<div>
  
  <section id="advanced-setup">
<span id="id2"></span><h1>Advanced setup<a class="headerlink" href="#advanced-setup" title="Permalink to this headline">¶</a></h1>
<section id="working-with-jupyter-notebooks-and-jupyterlab">
<h2>Working with Jupyter Notebooks and JupyterLab<a class="headerlink" href="#working-with-jupyter-notebooks-and-jupyterlab" title="Permalink to this headline">¶</a></h2>
<p>If you like using Jupyter notebooks, you should also update the “base”
conda environment to include the <code class="docutils literal notranslate"><span class="pre">nb_conda_kernels</span></code> package; this will
make it easier to use MNE-Python in Jupyter Notebooks launched from the
Anaconda GUI:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">conda install --name=base nb_conda_kernels</span>
</pre></div>
</div>
<p>When using MNE-Python within IPython or a Jupyter notebook, we strongly
recommend using the Qt matplotlib backend for fast and correct rendering. On
Linux, for example, Qt is the only matplotlib backend for which 3D rendering
will work correctly. On macOS, certain matplotlib functions might not work as
expected on backends other than Qt. Enabling Qt can be accomplished when
starting IPython from a terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ipython --matplotlib=qt</span>
</pre></div>
</div>
<p>or in a Jupyter Notebook, you can use the “magic” command:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="o">%</span><span class="k">matplotlib</span> qt
</pre></div>
</div>
<p>This will create separate pop-up windows for each figure, and has the advantage
that the 3D plots will retain rich interactivity (so, for example, you can
click-and-drag to rotate cortical surface activation maps).</p>
<p>If you are creating a static notebook or simply prefer Jupyter’s inline plot
display, MNE-Python will work with the standard “inline” magic:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<p>but some functionality will be lost. For example, PyVista scenes will still
pop-up a separate window, but only one window at a time is possible, and
interactivity within the scene is limited in non-blocking plot calls.</p>
<div class="note admonition">
<p class="admonition-title"><i class="fab fa-windows"></i> Windows</p>
<p>If you are using MNE-Python on Windows through IPython or Jupyter, you might
also have to use the IPython magic command <code class="docutils literal notranslate"><span class="pre">%gui</span> <span class="pre">qt</span></code> (see <a class="reference external" href="https://github.com/ipython/ipython/issues/10384">here</a>). For example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="o">%</span><span class="k">gui</span> qt
</pre></div>
</div>
</div>
<p>If you installed the <code class="docutils literal notranslate"><span class="pre">nb_conda_kernels</span></code> package into your <code class="docutils literal notranslate"><span class="pre">base</span></code>
environment (as recommended), you should be able to launch <code class="docutils literal notranslate"><span class="pre">mne</span></code>-capable
notebooks from within the Anaconda Navigator GUI without having to explicitly
switch to the <code class="docutils literal notranslate"><span class="pre">mne</span></code> environment first; look for <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">[conda</span> <span class="pre">env:mne]</span></code>
when choosing which notebook kernel to use. Otherwise, be sure to activate the
<code class="docutils literal notranslate"><span class="pre">mne</span></code> environment before launching the notebook.</p>
<p>If you use another Python setup and you encounter some difficulties please
report them on the <a class="reference external" href="https://mne.discourse.group">MNE Forum</a> or on the <a class="reference external" href="https://github.com/mne-tools/mne-python/issues/">GitHub issues page</a> to get
assistance.</p>
<p>It is also possible to interact with the 3D plots without installing Qt by using
the notebook 3d backend:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">mne</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">set_3d_backend</span><span class="p">(</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The notebook 3d backend requires PyVista to be installed along with other packages,
please follow <a class="reference internal" href="manual_install.html#standard-instructions"><span class="std std-ref">Install via pip or conda</span></a>.</p>
</section>
<section id="installing-to-a-headless-server">
<h2>Installing to a headless server<a class="headerlink" href="#installing-to-a-headless-server" title="Permalink to this headline">¶</a></h2>
<p>With <a class="reference external" href="https://docs.pyvista.org/">pyvista</a>:
Download the <a class="reference external" href="https://raw.githubusercontent.com/mne-tools/mne-python/main/server_environment.yml">server environment file</a> and use it to create the conda
environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">remote</span><span class="o">-</span><span class="n">name</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mne</span><span class="o">-</span><span class="n">tools</span><span class="o">/</span><span class="n">mne</span><span class="o">-</span><span class="n">python</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">server_environment</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span><span class="o">=</span><span class="n">mne</span> <span class="o">--</span><span class="n">file</span><span class="o">=</span><span class="n">server_environment</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
</section>
<section id="using-the-development-version">
<h2>Using the development version<a class="headerlink" href="#using-the-development-version" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="updating.html#installing-main"><span class="std std-ref">Upgrading to the development version</span></a> for how to do a one-time update to the latest
development version of MNE-Python. If you plan to contribute to MNE-Python, or
just prefer to use git rather than pip to make frequent updates, there are
instructions for installing from a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> in the <a class="reference internal" href="contributing.html#contributing"><span class="std std-ref">Contributing guide</span></a>.</p>
</section>
<section id="other-python-distributions">
<span id="other-py-distros"></span><h2>Other Python distributions<a class="headerlink" href="#other-python-distributions" title="Permalink to this headline">¶</a></h2>
<p>While the <a class="reference external" href="https://www.anaconda.com/products/individual">Anaconda</a> Python distribution provides many conveniences, other
distributions of Python should also work with MNE-Python.  In particular,
<a class="reference external" href="https://conda.io/en/latest/miniconda.html">Miniconda</a> is a lightweight alternative to Anaconda that is fully compatible;
like Anaconda, Miniconda includes the <code class="docutils literal notranslate"><span class="pre">conda</span></code> command line tool for
installing new packages and managing environments; unlike Anaconda, Miniconda
starts off with a minimal set of around 30 packages instead of Anaconda’s
hundreds. See the <a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/install/index.html">installation instructions for Miniconda</a> for more info.
A similar alternative is <a class="reference external" href="https://github.com/conda-forge/miniforge">MiniForge</a>, which uses the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code> channel
as the default source for package installation (saving you the trouble of
typing <code class="docutils literal notranslate"><span class="pre">--channel=conda-forge</span></code> with each <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span></code> command).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> or <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code> environment variables set,
you may run into difficulty using Anaconda. See the
<a class="reference external" href="http://conda.pydata.org/docs/troubleshooting.html">Anaconda troubleshooting guide</a> for more information. Note that it is
easy to switch between <code class="docutils literal notranslate"><span class="pre">conda</span></code>-managed Python installations and the
system Python installation using the <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span></code> and <code class="docutils literal notranslate"><span class="pre">conda</span>
<span class="pre">deactivate</span></code> commands, so you may find that after adopting Anaconda it is
possible (indeed, preferable) to leave <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> and <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code>
permanently unset.</p>
</div>
<p>It is also possible to use a system-level installation of Python (version
3.7 or higher) and use <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install MNE-Python and its
dependencies, using the provided <a class="reference external" href="https://raw.githubusercontent.com/mne-tools/mne-python/main/requirements.txt">requirements file</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl --remote-name https://raw.githubusercontent.com/mne-tools/mne-python/main/requirements.txt</span>
<span class="go">pip install --user -r requirements.txt</span>
</pre></div>
</div>
<p>Other configurations will probably also work, but we may be unable to offer
support if you encounter difficulties related to your particular Python
installation choices.</p>
</section>
<section id="gpu-acceleration-with-cuda">
<span id="cuda"></span><h2>GPU acceleration with CUDA<a class="headerlink" href="#gpu-acceleration-with-cuda" title="Permalink to this headline">¶</a></h2>
<p>MNE-Python can utilize <a class="reference external" href="https://developer.nvidia.com/cuda-zone">NVIDIA CUDA GPU processing</a> to speed up some
operations (e.g. FIR filtering) by roughly an order of magnitude. To use CUDA,
first  ensure that you are running the <a class="reference external" href="https://www.geforce.com/drivers">NVIDIA proprietary drivers</a> on your
operating system, and then do:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">conda install cupy</span>
<span class="go">MNE_USE_CUDA=true python -c &quot;import mne; mne.cuda.init_cuda(verbose=True)&quot;</span>
<span class="go">Enabling CUDA with 1.55 GB available memory</span>
</pre></div>
</div>
<p>If you receive a message reporting the GPU’s available memory, <a class="reference external" href="https://cupy.chainer.org/">CuPy</a>
is working properly. To permanently enable CUDA in MNE, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mne</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="s1">&#39;MNE_USE_CUDA&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>  
</pre></div>
</div>
<p>You can then test MNE CUDA support by running the associated test:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pytest mne/tests/test_filter.py -k cuda</span>
</pre></div>
</div>
<p>If the tests pass, then CUDA should work in MNE. You can use CUDA in methods
that state that they allow passing <code class="docutils literal notranslate"><span class="pre">n_jobs='cuda'</span></code>, such as
<a class="reference internal" href="../generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mne.io.Raw.filter()</span></code></a> and <a class="reference internal" href="../generated/mne.io.Raw.html#mne.io.Raw.resample" title="mne.io.Raw.resample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mne.io.Raw.resample()</span></code></a>,
and they should run faster than the CPU-based multithreading such as
<code class="docutils literal notranslate"><span class="pre">n_jobs=8</span></code>.</p>
</section>
<section id="off-screen-rendering-with-mesa">
<h2>Off-screen rendering with MESA<a class="headerlink" href="#off-screen-rendering-with-mesa" title="Permalink to this headline">¶</a></h2>
<p>On remote Linux systems, it might be possible to use MESA software rendering
(such as <code class="docutils literal notranslate"><span class="pre">llvmpipe</span></code> or <code class="docutils literal notranslate"><span class="pre">swr</span></code>) for 3D visualization (with some tweaks).
For example, on CentOS 7.5 you might be able to use an environment variable
to force MESA to use modern OpenGL by using this before executing
<code class="docutils literal notranslate"><span class="pre">spyder</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export MESA_GL_VERSION_OVERRIDE=3.3</span>
</pre></div>
</div>
<p>Also, it’s possible that different software rending backends might perform
better than others, such as using the <code class="docutils literal notranslate"><span class="pre">llvmpipe</span></code> backend rather than <code class="docutils literal notranslate"><span class="pre">swr</span></code>.</p>
<p>MESA also can have trouble with full-screen antialiasing, which you can
disable with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export MNE_3D_OPTION_ANTIALIAS=false</span>
</pre></div>
</div>
<p>or by doing
<a class="reference internal" href="../generated/mne.viz.set_3d_options.html#mne.viz.set_3d_options" title="mne.viz.set_3d_options"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.viz.set_3d_options(antialias=False)</span></code></a> within
a given Python session.</p>
<p>Another issue that may come up is that the MESA software itself may be out of date
in certain operating systems, for example CentOS. This may lead to incomplete
rendering of some 3D plots. A solution is described in this <a class="reference external" href="https://github.com/mne-tools/mne-python/issues/7977#issuecomment-729921035">Github comment</a>.
It boils down to building a newer version (e.g., 18.3.6)
locally following a variant of <a class="reference external" href="https://xorg-team.pages.debian.net/xorg/howto/build-mesa.html#_preparing_mesa_sources">these instructions</a>.
If you have CentOS 7 or newer, you can also try some <a class="reference external" href="https://osf.io/sp9qg/download">prebuilt binaries</a> we made.
After downloading the files, untar them and add them to the appropriate library paths
using the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">tar xzvf mesa_18.3.6_centos_lib.tgz</span>
<span class="go">export LIBGL_DRIVERS_PATH=&quot;${PWD}/lib&quot;</span>
<span class="go">export LD_LIBRARY_PATH=&quot;${PWD}/lib&quot;</span>
</pre></div>
</div>
<p>To check that everything went well, type the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">glxinfo | grep &quot;OpenGL core profile version&quot;</span>
</pre></div>
</div>
<p>which should give:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OpenGL</span> <span class="n">core</span> <span class="n">profile</span> <span class="n">version</span> <span class="n">string</span><span class="p">:</span> <span class="mf">3.3</span> <span class="p">(</span><span class="n">Core</span> <span class="n">Profile</span><span class="p">)</span> <span class="n">Mesa</span> <span class="mf">18.3.6</span>
</pre></div>
</div>
<p>Another way to check is to type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mne sys_info</span>
</pre></div>
</div>
<p>and it should show the right version of MESA:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">pyvista</span><span class="p">:</span>       <span class="mf">0.27.4</span> <span class="p">{</span><span class="n">pyvistaqt</span><span class="o">=</span><span class="mf">0.2.0</span><span class="p">,</span> <span class="n">OpenGL</span> <span class="mf">3.3</span> <span class="p">(</span><span class="n">Core</span> <span class="n">Profile</span><span class="p">)</span> <span class="n">Mesa</span> <span class="mf">18.3.6</span> <span class="n">via</span> <span class="n">llvmpipe</span> <span class="p">(</span><span class="n">LLVM</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mi">256</span> <span class="n">bits</span><span class="p">)}</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="troubleshooting-3d-plots">
<span id="troubleshoot-3d"></span><h2>Troubleshooting 3D plots<a class="headerlink" href="#troubleshooting-3d-plots" title="Permalink to this headline">¶</a></h2>
<section id="d-plotting-trouble-after-upgrade-on-macos">
<h3>3D plotting trouble after upgrade on macOS<a class="headerlink" href="#d-plotting-trouble-after-upgrade-on-macos" title="Permalink to this headline">¶</a></h3>
<p>When upgrading MNE-Python from version 0.19 or lower, some macOS users may end
up with
conflicting versions of some of the 3D plotting dependencies. If you plot using
the pyvista 3D backend and find that you can click-drag to rotate the brain,
but cannot adjust any of the settings sliders, it is likely that your versions
of VTK and/or QT are incompatible. This series of commands should fix it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">conda uninstall vtk</span>
<span class="go">pip uninstall -y pyvista</span>
<span class="go">conda install vtk</span>
<span class="go">pip install --no-cache pyvista</span>
</pre></div>
</div>
<p>If you installed VTK using <code class="docutils literal notranslate"><span class="pre">pip</span></code> rather than <code class="docutils literal notranslate"><span class="pre">conda</span></code>, substitute the first
line for <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">-y</span> <span class="pre">vtk</span></code>.</p>
</section>
</section>
</section>


  
</div>

              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="manual_install.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Install via <code class="code docutils literal notranslate"><span class="pre">pip</span></code> or <code class="code docutils literal notranslate"><span class="pre">conda</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="check_installation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Testing your installation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
    <script src="https://mne.tools/versionwarning.js"></script>
    
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=3c0a44d549fc2482317d"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="text-center text-muted small">&copy; Copyright 2012–2022, MNE Developers. Last updated <time datetime="2022-03-19T15:48:13.342818+00:00" class="localized">2022-03-19 15:48 UTC</time>
<script type="text/javascript">$(function () { $("time.localized").each(function () { var el = $(this); el.text(new Date(el.attr("datetime")).toLocaleString([], {dateStyle: "medium", timeStyle: "long"})); }); } )</script></p>
    </div>
    
  </div>
</footer>
  </body>
</html>