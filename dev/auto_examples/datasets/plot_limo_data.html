<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Import single subject from LIMO data set into MNE-Python &#8212; MNE 0.19.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" href="../../_static/reset-syntax.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap_divs.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="row devbar alert alert-danger">
This documentation is for <strong>development version 0.19.dev0</strong>.
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.19.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../install/contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-danger navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.19.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.18 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Import single subject from LIMO data set into MNE-Python</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-datasets-plot-limo-data-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="import-single-subject-from-limo-data-set-into-mne-python">
<span id="sphx-glr-auto-examples-datasets-plot-limo-data-py"></span><h1>Import single subject from LIMO data set into MNE-Python<a class="headerlink" href="#import-single-subject-from-limo-data-set-into-mne-python" title="Permalink to this headline">¶</a></h1>
<p>Here we a define function to extract the eeg signal data
from the LIMO structures in the LIMO dataset, see <a class="footnote-reference brackets" href="#id3" id="id1">1</a>, <a class="footnote-reference brackets" href="#id4" id="id2">2</a>, and:</p>
<blockquote>
<div><p><a class="reference external" href="https://datashare.is.ed.ac.uk/handle/10283/2189?show=full">https://datashare.is.ed.ac.uk/handle/10283/2189?show=full</a></p>
<p><a class="reference external" href="https://github.com/LIMO-EEG-Toolbox">https://github.com/LIMO-EEG-Toolbox</a></p>
</div></blockquote>
<p>The code allows to:</p>
<p>Fetch single subjects epochs data for the LIMO data set.
Epochs information (i.e., sampling rate, number of epochs per condition,
number and name of EEG channels per subject, etc.) is extracted from
the LIMO .mat files stored on disk.
If files are not found, the function mne.datasets.limo.load_data() will
automatically download the data from a remote repository.</p>
<p><a class="reference internal" href="../../generated/mne.datasets.limo.load_data.html#mne.datasets.limo.load_data" title="mne.datasets.limo.load_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.datasets.limo.load_data()</span></code></a> creates a custom info and
epochs structure in MNE-Python.
Missing channels can be interpolated if desired.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Guillaume, Rousselet. (2016). LIMO EEG Dataset, [dataset].
University of Edinburgh, Centre for Clinical Brain Sciences.
<a class="reference external" href="https://doi.org/10.7488/ds/1556">https://doi.org/10.7488/ds/1556</a>.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Rousselet, G. A., Gaspar, C. M., Pernet, C. R., Husk, J. S.,
Bennett, P. J., &amp; Sekuler, A. B. (2010). Healthy aging delays scalp EEG
sensitivity to noise in a face discrimination task.
Frontiers in psychology, 1, 19. <a class="reference external" href="https://doi.org/10.3389/fpsyg.2010.00019">https://doi.org/10.3389/fpsyg.2010.00019</a></p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Jose C. Garcia Alanis &lt;alanis.jcg@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="k">import</span> <span class="n">limo</span>
<span class="kn">from</span> <span class="nn">mne.stats</span> <span class="k">import</span> <a href="../../generated/mne.stats.linear_regression.html#mne.stats.linear_regression" title="View documentation for mne.stats.linear_regression"><span class="n">linear_regression</span></a>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<span class="c1"># fetch data from subject 2 and interpolate missing channels</span>
<a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a> <span class="o">=</span> <a href="../../generated/mne.datasets.limo.load_data.html#mne.datasets.limo.load_data" title="View documentation for mne.datasets.limo.load_data"><span class="n">limo</span><span class="o">.</span><span class="n">load_data</span></a><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1052 matching events found
No baseline correction applied
Adding metadata with 2 columns
0 projection items activated
0 bad epochs dropped
</pre></div>
</div>
<p>In the original LIMO experiment, participants performed a two-alternative
forced choice task discriminating between the same two faces.
The critical manipulation in the experiment was that the phase-coherence of
the presented face-stimuli was varied across a noise-signal continuum
spanning from 0 to 100 %. In other words, faces with high phase coherence
were easily discernible, while faces with low phase-coherence were hard to
identify as such).
The events coding the presentation of each of these two faces are stored in
<code class="docutils literal notranslate"><span class="pre">limo_epochs.events</span></code>.</p>
<p>We can visualise the distribution of the face events contained in the
epochs structure. Events should appear clearly grouped, as they are ordered
during the import process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="View documentation for matplotlib.figure.Figure"><span class="n">fig</span></a><span class="p">,</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.SubplotBase.html#matplotlib.axes.SubplotBase" title="View documentation for matplotlib.axes.SubplotBase"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a href="../../generated/mne.viz.plot_events.html#mne.viz.plot_events" title="View documentation for mne.viz.plot_events"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_events</span></a><span class="p">(</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">event_id</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.SubplotBase.html#matplotlib.axes.SubplotBase" title="View documentation for matplotlib.axes.SubplotBase"><span class="n">ax</span></a><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set.html#matplotlib.axes.Axes.set" title="View documentation for matplotlib.axes.Axes.set"><span class="n">ax</span><span class="o">.</span><span class="n">set</span></a><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribution of events&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="View documentation for matplotlib.pyplot.legend"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_limo_data_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_limo_data_001.png" />
<p>As it can be seen above, events are coded as <code class="docutils literal notranslate"><span class="pre">Face/A</span></code> and <code class="docutils literal notranslate"><span class="pre">Face/B</span></code>.
Information about the phase-coherence of the presented faces is stored in
<code class="docutils literal notranslate"><span class="pre">limo_epochs.metadata</span></code>, which also contains information about the presented
faces for convenience.</p>
<p>Check epochs metadata</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  face  phase-coherence
0    A        -1.456885
1    A        -1.456885
2    A        -0.108914
3    A         1.624191
4    A         0.276221
</pre></div>
</div>
<p>Before going on, we’ll drop the EOG channels present in the LIMO epochs
(coded with EXG-prefix in <code class="docutils literal notranslate"><span class="pre">limo_epochs.info['ch_names']</span></code>, as data has
already been cleaned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">drop_channels</span><span class="p">([</span><span class="s1">&#39;EXG1&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG2&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG3&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG4&#39;</span><span class="p">])</span>

<span class="c1"># Furthermore, some datasets contain missing channels (stored in</span>
<span class="c1"># ``limo_epochs.info[‘bads’]``), which were dropped during preprocessing of the</span>
<span class="c1"># data. We’ll interpolate this channels for convenience.</span>
<a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">interpolate_bads</span><span class="p">(</span><span class="n">reset_bads</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing interpolation matrix from 117 sensor positions
Interpolating 11 sensors
</pre></div>
</div>
<p>Now we can go ahead and plot the ERPs evoked by Face A and Face B</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># only show -250 to 500 ms</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># plot evoked response for faces A &amp; B</span>
<a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">[</span><span class="s1">&#39;Face/A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">15</span><span class="p">],</span>
                                           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Evoked response: Face A&#39;</span><span class="p">,</span>
                                           <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="p">)</span>

<a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">[</span><span class="s1">&#39;Face/B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">15</span><span class="p">],</span>
                                           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Evoked response: Face B&#39;</span><span class="p">,</span>
                                           <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_limo_data_002.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_limo_data_002.png" />
</li>
<li><img alt="../../_images/sphx_glr_plot_limo_data_003.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_limo_data_003.png" />
</li>
</ul>
<p>We can also compute the difference wave contrasting Face A and Face B.
Although, looking at the evoked responses above, we shouldn’t expect great
differences among these face-stimuli.</p>
<p>Compute difference wave (Face A minus Face B)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="View documentation for mne.EvokedArray"><span class="n">difference_wave</span></a> <span class="o">=</span> <a href="../../generated/mne.combine_evoked.html#mne.combine_evoked" title="View documentation for mne.combine_evoked"><span class="n">mne</span><span class="o">.</span><span class="n">combine_evoked</span></a><span class="p">([</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">[</span><span class="s1">&#39;Face/A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">(),</span>
                                     <span class="o">-</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">[</span><span class="s1">&#39;Face/B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()],</span>
                                     <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># Plot difference between Face A and Face B</span>
<a href="../../generated/mne.EvokedArray.html#mne.EvokedArray" title="View documentation for mne.EvokedArray"><span class="n">difference_wave</span></a><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">15</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Difference Face A - Face B&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_limo_data_004.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_limo_data_004.png" />
<p>As expected, no see clear differential patterns appears when contrasting
Face A and Face B. However, we could narrow our search to
since this is a “visual paradigm” it might be best to electrodes located over
the occipital lobe. After all this is “visual paradigm”. Thus, differences
between stimuli (if any) might easier to spot over “more visual areas”.</p>
<p>Create a dictionary containing the evoked responses</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">conditions</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Face/A&quot;</span><span class="p">,</span> <span class="s2">&quot;Face/B&quot;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">evoked_dict</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">condition</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">conditions</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">evoked_dict</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">condition</span></a><span class="p">]</span> <span class="o">=</span> <a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">condition</span></a><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">evoked_dict</span></a><span class="p">)</span>

<span class="c1"># concentrate on an occipital electrode</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="View documentation for builtins.int"><span class="n">pick</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">evoked_dict</span></a><span class="p">[</span><span class="s2">&quot;Face/A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ch_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">)</span>

<span class="c1"># compare evoked responses</span>
<a href="../../generated/mne.viz.plot_compare_evokeds.html#mne.viz.plot_compare_evokeds" title="View documentation for mne.viz.plot_compare_evokeds"><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">evoked_dict</span></a><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="View documentation for builtins.int"><span class="n">pick</span></a><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_limo_data_005.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_limo_data_005.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;Face/A&#39;: &lt;Evoked  |  &#39;Face/A&#39; (average, N=521), [-0.29994, 0.49991] sec, 128 ch, ~556 kB&gt;, &#39;Face/B&#39;: &lt;Evoked  |  &#39;Face/B&#39; (average, N=531), [-0.29994, 0.49991] sec, 128 ch, ~556 kB&gt;}
</pre></div>
</div>
<p>Next, we can inspect the effect of phase-coherence on the activation
patterns evoked by the presented face-stimuli.
Here, one would expect that faces with high phase-coherence evoke a stronger
response, as participants should be better at identifying these faces.</p>
<p>Create design matrix for linear regression. We’ll use the information
contained in the <code class="docutils literal notranslate"><span class="pre">limo_epochs.metadata</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">design</span> <span class="o">=</span> <a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">design</span> <span class="o">=</span> <span class="n">design</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># add intercept</span>
<span class="n">design</span><span class="p">[</span><span class="s1">&#39;face a - face b&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.where.html#numpy.where" title="View documentation for numpy.where"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">design</span><span class="p">[</span><span class="s1">&#39;face&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">names</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;face a - face b&#39;</span><span class="p">,</span> <span class="s1">&#39;phase-coherence&#39;</span><span class="p">]</span>

<span class="c1"># fit linear model</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">reg</span></a> <span class="o">=</span> <a href="../../generated/mne.stats.linear_regression.html#mne.stats.linear_regression" title="View documentation for mne.stats.linear_regression"><span class="n">linear_regression</span></a><span class="p">(</span><a href="../../generated/mne.EpochsArray.html#mne.EpochsArray" title="View documentation for mne.EpochsArray"><span class="n">limo_epochs</span></a><span class="p">,</span> <span class="n">design</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">names</span></a><span class="p">],</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">names</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">names</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitting linear model to epochs, (25728 targets, 3 regressors)
Done
</pre></div>
</div>
<p>Visualise effect of phase-coherence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">reg</span></a><span class="p">[</span><span class="s1">&#39;phase-coherence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="p">,</span>
                                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Effect of phase-coherence&#39;</span><span class="p">,</span>
                                       <span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">23</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_limo_data_006.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_limo_data_006.png" />
<p>Here we can see a clear effect of phase-coherence, with higher
phase-coherence (i.e., better “face visibility”) being associated with
stronger activity patterns.</p>
<p>Conversely, there appears to be no (or very small) systematic effects when
constraining Face A and Face B. This is largely consistent with the
difference wave approach presented above.</p>
<p>Visualise effect of face condition (Face A vs. Face B).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">reg</span></a><span class="p">[</span><span class="s1">&#39;face a - face b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Contrast: Face A - Face B&#39;</span><span class="p">,</span>
                                       <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">ts_args</span></a><span class="p">,</span>
                                       <span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">15</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_limo_data_007.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_limo_data_007.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  8.034 seconds)</p>
<p><strong>Estimated memory usage:</strong>  630 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-datasets-plot-limo-data-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e9c2029d538a27854bee8b41e5e8eca3/plot_limo_data.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_limo_data.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/85b80d223414f32365a9175978a38cb4/plot_limo_data.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_limo_data.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container institutions">
    <a href="https://www.massgeneral.org/"><img class="institution_lg" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a>
    <a href="https://martinos.org/"><img class="institution_lg" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a>
    <a href="https://hms.harvard.edu/"><img class="institution_lg" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a>
    <a href="https://web.mit.edu/"><img class="institution_sm" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a>
    <a href="https://www.nyu.edu/"><img class="institution_md" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a>
    <a href="http://www.cea.fr/"><img class="institution_md" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a>
    <a href="https://sci.aalto.fi/"><img class="institution_md" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a>
    <a href="https://www.telecom-paris.fr/"><img class="institution_md" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a>
    <a href="https://www.washington.edu/"><img class="institution_sm" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a>
    <a href="https://icm-institute.org/"><img class="institution_lg" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a>
    <a href="https://www.bu.edu/"><img class="institution_sm" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a>
    <a href="https://www.inserm.fr/"><img class="institution_xs" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a>
    <a href="https://www.fz-juelich.de/"><img class="institution_sm" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a>
    <a href="https://www.tu-ilmenau.de/"><img class="institution_sm" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a>
    <a href="https://bids.berkeley.edu/"><img class="institution_md" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a>
    <a href="https://www.inria.fr/"><img class="institution_sm" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a>
    <a href="https://www.au.dk/"><img class="institution_sm" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a>
    <a href="https://www.uni-graz.at/"><img class="institution_md" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a>
  </div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2019, MNE Developers. Last updated on 2019-09-24.</p>
  </div>
</footer>
  </body>
</html>