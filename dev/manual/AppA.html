<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Creating the BEM meshes &mdash; MNE 0.9.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/navy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MNE 0.9.dev0 documentation" href="../index.html" />
    <link rel="up" title="Manual" href="../manual.html" />
    <link rel="next" title="Setup at the Martinos Center" href="AppB.html" />
    <link rel="prev" title="Related publications" href="reading.html" />

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="http://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>


  </head>
  <body>

<div style="background-color: red; color: white; font-weight:bold; text-align: center; padding: 10px; min-width: 910px">
This documentation is for the development version (0.9.dev0) - <a href="http://martinos.org/mne/stable">Stable version</a>
</div>

<div style="background-color: white; text-align: left; padding: 10px 7px 15px 15px; min-width: 910px">
<div style="float: left">
<a href="../index.html"><img src="../_static/mne_logo.png" border="0" alt="py4sci"/></a>
</div>

<div style="float: right">
<a href="../index.html"><img src="../_static/institutions.png" border="0" alt="py4sci"/></a>
</div>
<br style="clear:both"/>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="AppB.html" title="Setup at the Martinos Center"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reading.html" title="Related publications"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Home</a>&nbsp;|&nbsp;</li>
        <li><a href="../manual.html">Manual</a>&nbsp;|&nbsp;</li>
        <li><a href="../mne-python.html">Python</a>&nbsp;|&nbsp;</li>
        <li><a href="../cite.html">Cite MNE</a>&nbsp;|&nbsp;</li>
        <!-- <li><a href="../search.html">Search</a></li> -->

          <li><a href="../manual.html" accesskey="U">Manual</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../manual.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="list.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook.html">The Cookbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="browse.html">Processing raw data</a></li>
<li class="toctree-l2"><a class="reference internal" href="forward.html">The forward solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="mne.html">The current estimates</a></li>
<li class="toctree-l2"><a class="reference internal" href="analyze.html">Interactive analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="morph.html">Morphing and averaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="convert.html">Data conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlab.html">The Matlab toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">Miscellaneous utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampledata.html">The sample data set</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading.html">Related publications</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Creating the BEM meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppB.html">Setup at the Martinos Center</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppInstall.html">Installation and configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppReleaseNotes.html">Release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="AppEULA.html">Licence agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command_line_tutorial.html">Getting started with MNE command line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mne-python.html">MNE with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mne-cpp.html">MNE with CPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Cite MNE and MNE-Python</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Versions</h3>
<ul class="current">
    <li class="toctree-l1"><a href=http://martinos.org/mne/stable>Stable</a></li>
    <li class="toctree-l1"><a href=http://martinos.org/mne/dev>Development</a></li>
</ul>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creating-the-bem-meshes">
<span id="create-bem-model"></span><h1>Creating the BEM meshes<a class="headerlink" href="#creating-the-bem-meshes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="using-the-watershed-algorithm">
<span id="babbdhag"></span><h2>Using the watershed algorithm<a class="headerlink" href="#using-the-watershed-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The watershed algorithmegonne <em>et al.</em>,
2004] is part of the FreeSurfer software.
The name of the program is mri_watershed .
Its use in the MNE environment is facilitated by the script mne_watershed_bem ,
which assumes the following options:</p>
<p><strong>&#8212;subject  &lt;*subject*&gt;</strong></p>
<blockquote>
<div>Defines the name of the subject. This can be also accomplished
by setting the SUBJECT environment variable.</div></blockquote>
<p><strong>&#8212;overwrite</strong></p>
<blockquote>
<div>Overwrite the results of previous run of mne_watershed_bem .</div></blockquote>
<p><strong>&#8212;atlas</strong></p>
<blockquote>
<div>Makes mri_watershed to employ
atlas information to correct the segmentation.</div></blockquote>
<p>After mne_watershed_bem has
completed, the following files appear in the subject&#8217;s <tt class="docutils literal"><span class="pre">bem/watershed</span></tt> directory:</p>
<p>** &lt;<em>subject</em>&gt; _brain_surface**</p>
<blockquote>
<div>Contains the brain surface triangulation.</div></blockquote>
<p>** &lt;<em>subject</em>&gt; _inner_skull_surface**</p>
<blockquote>
<div>Contains the inner skull triangulation.</div></blockquote>
<p>** &lt;<em>subject</em>&gt; _outer_skull_surface**</p>
<blockquote>
<div>Contains the outer skull triangulation.</div></blockquote>
<p>** &lt;<em>subject</em>&gt; _outer_skin_surface**</p>
<blockquote>
<div>Contains the scalp triangulation.</div></blockquote>
<p>All of these surfaces are in the FreeSurfer format. In addition,
there will be a directory called <tt class="docutils literal"><span class="pre">bem/watershed/ws</span></tt> which
contains the brain MRI volume. Furthermore, mne_watershed_bem script
converts the scalp surface to fif format and saves the result to <tt class="docutils literal"><span class="pre">bem/</span></tt>  &lt;<em>subject</em>&gt; <tt class="docutils literal"><span class="pre">-head.fif</span></tt> . The mne_analyze tool
described <a class="reference internal" href="analyze.html#ch-interactive-analysis"><em>Interactive analysis</em></a> looks for this file the visualizations
involving the scalp surface.</p>
</div>
<div class="section" id="using-flash-images">
<span id="babfcdjh"></span><h2>Using FLASH images<a class="headerlink" href="#using-flash-images" title="Permalink to this headline">¶</a></h2>
<p>This method depends on the availablily of MRI data acquired
with a multi-echo FLASH sequence at two flip angles (5 and 30 degrees).
These data can be acquired separately from the MPRAGE data employed
in FreeSurfer cortical reconstructions but it is strongly recommended
that they are collected at the same time with the MPRAGEs or at
least with the same scanner. For easy co-registration, the images
should have FOV, matrix, slice thickness, gap, and slice orientation
as the MPRAGE data. For information on suitable pulse sequences,
see reference. Fischl <em>et al.</em> and J. Jovicich <em>et
al.</em>, 2006] in <a class="reference internal" href="reading.html#cegegdei"><em>Forward modeling</em></a>. At the Martinos
Center, use of the 1.5-T Avanto scanner (Bay 2) is recommended for
best results.</p>
<p>Creation of the BEM meshes using this method involves the
following steps:</p>
<ul class="simple">
<li>Organizing the MRI data. This is facilitated
by the script mne_organize_dicom ,
see <a class="reference internal" href="#babebjhi"><em>Organizing MRI data into directories</em></a>.</li>
<li>Creating a synthetic 5-degree flip angle FLASH volume, register
it with the MPRAGE data, and run the segmentation and meshing program.
This step is accomplished by running the script mne_flash_bem , see <a class="reference internal" href="#babgicfe"><em>Creating the surface tessellations</em></a>.</li>
<li>Inspecting the meshes with tkmedit, see <a class="reference internal" href="#babhjbed"><em>Inspecting the meshes</em></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following sections assume that you have    run the appropriate setup scripts to make both MNE and FreeSurfer    software available.</p>
</div>
<div class="section" id="organizing-mri-data-into-directories">
<span id="babebjhi"></span><h3>Organizing MRI data into directories<a class="headerlink" href="#organizing-mri-data-into-directories" title="Permalink to this headline">¶</a></h3>
<p>Since all images comprising the multi-echo FLASH data are
contained in a single series, it is necessary to organize the images
according to the echoes before proceeding to the BEM surface reconstruction.
This is accomplished by the mne_organize_dicom script,
which creates a directory tree with symbolic links to the original
DICOM image files. To run mne_organize_dicom ,
proceed as follows:</p>
<ul class="simple">
<li>Copy all of your images or create symbolic
links to them in a single directory. The images must be in DICOM
format. We will refer to this directory as  &lt;<em>source</em>&gt; .</li>
<li>Create another directory to hold the output of mne_organize_dicom . We
will refer to this directory as  &lt;<em>dest</em>&gt; .</li>
<li>Change the working directory to  &lt;<em>dest</em>&gt; .</li>
<li>Say <tt class="docutils literal"><span class="pre">mne_organize_dicom</span></tt>  &lt;<em>source</em>&gt; .
Depending on the total number of images in  &lt;<em>source</em>&gt; this
script may take quite a while to run. Progress is  indicated by
listing the number of images processed at 50-image intervals.</li>
</ul>
<p>As a result,  &lt;<em>dest</em>&gt; will
contain several directories named  &lt;<em>three-digit number</em>&gt; _ &lt;<em>protocol_name</em>&gt; corresponding
to the different series of images acquired. Spaces and parenthesis
in protocol names will be replaced by underscores. Under each of
these directories there are one or more directories named  &lt;<em>three-digit</em>&gt; number
corresponding to one or more subsets of images in this series (protocol).
The only subset division scheme implemented in mne_organize_dicom is
that according to different echoes, typically found in multi-echo
FLASH data. These second level directories will contain symbolic
links pointing to the original image data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">mne_organize_dicom was    developed specifically for Siemens DICOM data. Its correct behavior    with DICOM files originating from other MRI scanners has not been    verified at this time.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since mne_organize_dicom processes    all images, not only the FLASH data, it may be a useful preprocessing    step before FreeSurfer reconstruction process as well.</p>
</div>
</div>
<div class="section" id="creating-the-surface-tessellations">
<span id="babgicfe"></span><h3>Creating the surface tessellations<a class="headerlink" href="#creating-the-surface-tessellations" title="Permalink to this headline">¶</a></h3>
<p>The BEM surface segmentation and tessellation is automated
with the script mne_flash_bem .
It assumes that a FreeSurfer reconstruction for this subject is
already in place. The following options can be specified:</p>
<p><strong>&#8212;help</strong></p>
<blockquote>
<div>Prints the usage information.</div></blockquote>
<p><strong>&#8212;usage</strong></p>
<blockquote>
<div>Prints the usage information.</div></blockquote>
<p><strong>&#8212;noconvert</strong></p>
<blockquote>
<div>Skip conversion of the original MRI data. The original data are
not needed and the preparatory steps 1.-3. listed below
are thus not needed.</div></blockquote>
<p><strong>&#8212;noflash30</strong></p>
<blockquote>
<div>The 30-degree flip angle data are not used.</div></blockquote>
<p><strong>&#8212;unwarp  &lt;*type*&gt;</strong></p>
<blockquote>
<div>Run grad_unwarp with <tt class="docutils literal"><span class="pre">--unwarp</span></tt>  &lt;<em>type</em>&gt; option on each of the converted
data sets.</div></blockquote>
<p>Before running mne_flash_bem do
the following:</p>
<ul class="simple">
<li>Run mne_organize_dicom as
described above.</li>
<li>Change to the  &lt;<em>dest</em>&gt; directory
where mne_organize_dicom created the
image directory structure.</li>
<li>Create symbolic links from the directories containing the
5-degree and 30-degree flip angle FLASH series to <tt class="docutils literal"><span class="pre">flash05</span></tt> and <tt class="docutils literal"><span class="pre">flash30</span></tt> , respectively:<ul>
<li><tt class="docutils literal"><span class="pre">ln</span> <span class="pre">-s</span></tt>  &lt;<em>FLASH 5 series dir</em>&gt; <tt class="docutils literal"><span class="pre">flash05</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ln</span> <span class="pre">-s</span></tt>  &lt;<em>FLASH 30 series dir</em>&gt; <tt class="docutils literal"><span class="pre">flash30</span></tt></li>
</ul>
</li>
<li>Set the <tt class="docutils literal"><span class="pre">SUBJECTS_DIR</span></tt> and <tt class="docutils literal"><span class="pre">SUBJECT</span></tt> environment
variables</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If mne_flash_bem is    run with the <tt class="docutils literal"><span class="pre">--noflash30</span></tt> option, the flash30 directory is not needed, <em>i.e.</em>,    only the 5-degree flip angle flash data are employed.</p>
</div>
<p>It may take a while for mne_flash_bem to
complete. It uses the FreeSurfer directory structure under <tt class="docutils literal"><span class="pre">$SUBJECTS_DIR/$SUBJECT</span></tt> .
The script encapsulates the following processing steps:</p>
<ul class="simple">
<li>It creates an mgz file corresponding
to each of the eight echoes in each of the FLASH directories in <tt class="docutils literal"><span class="pre">mri/flash</span></tt> .
The files will be called <tt class="docutils literal"><span class="pre">mef</span></tt>  &lt;<em>flip-angle</em>&gt; _ &lt;<em>echo-number</em>&gt; <tt class="docutils literal"><span class="pre">.mgz</span></tt> .</li>
<li>If the <tt class="docutils literal"><span class="pre">--unwarp</span></tt> option is specified, run grad_unwarp and produce
files <tt class="docutils literal"><span class="pre">mef</span></tt>  &lt;<em>flip-angle</em>&gt; _ &lt;<em>echo-number</em>&gt; <tt class="docutils literal"><span class="pre">u.mgz</span></tt> .
These files will be then used in the following steps.</li>
<li>It creates parameter maps in <tt class="docutils literal"><span class="pre">mri/flash/parameter_maps</span></tt> using mri_ms_fitparms .</li>
<li>It creates a synthetic 5-degree flip angle volume in <tt class="docutils literal"><span class="pre">mri/flash/parameter_maps/flash5.mgz</span></tt> using mri_synthesize .</li>
<li>Using fsl_rigid_register ,
it creates a registered 5-degree flip angle volume <tt class="docutils literal"><span class="pre">mri/flash/parameter_maps/flash5_reg.mgz</span></tt> by
registering <tt class="docutils literal"><span class="pre">mri/flash/parameter_maps/flash5.mgz</span></tt> to
the <em>T1</em> volume under <tt class="docutils literal"><span class="pre">mri</span></tt> .</li>
<li>Using mri_convert , it converts
the flash5_reg volume to COR
format under <tt class="docutils literal"><span class="pre">mri/flash5</span></tt> . If necessary, the T1 and brain volumes
are also converted into the COR format.</li>
<li>It runs mri_make_bem_surfaces to
create the BEM surface tessellations.</li>
<li>It creates the directory <tt class="docutils literal"><span class="pre">bem/flash</span></tt> , moves the
tri-format tringulations there and creates the corresponding FreeSurfer
surface files in the same directory.</li>
<li>The COR format volumes created by mne_flash_bem are
removed.</li>
</ul>
<p>If the <tt class="docutils literal"><span class="pre">--noflash30</span></tt> option is specified to mne_flash_bem ,
steps 3 and 4 in the above are replaced by averaging over the different
echo times in 5-degree flip angle data.</p>
</div>
<div class="section" id="inspecting-the-meshes">
<span id="babhjbed"></span><h3>Inspecting the meshes<a class="headerlink" href="#inspecting-the-meshes" title="Permalink to this headline">¶</a></h3>
<p>It is advisable to check the validity of the BEM meshes before
using them. This can be done with help of tkmedit either
before or after executing mne_setup_forward_model,
see <a class="reference internal" href="cookbook.html#cihdbfeg"><em>Setting up the boundary-element model</em></a>.</p>
</div>
</div>
<div class="section" id="using-seglab">
<h2>Using seglab<a class="headerlink" href="#using-seglab" title="Permalink to this headline">¶</a></h2>
<p>The brain segmentation provided by FreeSurfer in the directory <tt class="docutils literal"><span class="pre">mri/brain</span></tt> can
be employed to create the inner skull surface triangulation with
help of seglab, the Neuromag MRI segmentation tool. The description
below assumes that the user is familiar with the seglab tool. If
necessary, consult the seglab manual, Neuromag P/N NM20420A-A.</p>
<p>The data set mri/brain typically
contains tissues within or outside the skull, in particular around
the eyes. These must be removed manually before the inner skull
triangulation is created.The editing and triangulation can be accomplished
as outlined below</p>
<p><strong>1. Set up the MRIs for Neuromag software access</strong></p>
<blockquote>
<div>Run the mne_setup_mri too as described in <a class="reference internal" href="cookbook.html#babccehf"><em>Setting up the anatomical MR images for MRIlab</em></a>.
As a result, the directories mri/T1-neuromag and mri/brain-neuromag
are set up.</div></blockquote>
<p><strong>2. Load the MRI data</strong></p>
<blockquote>
<div>Open the file mri/brain-neuromag/sets/COR.fif and adjust the scaling
of the data.</div></blockquote>
<p><strong>3. Preparatory steps</strong></p>
<blockquote>
<div>Set the minimum data value to 1 using the min3D operator.
Make a backup of the data with the backup3D operator.</div></blockquote>
<p><strong>4. Manual editing</strong></p>
<blockquote>
<div>The maskDraw3D operation is recommended
for manual editing. To use it, first employ the grow3D operator
with threshold interval 2...255 and the seed point inside
the brain. Then do the editing in the slicer window as described
in Section 5.4.2 of the seglab manual. Note that it is enough to
remove the connectivity to the extracerebral tissues rather than
erasing them completely.</div></blockquote>
<p><strong>5. Grow again and mask</strong></p>
<blockquote>
<div>Once manual editing is complete, employ the grow3D operator again
and do mask3D with the backup
data to see whether the result is satisfactory. If not, undo mask3D and
continue manual editing. Otherwise, undo mask3D and
proceed to the next step.</div></blockquote>
<p><strong>6. Dilation</strong></p>
<blockquote>
<div>It is advisable to make the inner skull surface slightly bigger
than the brain envelope obtained in the previous step. Therefore,
apply the dilate3D operation
once or twice. Use the values 1 for nbours and 26 for nhood in the
first dilation and 1 and 18 in the second one, respectively.</div></blockquote>
<p><strong>7. Triangulation</strong></p>
<blockquote>
<div>Triangulate the resulting object with the triangulate3D operator. Use
a sidelength of 5 to 6 mm. Check that the triangulation looks reasonable
in the 3D viewing window.</div></blockquote>
<p><strong>8. Save the triangulation</strong></p>
<blockquote>
<div>Save the triangulated surface as a mesh into bem/inner_skull.tri. Select
unit of measure as millimeters and employ the MRI coordinate system.</div></blockquote>
</div>
<div class="section" id="using-brainsuite">
<h2>Using BrainSuite<a class="headerlink" href="#using-brainsuite" title="Permalink to this headline">¶</a></h2>
<p>The BrainSuite software
running under the Windows operating system can also be used for
BEM mesh generation. This software, written by David W. Shattuck,
is distributed as a collaborative project between the Laboratory
of Neuro Imaging at the University of California Los Angeles (Director:
Dr. Arthur W. Toga) and the Biomedical Imaging Research Group at
the University of Southern California (Director: Dr. Richard M. Leahy).
For further information, see <a class="reference external" href="http://brainsuite.usc.edu/">http://brainsuite.usc.edu/</a>.</p>
<p>The conversion of BrainSuite tessellation
files to MNE software compatible formats is accomplished with the mne_convert_surface utility,
covered in <a class="reference internal" href="convert.html#behdiajg"><em>Converting surface data between different formats</em></a>.</p>
<p>The workflow needed to employ the BrainSuite tessellations
is:</p>
<p><strong>Step 1</strong></p>
<blockquote>
<div>Using the mri_convert utility
available in FreeSurfer , convert
an MRI volume to the img (Analyze) format. This volume should be the
T1.mgz volume or a volume registered with T1.mgz in FreeSurfer :<tt class="docutils literal"><span class="pre">mri_convert</span></tt>  &lt;<em>volume</em>&gt; <tt class="docutils literal"><span class="pre">.mgz</span></tt>  &lt;<em>volume</em>&gt; <tt class="docutils literal"><span class="pre">.img</span></tt></div></blockquote>
<p><strong>Step 2</strong></p>
<blockquote>
<div>Transfer  &lt;<em>volume</em>&gt; <tt class="docutils literal"><span class="pre">.mgz</span></tt> to
a location accessible to BrainSuite , running
on Windows.</div></blockquote>
<p><strong>Step 3</strong></p>
<blockquote>
<div>Using  &lt;<em>volume</em>&gt; <tt class="docutils literal"><span class="pre">.img</span></tt> as
input, create the tessellations of scalp, outer skull, and inner
skull surfaces in BrainSuite .</div></blockquote>
<p><strong>Step 4</strong></p>
<blockquote>
<div>Transfer the dfs files containing the tessellations in the bem directory
of your subject&#8217;s FreeSurfer reconstruction.</div></blockquote>
<p><strong>Step 5</strong></p>
<blockquote>
<div>Go to the bem directory where you placed the two dfs files. Using mne_convert_surface ,
convert them to the FreeSurfer surface
format, <em>e,g.</em>:
<tt class="docutils literal"><span class="pre">mne_convert_surface</span> <span class="pre">``</span> <span class="pre">``--dfs</span> <span class="pre">inner_skull.dfs</span> <span class="pre">``</span> <span class="pre">``--mghmri</span> <span class="pre">../mri/T1.mgz</span> <span class="pre">``</span> <span class="pre">``--surf</span> <span class="pre">inner_skull_dfs.surf</span></tt></div></blockquote>
<p><strong>Step 6</strong></p>
<blockquote>
<div>Using tkmedit, check that the surfaces are correct, <em>e.g.</em>:
<tt class="docutils literal"><span class="pre">tkmedit</span> <span class="pre">-f</span> <span class="pre">../mri/T1.mgz</span> <span class="pre">``</span> <span class="pre">``-surface</span> <span class="pre">inner_skull_dfs.surf</span></tt></div></blockquote>
<p><strong>Step7</strong></p>
<blockquote>
<div>Using the mne_reduce_surface function
in Matlab, reduce the number of triangles on the surfaces to 10000
- 20000. Call the output files <tt class="docutils literal"><span class="pre">outer_skin.surf</span></tt> , <tt class="docutils literal"><span class="pre">outer_skull.surf</span></tt> ,
and <tt class="docutils literal"><span class="pre">inner_skull.surf</span></tt> .</div></blockquote>
<p><strong>Step 8</strong></p>
<blockquote>
<div>Proceed to mne_setup_forward_model .
Use the <tt class="docutils literal"><span class="pre">--surf</span></tt> and <tt class="docutils literal"><span class="pre">--noswap</span></tt> options.</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If left and right are flipped in BrainSuite,    use the <tt class="docutils literal"><span class="pre">--flip</span></tt> option in mne_convert_surface to    set the coordinate transformation correctly.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The BrainSuite scalp    surface can be also used for visualization in mne_analyze ,    see <a class="reference internal" href="analyze.html#chdcghif"><em>Using a high-resolution head surface tessellations</em></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2015, MNE Developers.
      Last updated on May 14, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>