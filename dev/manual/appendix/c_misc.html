<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Miscellaneous C functionality &#8212; MNE 0.19.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" href="../../_static/reset-syntax.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap_divs.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>

<div class="row devbar alert alert-danger">
This documentation is for <strong>development version 0.19.dev0</strong>.
</div>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.19.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install/index.html">Install</a></li>
                <li><a href="../../overview/index.html">Overview</a></li>
                <li><a href="../../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../install/contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-danger navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.19.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.18 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Miscellaneous C functionality</a><ul>
<li><a class="reference internal" href="#setting-up-anatomical-mr-images-for-mrilab">Setting up anatomical MR images for MRIlab</a></li>
<li><a class="reference internal" href="#cleaning-the-digital-trigger-channel">Cleaning the digital trigger channel</a></li>
<li><a class="reference internal" href="#fixing-channel-information">Fixing channel information</a></li>
</ul>
</li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="miscellaneous-c-functionality">
<span id="c-legacy-misc"></span><h1>Miscellaneous C functionality<a class="headerlink" href="#miscellaneous-c-functionality" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setting-up-anatomical-mr-images-for-mrilab">
<span id="babccehf"></span><h2>Setting up anatomical MR images for MRIlab<a class="headerlink" href="#setting-up-anatomical-mr-images-for-mrilab" title="Permalink to this headline">¶</a></h2>
<p>If you have the Neuromag software installed, the Neuromag MRI viewer, MRIlab,
can be used to access the MRI slice data created by FreeSurfer . In addition,
the Neuromag MRI directories can be used for storing the MEG/MRI coordinate
transformations created with <code class="docutils literal notranslate"><span class="pre">mne_analyze</span></code>, see <a class="reference internal" href="../gui/analyze.html#cacehgcd"><span class="std std-ref">Coordinate frame alignment</span></a>.  During the
computation of the forward solution, mne_do_forwand_solution searches for the
MEG/MRI coordinate in the Neuromag MRI directories, see <a class="reference internal" href="../cookbook.html#babchejd"><span class="std std-ref">Computing the forward solution</span></a>. The
fif files created by <code class="docutils literal notranslate"><span class="pre">mne_setup_mri</span></code> can be loaded into MATLAB with the
<code class="docutils literal notranslate"><span class="pre">fiff_read_mri</span></code> function, see <a class="reference internal" href="../matlab.html#ch-matlab"><span class="std std-ref">MNE-MATLAB toolbox</span></a>.</p>
<p>These functions require running the script mne_setup_mri which requires that
the subject is set with the <code class="docutils literal notranslate"><span class="pre">--subject</span></code> option or by the SUBJECT environment
variable. The script processes one or more MRI data sets from
<code class="file docutils literal notranslate"><em><span class="pre">$SUBJECTS_DIR</span></em><span class="pre">/</span><em><span class="pre">$SUBJECT</span></em><span class="pre">/mri</span></code>, by default they are T1 and brain. This
default can be changed by specifying the sets by one or more <code class="docutils literal notranslate"><span class="pre">--mri</span></code> options.</p>
<p>The script creates the directories <code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em><span class="pre">-neuromag/slices</span></code> and
<code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em><span class="pre">-neuromag/sets</span></code>. If the input data set is in COR format,
mne_setup_mri makes symbolic links from the COR files in the directory
<code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em></code> into <code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em><span class="pre">-neuromag/slices</span></code>, and creates a
corresponding fif file <code class="file docutils literal notranslate"><span class="pre">COR.fif</span></code> in <code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em><span class="pre">-neuromag/sets</span></code>.
This “description file” contains references to the actual MRI slices.</p>
<p>If the input MRI data are stored in the newer <code class="file docutils literal notranslate"><span class="pre">mgz</span></code> format, the file
created in the <code class="file docutils literal notranslate"><span class="pre">mri/</span><em><span class="pre">&lt;name&gt;</span></em><span class="pre">-neuromag/sets</span></code> directory will include the
MRI pixel data as well. If available, the coordinate transformations to allow
conversion between the MRI (surface RAS) coordinates and MNI and FreeSurfer
Talairach coordinates are copied to the MRI description file. <code class="docutils literal notranslate"><span class="pre">mne_setup_mri</span></code>
invokes <code class="docutils literal notranslate"><span class="pre">mne_make_cor_set</span></code>, described in <a class="reference internal" href="../c_reference.html#mne-make-cor-set"><span class="std std-ref">mne_make_cor_set</span></a> to convert
the data.</p>
<p>For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">mne_setup_mri</span> <span class="pre">--subject</span> <span class="pre">duck_donald</span> <span class="pre">--mri</span> <span class="pre">T1</span></code></p>
<p>This command processes the MRI data set T1 for subject duck_donald.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the SUBJECT environment variable is set it is usually sufficient to run
mne_setup_mri without any options.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the name specified with the <code class="docutils literal notranslate"><span class="pre">--mri</span></code> option contains a slash, the MRI
data are accessed from the directory specified and the <code class="docutils literal notranslate"><span class="pre">SUBJECT</span></code> and
<code class="docutils literal notranslate"><span class="pre">SUBJECTS_DIR</span></code> environment variables as well as the <code class="docutils literal notranslate"><span class="pre">--subject</span></code>
option are ignored.</p>
</div>
<p>MRIlab can also be used for coordinate frame alignment. Section 3.3.1 of the
MRIlab User’s Guide, Neuromag P/N NM20419A-A contains a detailed description of
this task. Employ the images in the set <code class="file docutils literal notranslate"><span class="pre">mri/T1-neuromag/sets/COR.fif</span></code>
for the alignment. Check the alignment carefully using the digitization data
included in the measurement file as described in Section 5.3.1 of the above
manual. Save the aligned description file in the same directory as the original
description file without the alignment information but under a different name.</p>
</div>
<div class="section" id="cleaning-the-digital-trigger-channel">
<span id="babcdbdi"></span><h2>Cleaning the digital trigger channel<a class="headerlink" href="#cleaning-the-digital-trigger-channel" title="Permalink to this headline">¶</a></h2>
<p>The calibration factor of the digital trigger channel used to be set to a value
much smaller than one by the Neuromag data acquisition software. Especially to
facilitate viewing of raw data in graph it is advisable to change the
calibration factor to one. Furthermore, the eighth bit of the trigger word is
coded incorrectly in the original raw files. Both problems can be corrected by
saying:</p>
<p><code class="docutils literal notranslate"><span class="pre">mne_fix_stim14</span></code> &lt;<em>raw file</em>&gt;</p>
<p>More information about mne_fix_stim14 is available in <a class="reference internal" href="../c_reference.html#mne-fix-stim14"><span class="std std-ref">mne_fix_stim14</span></a>. It
is recommended that this fix is included as the first raw data processing step.
Note, however, the mne_browse_raw and mne_process_raw always sets the
calibration factor to one internally.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your data file was acquired on or after November 10, 2005 on the Martinos
center Vectorview system, it is not necessary to use <code class="docutils literal notranslate"><span class="pre">mne_fix_stim14</span></code>.</p>
</div>
</div>
<div class="section" id="fixing-channel-information">
<span id="babcdfjh"></span><h2>Fixing channel information<a class="headerlink" href="#fixing-channel-information" title="Permalink to this headline">¶</a></h2>
<p>There are two potential discrepancies in the channel information which need to
be fixed before proceeding:</p>
<ul class="simple">
<li><p>EEG electrode locations may be incorrect if more than 60 EEG channels are
acquired.</p></li>
<li><p>The magnetometer coil identifiers are not always correct.</p></li>
</ul>
<p>These potential problems can be fixed with the utilities
<code class="docutils literal notranslate"><span class="pre">mne_check_eeg_locations</span></code> and <code class="docutils literal notranslate"><span class="pre">mne_fix_mag_coil_types</span></code>, see
<a class="reference internal" href="../c_reference.html#mne-check-eeg-locations"><span class="std std-ref">mne_check_eeg_locations</span></a> and <a class="reference internal" href="../c_reference.html#mne-fix-mag-coil-types"><span class="std std-ref">mne_fix_mag_coil_types</span></a>.</p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container institutions">
    <a href="https://www.massgeneral.org/"><img class="institution_lg" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a>
    <a href="https://martinos.org/"><img class="institution_lg" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a>
    <a href="https://hms.harvard.edu/"><img class="institution_lg" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a>
    <a href="https://web.mit.edu/"><img class="institution_sm" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a>
    <a href="https://www.nyu.edu/"><img class="institution_md" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a>
    <a href="http://www.cea.fr/"><img class="institution_md" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a>
    <a href="https://sci.aalto.fi/"><img class="institution_md" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a>
    <a href="https://www.telecom-paris.fr/"><img class="institution_md" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a>
    <a href="https://www.washington.edu/"><img class="institution_sm" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a>
    <a href="https://icm-institute.org/"><img class="institution_lg" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a>
    <a href="https://www.bu.edu/"><img class="institution_sm" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a>
    <a href="https://www.inserm.fr/"><img class="institution_xs" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a>
    <a href="https://www.fz-juelich.de/"><img class="institution_sm" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a>
    <a href="https://www.tu-ilmenau.de/"><img class="institution_sm" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a>
    <a href="https://bids.berkeley.edu/"><img class="institution_md" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a>
    <a href="https://www.inria.fr/"><img class="institution_sm" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a>
    <a href="https://www.au.dk/"><img class="institution_sm" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a>
    <a href="https://www.uni-graz.at/"><img class="institution_md" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a>
  </div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2019, MNE Developers. Last updated on 2019-09-15.</p>
  </div>
</footer>
  </body>
</html>