

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Compute evoked ERS source power using DICS, LCMV beamformer, and dSPM &#8212; MNE-GUI-Addons 0.2.0.dev4+g3d5184b documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/evoked_ers_source_power';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Locating intracranial electrode contacts" href="ieeg_locate.html" />
    <link rel="prev" title="Locating micro-scale intracranial electrode contacts" href="locate_ieeg_micro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">MNE-GUI-Addons 0.2.0.dev4+g3d5184b documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        Python API Reference
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mne-tools/mne-gui-addons" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://fosstodon.org/@mne" title="Mastodon" class="nav-link" rel="me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon"></i></span>
            <label class="sr-only">Mastodon</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/mne_python" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mne.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/rKfvxTuATa" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        Python API Reference
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mne-tools/mne-gui-addons" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://fosstodon.org/@mne" title="Mastodon" class="nav-link" rel="me" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon"></i></span>
            <label class="sr-only">Mastodon</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/mne_python" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mne.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discourse"></i></span>
            <label class="sr-only">Discourse</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/rKfvxTuATa" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="locate_ieeg_micro.html">Locating micro-scale intracranial electrode contacts</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Compute evoked ERS source power using DICS, LCMV beamformer, and dSPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="ieeg_locate.html">Locating intracranial electrode contacts</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Compute evoked ERS source power using DICS, LCMV beamformer, and dSPM</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-evoked-ers-source-power-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="compute-evoked-ers-source-power-using-dics-lcmv-beamformer-and-dspm">
<span id="ex-source-loc-methods"></span><span id="sphx-glr-auto-examples-evoked-ers-source-power-py"></span><h1>Compute evoked ERS source power using DICS, LCMV beamformer, and dSPM<a class="headerlink" href="#compute-evoked-ers-source-power-using-dics-lcmv-beamformer-and-dspm" title="Permalink to this heading">#</a></h1>
<p>Here we examine 3 ways of localizing event-related synchronization (ERS) of
beta band activity in this dataset: <a class="reference external" href="https://mne.tools/stable/overview/datasets_index.html#somato-dataset" title="(in MNE v1.3)"><span>Somatosensory</span></a> using
<a class="reference external" href="https://mne.tools/stable/glossary.html#term-DICS" title="(in MNE v1.3)"><span class="xref std std-term">DICS</span></a>, <a class="reference external" href="https://mne.tools/stable/glossary.html#term-LCMV-beamformer" title="(in MNE v1.3)"><span class="xref std std-term">LCMV beamformer</span></a>, and <a class="reference external" href="https://mne.tools/stable/glossary.html#term-dSPM" title="(in MNE v1.3)"><span class="xref std std-term">dSPM</span></a> applied to active and
baseline covariance matrices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Luke Bloy &lt;luke.bloy@gmail.com&gt;</span>
<span class="c1">#          Eric Larson &lt;larson.eric.d@gmail.com&gt;</span>
<span class="c1">#          Alex Rockhill &lt;aprockhill@mailbox.org&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD-3-Clause</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">mne_gui_addons</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne.cov</span> <span class="kn">import</span> <a href="https://mne.tools/stable/generated/mne.compute_covariance.html#mne.compute_covariance" title="mne.compute_covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">compute_covariance</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">somato</span>
<span class="kn">from</span> <span class="nn">mne.time_frequency</span> <span class="kn">import</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.csd_tfr.html#mne.time_frequency.csd_tfr" title="mne.time_frequency.csd_tfr" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-function"><span class="n">csd_tfr</span></a>
<span class="kn">from</span> <span class="nn">mne.beamformer</span> <span class="kn">import</span> <a href="https://mne.tools/stable/generated/mne.beamformer.make_dics.html#mne.beamformer.make_dics" title="mne.beamformer.make_dics" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">make_dics</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_dics_csd.html#mne.beamformer.apply_dics_csd" title="mne.beamformer.apply_dics_csd" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_dics_csd</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.beamformer.make_lcmv.html#mne.beamformer.make_lcmv" title="mne.beamformer.make_lcmv" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">make_lcmv</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_lcmv_cov.html#mne.beamformer.apply_lcmv_cov" title="mne.beamformer.apply_lcmv_cov" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_lcmv_cov</span></a>
<span class="kn">from</span> <span class="nn">mne.minimum_norm</span> <span class="kn">import</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">make_inverse_operator</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.apply_inverse_cov.html#mne.minimum_norm.apply_inverse_cov" title="mne.minimum_norm.apply_inverse_cov" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">apply_inverse_cov</span></a>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
<p>Reading the raw data and creating epochs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.datasets.somato.data_path.html#mne.datasets.somato.data_path" title="mne.datasets.somato.data_path" class="sphx-glr-backref-module-mne-datasets-somato sphx-glr-backref-type-py-function"><span class="n">somato</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a> <span class="o">=</span> <span class="s2">&quot;01&quot;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">/</span> <span class="s2">&quot;derivatives&quot;</span> <span class="o">/</span> <span class="s2">&quot;freesurfer&quot;</span> <span class="o">/</span> <span class="s2">&quot;subjects&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a> <span class="o">=</span> <span class="s2">&quot;somato&quot;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <span class="p">(</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a>
    <span class="o">/</span> <span class="s2">&quot;sub-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">)</span>
    <span class="o">/</span> <span class="s2">&quot;meg&quot;</span>
    <span class="o">/</span> <span class="s2">&quot;sub-</span><span class="si">{}</span><span class="s2">_task-</span><span class="si">{}</span><span class="s2">_meg.fif&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># crop to 5 minutes to save memory</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">)</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="c1"># We are interested in the beta band (12-30 Hz)</span>
<a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw.load_data" title="mne.io.Raw.load_data" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">load_data</span></a><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># The DICS beamformer currently only supports a single sensor type.</span>
<span class="c1"># We&#39;ll use the gradiometers in this example.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s2">&quot;grad&quot;</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s2">&quot;bads&quot;</span><span class="p">)</span>

<span class="c1"># Read epochs</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>

<span class="c1"># Read forward operator and point to freesurfer subject directory</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd_fname</span></a> <span class="o">=</span> <span class="p">(</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a>
    <span class="o">/</span> <span class="s2">&quot;derivatives&quot;</span>
    <span class="o">/</span> <span class="s2">&quot;sub-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">)</span>
    <span class="o">/</span> <span class="s2">&quot;sub-</span><span class="si">{}</span><span class="s2">_task-</span><span class="si">{}</span><span class="s2">-fwd.fif&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">task</span></a><span class="p">)</span>
<span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.read_forward_solution.html#mne.read_forward_solution" title="mne.read_forward_solution" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_forward_solution</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd_fname</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-somato-data/sub-01/meg/sub-01_task-somato_meg.fif...
    Range : 237600 ... 506999 =    791.189 ...  1688.266 secs
Ready.
Reading 0 ... 90092  =      0.000 ...   299.999 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 12 - 30 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 12.00
- Lower transition bandwidth: 3.00 Hz (-6 dB cutoff frequency: 10.50 Hz)
- Upper passband edge: 30.00 Hz
- Upper transition bandwidth: 7.50 Hz (-6 dB cutoff frequency: 33.75 Hz)
- Filter length: 331 samples (1.102 s)

[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done 306 out of 306 | elapsed:    1.2s finished
37 events found
Event IDs: [1]
Not setting metadata
37 matching events found
Setting baseline interval to [-1.498464098687909, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 37 events and 1052 original time points (prior to decimation) ...
0 bad epochs dropped
Reading forward solution from /home/circleci/mne_data/MNE-somato-data/derivatives/sub-01/sub-01_task-somato-fwd.fif...
    Reading a source space...
    [done]
    Reading a source space...
    [done]
    2 source spaces read
    Desired named matrix (kind = 3523) not available
    Read MEG forward solution (8155 sources, 306 channels, free orientations)
    Source spaces transformed to the forward solution coordinate frame
</pre></div>
</div>
<section id="compute-covariances-and-cross-spectral-density">
<h2>Compute covariances and cross-spectral density<a class="headerlink" href="#compute-covariances-and-cross-spectral-density" title="Permalink to this heading">#</a></h2>
<p>ERS activity starts at 0.5 seconds after stimulus onset. Because these
data have been processed by MaxFilter directly (rather than MNE-Python’s
version), we have to be careful to compute the rank with a more conservative
threshold in order to get the correct data rank (64). Once this is used in
combination with an advanced covariance estimator like “shrunk”, the rank
will be correctly preserved.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.compute_rank.html#mne.compute_rank" title="mne.compute_rank" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">compute_rank</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">tol_kind</span><span class="o">=</span><span class="s2">&quot;relative&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_active</span></a> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_baseline</span></a> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.compute_covariance.html#mne.compute_covariance" title="mne.compute_covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">compute_covariance</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <span class="n">tmin</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_baseline</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">tmax</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_baseline</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;shrunk&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.compute_covariance.html#mne.compute_covariance" title="mne.compute_covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">compute_covariance</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <span class="n">tmin</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_active</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">tmax</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_active</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;shrunk&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># when the covariance objects are added together, they are scaled by the size</span>
<span class="c1"># of the window used to create them so that the average is properly weighted</span>
<a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_common</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a> <span class="o">+</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a>
<a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance.plot" title="mne.Covariance.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">cov_baseline</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.logspace.html#numpy.logspace" title="numpy.logspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">logspace</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="mi">9</span><span class="p">)</span>

<span class="c1"># time-frequency decomposition</span>
<a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.tfr_morlet.html#mne.time_frequency.tfr_morlet" title="mne.time_frequency.tfr_morlet" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">time_frequency</span><span class="o">.</span><span class="n">tfr_morlet</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a><span class="p">,</span>
    <span class="n">n_cycles</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">return_itc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="s2">&quot;complex&quot;</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR.decimate" title="mne.time_frequency.EpochsTFR.decimate" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">epochs_tfr</span><span class="o">.</span><span class="n">decimate</span></a><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># decimate for speed</span>

<span class="c1"># compute cross-spectral density matrices</span>
<a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.csd_tfr.html#mne.time_frequency.csd_tfr" title="mne.time_frequency.csd_tfr" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-function"><span class="n">csd_tfr</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a><span class="p">,</span> <span class="n">tmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd_baseline</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.csd_tfr.html#mne.time_frequency.csd_tfr" title="mne.time_frequency.csd_tfr" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-function"><span class="n">csd_tfr</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_baseline</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tmax</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_baseline</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd_ers</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.csd_tfr.html#mne.time_frequency.csd_tfr" title="mne.time_frequency.csd_tfr" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-function"><span class="n">csd_tfr</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a><span class="p">,</span> <span class="n">tmin</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_active</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tmax</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">win_active</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity.plot" title="mne.time_frequency.CrossSpectralDensity.plot" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">csd_baseline</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_evoked_ers_source_power_001.png" srcset="../_images/sphx_glr_evoked_ers_source_power_001.png" alt="Gradiometers covariance" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_evoked_ers_source_power_002.png" srcset="../_images/sphx_glr_evoked_ers_source_power_002.png" alt="Gradiometers covariance" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_evoked_ers_source_power_003.png" srcset="../_images/sphx_glr_evoked_ers_source_power_003.png" alt="Cross-spectral density, 12.0 Hz., 13.5 Hz., 15.1 Hz., 16.9 Hz., 19.0 Hz., 21.3 Hz., 23.9 Hz., 26.8 Hz., 30.0 Hz." class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing rank from data with rank=None
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
Computing rank from data with rank={&#39;grad&#39;: 64}
    Setting small GRAD eigenvalues to zero (without PCA)
Reducing data rank from 204 -&gt; 64
Estimating covariance using SHRUNK
Done.
Number of samples used : 3737
[done]
Computing rank from data with rank={&#39;grad&#39;: 64}
    Setting small GRAD eigenvalues to zero (without PCA)
Reducing data rank from 204 -&gt; 64
Estimating covariance using SHRUNK
Done.
Number of samples used : 3737
[done]
Computing rank from covariance with rank=None
    Using tolerance 2.5e-13 (2.2e-16 eps * 204 dim * 5.6  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done 204 out of 204 | elapsed:    2.5s finished
Not setting metadata
</pre></div>
</div>
</section>
<section id="compute-some-source-estimates">
<h2>Compute some source estimates<a class="headerlink" href="#compute-some-source-estimates" title="Permalink to this heading">#</a></h2>
<p>Here we will use DICS, LCMV beamformer, and dSPM.</p>
<p>See <a class="reference external" href="https://mne.tools/stable/auto_examples/inverse/dics_source_power.html#ex-inverse-source-power" title="(in MNE v1.3)"><span>Compute source power using DICS beamformer</span></a> for more information about DICS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_gen_dics</span><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd</span></a><span class="p">,</span> <span class="n">ers_csd</span><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd_baseline</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">):</span>
    <span class="n">filters</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.make_dics.html#mne.beamformer.make_dics" title="mne.beamformer.make_dics" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">make_dics</span></a><span class="p">(</span>
        <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span>
        <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span>
        <a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity.mean" title="mne.time_frequency.CrossSpectralDensity.mean" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">csd</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(),</span>
        <span class="n">pick_ori</span><span class="o">=</span><span class="s2">&quot;max-power&quot;</span><span class="p">,</span>
        <span class="n">reduce_rank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">real_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rank</span></a><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">stc_base</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_dics_csd.html#mne.beamformer.apply_dics_csd" title="mne.beamformer.apply_dics_csd" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_dics_csd</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity.mean" title="mne.time_frequency.CrossSpectralDensity.mean" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">csd_baseline</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(),</span> <span class="n">filters</span><span class="p">)</span>
    <span class="n">stc_act</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freqs</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_dics_csd.html#mne.beamformer.apply_dics_csd" title="mne.beamformer.apply_dics_csd" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_dics_csd</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity.mean" title="mne.time_frequency.CrossSpectralDensity.mean" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">csd_ers</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(),</span> <span class="n">filters</span><span class="p">)</span>
    <span class="n">stc_act</span> <span class="o">/=</span> <span class="n">stc_base</span>
    <span class="k">return</span> <span class="n">stc_act</span>


<span class="c1"># generate lcmv source estimate</span>
<span class="k">def</span> <span class="nf">_gen_lcmv</span><span class="p">(</span><span class="n">active_cov</span><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <span class="n">common_cov</span><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">):</span>
    <span class="n">filters</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.make_lcmv.html#mne.beamformer.make_lcmv" title="mne.beamformer.make_lcmv" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">make_lcmv</span></a><span class="p">(</span>
        <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <span class="n">common_cov</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">noise_cov</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s2">&quot;max-power&quot;</span>
    <span class="p">)</span>
    <span class="n">stc_base</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_lcmv_cov.html#mne.beamformer.apply_lcmv_cov" title="mne.beamformer.apply_lcmv_cov" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_lcmv_cov</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
    <span class="n">stc_act</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.beamformer.apply_lcmv_cov.html#mne.beamformer.apply_lcmv_cov" title="mne.beamformer.apply_lcmv_cov" class="sphx-glr-backref-module-mne-beamformer sphx-glr-backref-type-py-function"><span class="n">apply_lcmv_cov</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
    <span class="n">stc_act</span> <span class="o">/=</span> <span class="n">stc_base</span>
    <span class="k">return</span> <span class="n">stc_act</span>


<span class="c1"># generate mne/dSPM source estimate</span>
<span class="k">def</span> <span class="nf">_gen_mne</span><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_common</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;dSPM&quot;</span><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">make_inverse_operator</span></a><span class="p">(</span><span class="n">info</span><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_common</span></a><span class="p">)</span>
    <span class="n">stc_act</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.apply_inverse_cov.html#mne.minimum_norm.apply_inverse_cov" title="mne.minimum_norm.apply_inverse_cov" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">apply_inverse_cov</span></a><span class="p">(</span>
        <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">stc_base</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.apply_inverse_cov.html#mne.minimum_norm.apply_inverse_cov" title="mne.minimum_norm.apply_inverse_cov" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">apply_inverse_cov</span></a><span class="p">(</span>
        <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">stc_act</span> <span class="o">/=</span> <span class="n">stc_base</span>
    <span class="k">return</span> <span class="n">stc_act</span>


<span class="c1"># Compute source estimates</span>
<a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stc_dics</span></a> <span class="o">=</span> <span class="n">_gen_dics</span><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd_ers</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity" title="mne.time_frequency.CrossSpectralDensity" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">csd_baseline</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stc_lcmv</span></a> <span class="o">=</span> <span class="n">_gen_lcmv</span><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_common</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stc_dspm</span></a> <span class="o">=</span> <span class="n">_gen_mne</span><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_active</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_common</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Identifying common channels ...
Dropped the following channels:
[&#39;MEG 2431&#39;, &#39;MEG 1731&#39;, &#39;MEG 2221&#39;, &#39;MEG 2611&#39;, &#39;MEG 1111&#39;, &#39;MEG 0321&#39;, &#39;MEG 1031&#39;, &#39;MEG 1311&#39;, &#39;MEG 1331&#39;, &#39;MEG 1941&#39;, &#39;MEG 1121&#39;, &#39;MEG 1131&#39;, &#39;MEG 0641&#39;, &#39;MEG 2011&#39;, &#39;MEG 2111&#39;, &#39;MEG 2621&#39;, &#39;MEG 0621&#39;, &#39;MEG 1831&#39;, &#39;MEG 2321&#39;, &#39;MEG 0531&#39;, &#39;MEG 2131&#39;, &#39;MEG 1211&#39;, &#39;MEG 1911&#39;, &#39;MEG 2421&#39;, &#39;MEG 0311&#39;, &#39;MEG 2021&#39;, &#39;MEG 1441&#39;, &#39;MEG 1531&#39;, &#39;MEG 2341&#39;, &#39;MEG 0941&#39;, &#39;MEG 1641&#39;, &#39;MEG 0521&#39;, &#39;MEG 0631&#39;, &#39;MEG 1921&#39;, &#39;MEG 0341&#39;, &#39;MEG 1511&#39;, &#39;MEG 2241&#39;, &#39;MEG 1711&#39;, &#39;MEG 1841&#39;, &#39;MEG 2141&#39;, &#39;MEG 0821&#39;, &#39;MEG 2031&#39;, &#39;MEG 0421&#39;, &#39;MEG 1621&#39;, &#39;MEG 0331&#39;, &#39;MEG 0741&#39;, &#39;MEG 1021&#39;, &#39;MEG 1931&#39;, &#39;MEG 2531&#39;, &#39;MEG 0141&#39;, &#39;MEG 1231&#39;, &#39;MEG 1141&#39;, &#39;MEG 0241&#39;, &#39;MEG 0931&#39;, &#39;MEG 1811&#39;, &#39;MEG 1241&#39;, &#39;MEG 0441&#39;, &#39;MEG 0511&#39;, &#39;MEG 1041&#39;, &#39;MEG 1221&#39;, &#39;MEG 2641&#39;, &#39;MEG 0431&#39;, &#39;MEG 2541&#39;, &#39;MEG 0711&#39;, &#39;MEG 1421&#39;, &#39;MEG 2441&#39;, &#39;MEG 0121&#39;, &#39;MEG 2521&#39;, &#39;MEG 2231&#39;, &#39;MEG 2331&#39;, &#39;MEG 1741&#39;, &#39;MEG 0911&#39;, &#39;MEG 2631&#39;, &#39;MEG 2121&#39;, &#39;MEG 1611&#39;, &#39;MEG 2411&#39;, &#39;MEG 1341&#39;, &#39;MEG 2311&#39;, &#39;MEG 0731&#39;, &#39;MEG 0131&#39;, &#39;MEG 0721&#39;, &#39;MEG 0411&#39;, &#39;MEG 0541&#39;, &#39;MEG 2041&#39;, &#39;MEG 1321&#39;, &#39;MEG 0921&#39;, &#39;MEG 2211&#39;, &#39;MEG 0811&#39;, &#39;MEG 0231&#39;, &#39;MEG 1011&#39;, &#39;MEG 0611&#39;, &#39;MEG 1541&#39;, &#39;MEG 0211&#39;, &#39;MEG 1631&#39;, &#39;MEG 2511&#39;, &#39;MEG 1721&#39;, &#39;MEG 1431&#39;, &#39;MEG 1521&#39;, &#39;MEG 1411&#39;, &#39;MEG 0221&#39;, &#39;MEG 1821&#39;, &#39;MEG 0111&#39;]
Computing inverse operator with 204 channels.
    204 out of 204 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
Whitening the forward solution.
Computing rank from covariance with rank={&#39;grad&#39;: 64}
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing rank from covariance with rank={&#39;grad&#39;: 64}
Computing DICS spatial filters...
Computing beamformer filters for 8155 sources
Filter computation complete
Computing DICS source power...
[done]
Computing DICS source power...
[done]
Computing rank from covariance with rank=&#39;info&#39;
    GRAD: rank 204 after 0 projectors applied to 204 channels
Computing rank from covariance with rank=&#39;info&#39;
    GRAD: rank 204 after 0 projectors applied to 204 channels
Making LCMV beamformer with rank {&#39;grad&#39;: 204}
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Whitening the forward solution.
Computing rank from covariance with rank={&#39;grad&#39;: 204}
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing beamformer filters for 8155 sources
Filter computation complete
Converting forward solution to surface orientation
    No patch info available. The standard source space normals will be employed in the rotation to the local surface coordinates....
    Converting to surface-based source orientations...
    [done]
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 7615/8155 = 10.004172
    scale = 5.17919e-08 exp = 0.8
Applying loose dipole orientations to surface source spaces: 0.2
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 2.6e-13 (2.2e-16 eps * 204 dim * 5.8  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.37511
    scaling factor to adjust the trace = 9.81775e+18 (nchan = 204 nzero = 140)
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
    Computing noise-normalization factors (dSPM)...
[done]
Applying inverse operator to &quot;cov&quot;...
    Picked 204 channels from the data
    Computing inverse...
    Eigenleads need to be weighted ...
    Computing residual...
    Explained  92.5% variance
    dSPM...
    Combining the current components...
[done]
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
    Computing noise-normalization factors (dSPM)...
[done]
Applying inverse operator to &quot;cov&quot;...
    Picked 204 channels from the data
    Computing inverse...
    Eigenleads need to be weighted ...
    Computing residual...
    Explained  92.5% variance
    dSPM...
    Combining the current components...
[done]
</pre></div>
</div>
</section>
<section id="plot-source-estimates">
<h2>Plot source estimates<a class="headerlink" href="#plot-source-estimates" title="Permalink to this heading">#</a></h2>
<p>DICS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.viz.Brain.html#mne.viz.Brain" title="mne.viz.Brain" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">brain_dics</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate.plot" title="mne.SourceEstimate.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc_dics</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
    <span class="n">hemi</span><span class="o">=</span><span class="s2">&quot;rh&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span>
    <span class="n">time_label</span><span class="o">=</span><span class="s2">&quot;DICS source power in the 12-30 Hz frequency band&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_evoked_ers_source_power_004.png" srcset="../_images/sphx_glr_evoked_ers_source_power_004.png" alt="evoked ers source power" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using control points [1.48510357 1.63084332 3.11482832]
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
</pre></div>
</div>
<p>LCMV:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.viz.Brain.html#mne.viz.Brain" title="mne.viz.Brain" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">brain_lcmv</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate.plot" title="mne.SourceEstimate.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc_lcmv</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
    <span class="n">hemi</span><span class="o">=</span><span class="s2">&quot;rh&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span>
    <span class="n">time_label</span><span class="o">=</span><span class="s2">&quot;LCMV source power in the 12-30 Hz frequency band&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_evoked_ers_source_power_005.png" srcset="../_images/sphx_glr_evoked_ers_source_power_005.png" alt="evoked ers source power" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using control points [1.37177438 1.44200685 1.93155495]
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
</pre></div>
</div>
<p>dSPM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/stable/generated/mne.viz.Brain.html#mne.viz.Brain" title="mne.viz.Brain" class="sphx-glr-backref-module-mne-viz sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">brain_dspm</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate.plot" title="mne.SourceEstimate.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">stc_dspm</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span>
    <span class="n">hemi</span><span class="o">=</span><span class="s2">&quot;rh&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span>
    <span class="n">time_label</span><span class="o">=</span><span class="s2">&quot;dSPM source power in the 12-30 Hz frequency band&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_evoked_ers_source_power_006.png" srcset="../_images/sphx_glr_evoked_ers_source_power_006.png" alt="evoked ers source power" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using control points [1.71118668 1.88724176 3.99076424]
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
</pre></div>
</div>
</section>
<section id="use-volume-source-estimate-with-time-frequency-resolution">
<h2>Use volume source estimate with time-frequency resolution<a class="headerlink" href="#use-volume-source-estimate-with-time-frequency-resolution" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a volume source space</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a> <span class="o">/</span> <span class="s2">&quot;bem&quot;</span> <span class="o">/</span> <span class="s2">&quot;inner_skull.surf&quot;</span>
<a href="https://mne.tools/stable/generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vol_src</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.setup_volume_source_space.html#mne.setup_volume_source_space" title="mne.setup_volume_source_space" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">setup_volume_source_space</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surface</span></a><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">add_interpolator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># just for speed!</span>

<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity</span></a> <span class="o">=</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,)</span>  <span class="c1"># one layer for MEG</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.make_bem_model.html#mne.make_bem_model" title="mne.make_bem_model" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_bem_model</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span>
    <span class="n">ico</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># just for speed</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span>
<span class="p">)</span>
<a href="https://mne.tools/stable/generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.make_bem_solution.html#mne.make_bem_solution" title="mne.make_bem_solution" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_bem_solution</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">)</span>

<a href="https://mne.tools/stable/generated/mne.transforms.Transform.html#mne.transforms.Transform" title="mne.transforms.Transform" class="sphx-glr-backref-module-mne-transforms sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trans</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fwd</span></a><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">][</span><span class="s2">&quot;mri_head_t&quot;</span><span class="p">]</span>
<a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vol_fwd</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.make_forward_solution.html#mne.make_forward_solution" title="mne.make_forward_solution" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_forward_solution</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span>
    <a href="https://mne.tools/stable/generated/mne.transforms.Transform.html#mne.transforms.Transform" title="mne.transforms.Transform" class="sphx-glr-backref-module-mne-transforms sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trans</span></a><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.transforms.Transform.html#mne.transforms.Transform" title="mne.transforms.Transform" class="sphx-glr-backref-module-mne-transforms sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trans</span></a><span class="p">,</span>
    <span class="n">src</span><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vol_src</span></a><span class="p">,</span>
    <a href="https://mne.tools/stable/generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem</span></a><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.bem.ConductorModel.html#mne.bem.ConductorModel" title="mne.bem.ConductorModel" class="sphx-glr-backref-module-mne-bem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bem</span></a><span class="p">,</span>
    <span class="n">meg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">mindist</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Compute source estimate using MNE solver</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">snr</span></a> <span class="o">=</span> <span class="mf">3.0</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lambda2</span></a> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">snr</span></a><span class="o">**</span><span class="mi">2</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a> <span class="o">=</span> <span class="s2">&quot;MNE&quot;</span>  <span class="c1"># use MNE method (could also be dSPM or sLORETA)</span>

<span class="c1"># make a different inverse operator for each frequency so as to properly</span>
<span class="c1"># whiten the sensor data</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_idx</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span><span class="o">.</span><span class="n">freqs</span><span class="o">.</span><span class="n">size</span></a><span class="p">):</span>
    <span class="c1"># for each frequency, compute a separate covariance matrix</span>
    <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.time_frequency.CrossSpectralDensity.html#mne.time_frequency.CrossSpectralDensity.get_data" title="mne.time_frequency.CrossSpectralDensity.get_data" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-method"><span class="n">csd_baseline</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="n">index</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">freq_idx</span></a><span class="p">,</span> <span class="n">as_cov</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>  <span class="c1"># only normalize by real</span>
    <span class="c1"># then use that covariance matrix as normalization for the inverse</span>
    <span class="c1"># operator</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <a href="https://mne.tools/stable/generated/mne.minimum_norm.make_inverse_operator.html#mne.minimum_norm.make_inverse_operator" title="mne.minimum_norm.make_inverse_operator" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">make_inverse_operator</span></a><span class="p">(</span><a href="https://mne.tools/stable/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="mne.Forward" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vol_fwd</span></a><span class="p">,</span> <a href="https://mne.tools/stable/generated/mne.Covariance.html#mne.Covariance" title="mne.Covariance" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cov_baseline</span></a><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># finally, compute the stcs for each epoch and frequency</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stcs</span></a> <span class="o">=</span> <a href="https://mne.tools/stable/generated/mne.minimum_norm.apply_inverse_tfr_epochs.html#mne.minimum_norm.apply_inverse_tfr_epochs" title="mne.minimum_norm.apply_inverse_tfr_epochs" class="sphx-glr-backref-module-mne-minimum_norm sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">minimum_norm</span><span class="o">.</span><span class="n">apply_inverse_tfr_epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inverse_operator</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lambda2</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span> <span class="n">pick_ori</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Boundary surface file : /home/circleci/mne_data/MNE-somato-data/derivatives/freesurfer/subjects/01/bem/inner_skull.surf
grid                  : 10.0 mm
mindist               : 5.0 mm
MRI volume            : /home/circleci/mne_data/MNE-somato-data/derivatives/freesurfer/subjects/01/mri/T1.mgz

Reading /home/circleci/mne_data/MNE-somato-data/derivatives/freesurfer/subjects/01/mri/T1.mgz...

Loaded bounding surface from /home/circleci/mne_data/MNE-somato-data/derivatives/freesurfer/subjects/01/bem/inner_skull.surf (10242 nodes)
Surface CM = (   0.1  -21.3   32.9) mm
Surface fits inside a sphere with radius   97.6 mm
Surface extent:
    x =  -76.0 ...   77.4 mm
    y = -105.3 ...   75.3 mm
    z =  -48.1 ...  103.3 mm
Grid extent:
    x =  -80.0 ...   80.0 mm
    y = -110.0 ...   80.0 mm
    z =  -50.0 ...  110.0 mm
5780 sources before omitting any.
3719 sources after omitting infeasible sources not within 0.0 - 97.6 mm.
Source spaces are in MRI coordinates.
Checking that the sources are inside the surface and at least    5.0 mm away (will take a few...)
Checking surface interior status for 3719 points...
    Found  525/3719 points inside  an interior sphere of radius   50.2 mm
    Found    0/3719 points outside an exterior sphere of radius   97.6 mm
    Found 1568/3194 points outside using surface Qhull
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    7.4s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    7.4s finished
    Found  100/1626 points outside using solid angles
    Total 2051/3719 points inside the surface
Interior check completed in 7373.4 ms
    1668 source space points omitted because they are outside the inner skull surface.
    403 source space points omitted because of the    5.0-mm distance limit.
1648 sources remaining after excluding the sources outside the surface and less than    5.0 mm inside.
Adjusting the neighborhood info.
Source space : MRI voxel -&gt; MRI (surface RAS)
     0.010000  0.000000  0.000000     -80.00 mm
     0.000000  0.010000  0.000000    -110.00 mm
     0.000000  0.000000  0.010000     -50.00 mm
     0.000000  0.000000  0.000000       1.00
MRI volume : MRI voxel -&gt; MRI (surface RAS)
    -0.001000  0.000000  0.000000     128.00 mm
     0.000000  0.000000  0.001000    -128.00 mm
     0.000000 -0.001000  0.000000     128.00 mm
     0.000000  0.000000  0.000000       1.00
MRI volume : MRI (surface RAS) -&gt; RAS (non-zero origin)
     1.000000  0.000000  0.000000       2.93 mm
     0.000000  1.000000  0.000000      49.85 mm
     0.000000  0.000000  1.000000     -24.58 mm
     0.000000  0.000000  0.000000       1.00
Creating the BEM geometry...
Going from 5th to 3th subdivision of an icosahedron (n_tri: 20480 -&gt; 1280)
inner skull CM is   0.15 -21.35  32.94 mm
Surfaces passed the basic topology checks.
Complete.

Homogeneous model surface loaded.
Computing the linear collocation solution...
    Matrix coefficients...
        inner skull (642) -&gt; inner skull (642) ...
    Inverting the coefficient matrix...
Solution ready.
BEM geometry computations complete.
Source space          : &lt;SourceSpaces: [&lt;volume, shape=(17, 20, 17), n_used=1648&gt;] MRI (surface RAS) coords, subject &#39;01&#39;, ~1.4 MB&gt;
MRI -&gt; head transform : instance of Transform
Measurement data      : instance of Info
Conductor model   : instance of ConductorModel
Accurate field computations
Do computations in head coordinates
Free source orientations

Read 1 source spaces a total of 1648 active source locations

Coordinate transformation: MRI (surface RAS) -&gt; head
     0.998865  0.023957  0.041176       0.49 mm
    -0.035225  0.953344  0.299821      24.87 mm
    -0.032072 -0.300931  0.953106      17.96 mm
     0.000000  0.000000  0.000000       1.00

Read 306 MEG channels from info
105 coil definitions read
Coordinate transformation: MEG device -&gt; head
     0.997640 -0.061033 -0.031446       3.42 mm
     0.063766  0.993449  0.094829       6.64 mm
     0.025452 -0.096610  0.994997      54.42 mm
     0.000000  0.000000  0.000000       1.00
MEG coil definitions created in head coordinates.
Source spaces are now in head coordinates.

Employing the head-&gt;MRI coordinate transform with the BEM model.
BEM model instance of ConductorModel is now set up

Source spaces are in head coordinates.
Checking that the sources are inside the surface and at least    5.0 mm away (will take a few...)
Checking surface interior status for 1648 points...
    Found  531/1648 points inside  an interior sphere of radius   50.7 mm
    Found    0/1648 points outside an exterior sphere of radius   97.3 mm
    Found    0/1117 points outside using surface Qhull
    Found    0/1117 points outside using solid angles
    Total 1648/1648 points inside the surface
Interior check completed in 329.5 ms

Checking surface interior status for 306 points...
    Found   0/306 points inside  an interior sphere of radius   50.7 mm
    Found 306/306 points outside an exterior sphere of radius   97.3 mm
    Found   0/  0 points outside using surface Qhull
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.1s finished
    Found   0/  0 points outside using solid angles
    Total 0/306 points inside the surface
Interior check completed in 54.4 ms

Composing the field computation matrix...
Computing MEG at 1648 source locations (free orientations)...

Finished.
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 5.1e-13 (2.2e-16 eps * 204 dim * 11  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.44896
    scaling factor to adjust the trace = 4.03799e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 5.8e-13 (2.2e-16 eps * 204 dim * 13  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.44948
    scaling factor to adjust the trace = 3.38374e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 5.7e-13 (2.2e-16 eps * 204 dim * 13  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.39781
    scaling factor to adjust the trace = 3.57564e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 4.5e-13 (2.2e-16 eps * 204 dim * 9.9  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.45123
    scaling factor to adjust the trace = 3.97057e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 3e-13 (2.2e-16 eps * 204 dim * 6.7  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.49264
    scaling factor to adjust the trace = 4.81685e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 1.6e-13 (2.2e-16 eps * 204 dim * 3.5  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.43023
    scaling factor to adjust the trace = 6.16806e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 9.7e-14 (2.2e-16 eps * 204 dim * 2.2  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.23101
    scaling factor to adjust the trace = 7.9978e+18 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 6.8e-14 (2.2e-16 eps * 204 dim * 1.5  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.26033
    scaling factor to adjust the trace = 1.07631e+19 (nchan = 204 nzero = 140)
Computing inverse operator with 204 channels.
    204 out of 306 channels remain after picking
Selected 204 channels
Creating the depth weighting matrix...
    204 planar channels
    limit = 1559/1648 = 10.054558
    scale = 4.43241e-08 exp = 0.8
Whitening the forward solution.
Computing rank from covariance with rank=None
    Using tolerance 4.6e-14 (2.2e-16 eps * 204 dim * 1  max singular value)
    Estimated rank (grad): 64
    GRAD: rank 64 computed from 204 data channels with 0 projectors
    Setting small GRAD eigenvalues to zero (without PCA)
Creating the source covariance matrix
Adjusting source covariance matrix.
Computing SVD of whitened and weighted lead field matrix.
    largest singular value = 2.28605
    scaling factor to adjust the trace = 1.62809e+19 (nchan = 204 nzero = 140)
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
Not setting metadata
37 matching events found
No baseline correction applied
0 projection items activated
Preparing the inverse operator for use...
    Scaled noise and source covariance from nave = 1 to nave = 1
    Created the regularized inverter
    The projection vectors do not apply to these channels.
    Created the whitener using a noise covariance matrix with rank 64 (140 small eigenvalues omitted)
Picked 204 channels from the data
Computing inverse...
    Eigenleads need to be weighted ...
Processing epoch : 1 / 37
Processing epoch : 2 / 37
Processing epoch : 3 / 37
Processing epoch : 4 / 37
Processing epoch : 5 / 37
Processing epoch : 6 / 37
Processing epoch : 7 / 37
Processing epoch : 8 / 37
Processing epoch : 9 / 37
Processing epoch : 10 / 37
Processing epoch : 11 / 37
Processing epoch : 12 / 37
Processing epoch : 13 / 37
Processing epoch : 14 / 37
Processing epoch : 15 / 37
Processing epoch : 16 / 37
Processing epoch : 17 / 37
Processing epoch : 18 / 37
Processing epoch : 19 / 37
Processing epoch : 20 / 37
Processing epoch : 21 / 37
Processing epoch : 22 / 37
Processing epoch : 23 / 37
Processing epoch : 24 / 37
Processing epoch : 25 / 37
Processing epoch : 26 / 37
Processing epoch : 27 / 37
Processing epoch : 28 / 37
Processing epoch : 29 / 37
Processing epoch : 30 / 37
Processing epoch : 31 / 37
Processing epoch : 32 / 37
Processing epoch : 33 / 37
Processing epoch : 34 / 37
Processing epoch : 35 / 37
Processing epoch : 36 / 37
Processing epoch : 37 / 37
[done]
</pre></div>
</div>
</section>
<section id="plot-volume-source-estimates">
<h2>Plot volume source estimates<a class="headerlink" href="#plot-volume-source-estimates" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">viewer</span> <span class="o">=</span> <a href="../generated/mne_gui_addons.view_vol_stc.html#mne_gui_addons.view_vol_stc" title="mne_gui_addons.view_vol_stc" class="sphx-glr-backref-module-mne_gui_addons sphx-glr-backref-type-py-function"><span class="n">mne_gui_addons</span><span class="o">.</span><span class="n">view_vol_stc</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stcs</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subjects_dir</span></a><span class="p">,</span> <span class="n">src</span><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">vol_src</span></a><span class="p">,</span> <span class="n">inst</span><span class="o">=</span><a href="https://mne.tools/stable/generated/mne.time_frequency.EpochsTFR.html#mne.time_frequency.EpochsTFR" title="mne.time_frequency.EpochsTFR" class="sphx-glr-backref-module-mne-time_frequency sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_tfr</span></a>
<span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">go_to_extreme</span><span class="p">()</span>  <span class="c1"># show the maximum intensity source vertex</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">vmid</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">set_3d_view</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">elevation</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">350</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_evoked_ers_source_power_007.png" srcset="../_images/sphx_glr_evoked_ers_source_power_007.png" alt="evoked ers source power" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
For automatic theme detection, &quot;darkdetect&quot; has to be installed! You can install it with `pip install darkdetect`
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  52.094 seconds)</p>
<p><strong>Estimated memory usage:</strong>  3524 MB</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-evoked-ers-source-power-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/8908724099882225c5780658405fe793/evoked_ers_source_power.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">evoked_ers_source_power.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/beea67216c17e7c7fa1aa6baf86678bb/evoked_ers_source_power.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">evoked_ers_source_power.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="locate_ieeg_micro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Locating micro-scale intracranial electrode contacts</p>
      </div>
    </a>
    <a class="right-next"
       href="ieeg_locate.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Locating intracranial electrode contacts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-covariances-and-cross-spectral-density">Compute covariances and cross-spectral density</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-some-source-estimates">Compute some source estimates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-source-estimates">Plot source estimates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-volume-source-estimate-with-time-frequency-resolution">Use volume source estimate with time-frequency resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-volume-source-estimates">Plot volume source estimates</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>