<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>FreeSurfer integration with MNE-Python &#8212; MNE 0.18.2 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" href="../../_static/reset-syntax.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap_divs.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <script type="text/javascript" src="../../_static/copybutton.js"></script>


    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37225609-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>


    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />



    <script type="text/javascript">
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);
    js.id=id;js.src="https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>



    <script type="text/javascript">
    (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
    </script>



<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>



  </head><body>





  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/mne_logo_small.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.18.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../getting_started.html">Install</a></li>
                <li><a href="../../documentation.html">Documentation</a></li>
                <li><a href="../../python_reference.html">API</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.18.2
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://mne-tools.github.io/dev/index.html">Development</a></li>
    <li><a href="https://mne-tools.github.io/stable/index.html">v0.18 (stable)</a></li>
    <li><a href="https://mne-tools.github.io/0.17/index.html">v0.17</a></li>
    <li><a href="https://mne-tools.github.io/0.16/index.html">v0.16</a></li>
    <li><a href="https://mne-tools.github.io/0.15/index.html">v0.15</a></li>
    <li><a href="https://mne-tools.github.io/0.14/index.html">v0.14</a></li>
    <li><a href="https://mne-tools.github.io/0.13/index.html">v0.13</a></li>
    <li><a href="https://mne-tools.github.io/0.12/index.html">v0.12</a></li>
    <li><a href="https://mne-tools.github.io/0.11/index.html">v0.11</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mne_logo_small.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">FreeSurfer integration with MNE-Python</a><ul>
<li><a class="reference internal" href="#first-steps">First steps</a></li>
<li><a class="reference internal" href="#anatomical-reconstruction">Anatomical reconstruction</a></li>
<li><a class="reference internal" href="#fsaverage">‘fsaverage’</a></li>
<li><a class="reference internal" href="#use-with-mne-python">Use with MNE-Python</a></li>
</ul>
</li>
</ul>

<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-tutorials-source-modeling-plot-background-freesurfer-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="freesurfer-integration-with-mne-python">
<span id="tut-freesurfer"></span><span id="sphx-glr-auto-tutorials-source-modeling-plot-background-freesurfer-py"></span><h1>FreeSurfer integration with MNE-Python<a class="headerlink" href="#freesurfer-integration-with-mne-python" title="Permalink to this headline">¶</a></h1>
<p>FreeSurfer is an open source analysis toolbox for MRI data. It contains several
command line tools and graphical user interfaces. FreeSurfer can be obtained
from <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/">https://surfer.nmr.mgh.harvard.edu/</a></p>
<p>In MNE, FreeSurfer is used to provide structural information of various
kinds, for <a class="reference internal" href="plot_mne_dspm_source_localization.html#tut-inverse-methods"><span class="std std-ref">source estimation</span></a>. Thereby a
subject specific structural MRI will be used to obtain various structural
representations like spherical or inflated brain surfaces. Furthermore features
like curvature as well as various labels for areas of interest (such as V1) are
computed.</p>
<p>Thus FreeSurfer provides an easy way to shift anatomically related
data between different representations and spaces. See e.g.
<a class="reference internal" href="../../manual/source_localization/morph_stc.html#ch-morph"><span class="std std-ref">Morphing source estimates: Moving data from one brain to another</span></a> for information about how to
use FreeSurfer surface representations to allow functional data to morph
between different subjects.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#first-steps" id="id2">First steps</a></p></li>
<li><p><a class="reference internal" href="#anatomical-reconstruction" id="id3">Anatomical reconstruction</a></p></li>
<li><p><a class="reference internal" href="#fsaverage" id="id4">‘fsaverage’</a></p></li>
<li><p><a class="reference internal" href="#use-with-mne-python" id="id5">Use with MNE-Python</a></p></li>
</ul>
</div>
<div class="section" id="first-steps">
<h2><a class="toc-backref" href="#id2">First steps</a><a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h2>
<p>After downloading and installing, the environment needs to be set up correctly.
This can be done by setting the FreeSurfer’s root directory correctly and
sourcing the setup file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export FREESURFER_HOME=/path/to/FreeSurfer
$ source $FREESURFER_HOME/SetUpFreeSurfer.sh
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The FreeSurfer home directory might vary depending on your operating
system. See the <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/DownloadAndInstall">FreeSurfer installation guide</a> for more.</p>
</div>
<p>Another important step is to define the subject directory correctly.
<code class="docutils literal notranslate"><span class="pre">SUBJECTS_DIR</span></code> must be defined such, that it contains the individual
subject’s reconstructions in separate sub-folders. Those sub-folders will be
created upon the reconstruction of the anatomical data. Nevertheless the parent
directory has to be set beforehand:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export SUBJECTS_DIR=~/subjects
</pre></div>
</div>
<p>Again see the <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/DownloadAndInstall">FreeSurfer installation guide</a> for more.</p>
<p>Once setup correctly, FreeSurfer will create a new subject folder in
<code class="docutils literal notranslate"><span class="pre">$SUBJECTS_DIR</span></code>.</p>
</div>
<div class="section" id="anatomical-reconstruction">
<h2><a class="toc-backref" href="#id3">Anatomical reconstruction</a><a class="headerlink" href="#anatomical-reconstruction" title="Permalink to this headline">¶</a></h2>
<p>MNE-Python works together with FreeSurfer in order to compute the forward model
and setting up the corresponding <a class="reference internal" href="../../generated/mne.SourceSpaces.html#mne.SourceSpaces" title="mne.SourceSpaces"><code class="xref py py-class docutils literal notranslate"><span class="pre">source</span> <span class="pre">space</span></code></a>. See
<a class="reference internal" href="../../manual/cookbook.html#setting-up-source-space"><span class="std std-ref">Setting up the source space</span></a> for more information. Usually a full FreeSurfer
reconstruction is obtained by prompting the following command to a bash
console (e.g. Linux or MacOS Terminal):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ my_subject=sample
$ my_NIfTI=/path/to/NIfTI.nii.gz
$ recon-all -i $my_NIfTI -s $my_subject -all
</pre></div>
</div>
<p>, where <span class="math notranslate nohighlight">\(i\)</span> stands for “input” and <span class="math notranslate nohighlight">\(s\)</span> for “subject”. Executing
this, will create the folder “~/subjects/sample”, where all
results are stored.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This compution takes often several hours. Please be patient.</p>
</div>
<p>Within a single subject all the files MNE-Python uses (and some more) are
grouped into meaningful sub-folders (such that “surf” contains surface
representations, “mri” volumetric files, etc.).</p>
<p>FreeSurfer performs a hemispheric separation and most results are present
in a left and right hemisphere version. This is often indicated by the
prefix <code class="docutils literal notranslate"><span class="pre">lh</span></code> or <code class="docutils literal notranslate"><span class="pre">rh</span></code> to refer to the aforementioned. For that reason
data representations such as <a class="reference internal" href="../../generated/mne.SourceEstimate.html#mne.SourceEstimate" title="mne.SourceEstimate"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.SourceEstimate</span></code></a> carry two sets of
spatial locations (vertices) for both hemispheres separately. See also
<a class="reference internal" href="plot_object_source_estimate.html#tut-source-estimate-class"><span class="std std-ref">The SourceEstimate data structure</span></a>.</p>
</div>
<div class="section" id="fsaverage">
<h2><a class="toc-backref" href="#id4">‘fsaverage’</a><a class="headerlink" href="#fsaverage" title="Permalink to this headline">¶</a></h2>
<p>During installation, FreeSurfer copies a “default” subject, called
<code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> to <code class="docutils literal notranslate"><span class="pre">$FREESURFER_HOME/subjects/fsaverage</span></code>. It contains all
data types that a subject reconstruction would yield and is required by
MNE-Python.</p>
<p>See <a class="reference external" href="https://surfer.nmr.mgh.harvard.edu/fswiki/FsAverage">https://surfer.nmr.mgh.harvard.edu/fswiki/FsAverage</a> for more
information. Furthermore a copy of ‘fsaverage’ can be found in
<a class="reference internal" href="../../manual/sample_dataset.html#ch-sample-data"><span class="std std-ref">The sample data set</span></a>.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> as value for the definition
of a subject when calling a function, the corresponding data will be read (e.g.
<code class="docutils literal notranslate"><span class="pre">subject='fsaverage'</span></code>) from ‘~/subjects/fsaverage’. This becomes especially
handy, when attempting statistical analyses on group level, based on
individual’s brain space data. In that case <code class="docutils literal notranslate"><span class="pre">'fsaverage'</span></code> will by default act
as reference space for <a class="reference internal" href="../../manual/source_localization/morph_stc.html#ch-morph"><span class="std std-ref">source estimate transformations</span></a>.</p>
</div>
<div class="section" id="use-with-mne-python">
<h2><a class="toc-backref" href="#id5">Use with MNE-Python</a><a class="headerlink" href="#use-with-mne-python" title="Permalink to this headline">¶</a></h2>
<p>For source localization analyses to work properly, it is important, that the
FreeSurfer reconstruction has completed beforehand. Furthermore, when using
related functions, such as <a class="reference internal" href="../../generated/mne.setup_source_space.html#mne.setup_source_space" title="mne.setup_source_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.setup_source_space()</span></code></a>, <code class="docutils literal notranslate"><span class="pre">SUBJECTS_DIR</span></code> has
to be defined either globally by setting <a class="reference internal" href="../../generated/mne.set_config.html#mne.set_config" title="mne.set_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.set_config()</span></code></a> or for
each function separately, by passing the respective keyword argument
<code class="docutils literal notranslate"><span class="pre">subjects_dir='~/subjects'</span></code>. See also <a class="reference internal" href="../../manual/cookbook.html#setting-up-source-space"><span class="std std-ref">Setting up the source space</span></a> to get
an idea of how this works.</p>
<p><strong>Estimated memory usage:</strong>  8 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-source-modeling-plot-background-freesurfer-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8b8e456544804eeef0e3e24b52b55edd/plot_background_freesurfer.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_background_freesurfer.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d94b812d196ae8939e6e7b100c9ef9df/plot_background_freesurfer.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_background_freesurfer.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container institutions">
    <a href="https://www.massgeneral.org/"><img class="institution_lg" src="../../_static/institution_logos/MGH.svg" title="Massachusetts General Hospital" alt="Massachusetts General Hospital"/></a>
    <a href="https://martinos.org/"><img class="institution_lg" src="../../_static/institution_logos/Martinos.png" title="Athinoula A. Martinos Center for Biomedical Imaging" alt="Athinoula A. Martinos Center for Biomedical Imaging"/></a>
    <a href="https://hms.harvard.edu/"><img class="institution_lg" src="../../_static/institution_logos/Harvard.png" title="Harvard Medical School" alt="Harvard Medical School"/></a>
    <a href="https://web.mit.edu/"><img class="institution_sm" src="../../_static/institution_logos/MIT.svg" title="Massachusetts Institute of Technology" alt="Massachusetts Institute of Technology"/></a>
    <a href="https://www.nyu.edu/"><img class="institution_md" src="../../_static/institution_logos/NYU.png" title="New York University" alt="New York University"/></a>
    <a href="http://www.cea.fr/"><img class="institution_md" src="../../_static/institution_logos/CEA.png" title="Commissariat à l´énergie atomique et aux énergies alternatives" alt="Commissariat à l´énergie atomique et aux énergies alternatives"/></a>
    <a href="https://sci.aalto.fi/"><img class="institution_md" src="../../_static/institution_logos/Aalto.svg" title="Aalto-yliopiston perustieteiden korkeakoulu" alt="Aalto-yliopiston perustieteiden korkeakoulu"/></a>
    <a href="https://www.telecom-paris.fr/"><img class="institution_md" src="../../_static/institution_logos/Telecom_Paris_Tech.png" title="Télécom ParisTech" alt="Télécom ParisTech"/></a>
    <a href="https://www.washington.edu/"><img class="institution_sm" src="../../_static/institution_logos/Washington.png" title="University of Washington" alt="University of Washington"/></a>
    <a href="https://icm-institute.org/"><img class="institution_lg" src="../../_static/institution_logos/ICM.jpg" title="Institut du Cerveau et de la Moelle épinière" alt="Institut du Cerveau et de la Moelle épinière"/></a>
    <a href="https://www.bu.edu/"><img class="institution_sm" src="../../_static/institution_logos/BU.svg" title="Boston University" alt="Boston University"/></a>
    <a href="https://www.inserm.fr/"><img class="institution_xs" src="../../_static/institution_logos/Inserm.svg" title="Institut national de la santé et de la recherche médicale" alt="Institut national de la santé et de la recherche médicale"/></a>
    <a href="https://www.fz-juelich.de/"><img class="institution_sm" src="../../_static/institution_logos/Julich.svg" title="Forschungszentrum Jülich" alt="Forschungszentrum Jülich"/></a>
    <a href="https://www.tu-ilmenau.de/"><img class="institution_sm" src="../../_static/institution_logos/Ilmenau.gif" title="Technische Universität Ilmenau" alt="Technische Universität Ilmenau"/></a>
    <a href="https://bids.berkeley.edu/"><img class="institution_md" src="../../_static/institution_logos/BIDS.png" title="Berkeley Institute for Data Science" alt="Berkeley Institute for Data Science"/></a>
    <a href="https://www.inria.fr/"><img class="institution_sm" src="../../_static/institution_logos/inria.png" title="Institut national de recherche en informatique et en automatique" alt="Institut national de recherche en informatique et en automatique"/></a>
    <a href="https://www.au.dk/"><img class="institution_sm" src="../../_static/institution_logos/Aarhus.png" title="Aarhus Universitet" alt="Aarhus Universitet"/></a>
    <a href="https://www.uni-graz.at/"><img class="institution_md" src="../../_static/institution_logos/Graz.jpg" title="Karl-Franzens-Universität Graz" alt="Karl-Franzens-Universität Graz"/></a>
  </div>
  <div class="container">
    <ul class="list-inline">
      <li><a href="https://github.com/mne-tools/mne-python">GitHub</a></li>
      <li>·</li>
      <li><a href="https://mail.nmr.mgh.harvard.edu/mailman/listinfo/mne_analysis">Mailing list</a></li>
      <li>·</li>
      <li><a href="https://gitter.im/mne-tools/mne-python">Gitter</a></li>
      <li>·</li>
      <li><a href="whats_new.html">What's new</a></li>
      <li>·</li>
      <li><a href="faq.html#cite">Cite MNE</a></li>
      <li class="pull-right"><a href="#">Back to top</a></li>
    </ul>
    <p>&copy; Copyright 2012-2019, MNE Developers. Last updated on 2019-07-11.</p>
  </div>
</footer>
  </body>
</html>